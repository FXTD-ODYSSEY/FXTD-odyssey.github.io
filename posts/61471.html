<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>Three.js - 学习之路（四） | 智伤帝的个人博客</title><meta name="keywords" content="࠴编程/前端,ࡄThreejs,ࡅOpenGL"><meta name="author" content="智伤帝"><meta name="copyright" content="智伤帝"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="description" content="物体全方位浏览全面封装">
<meta property="og:type" content="article">
<meta property="og:title" content="Three.js - 学习之路（四）">
<meta property="og:url" content="https://blog.l0v0.com/posts/61471.html">
<meta property="og:site_name" content="智伤帝的个人博客">
<meta property="og:description" content="物体全方位浏览全面封装">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/FXTD-odyssey/FXTD-odyssey.github.io@master/img/cover_04.png">
<meta property="article:published_time" content="2018-08-01T12:15:28.000Z">
<meta property="article:modified_time" content="2022-11-09T02:37:04.714Z">
<meta property="article:author" content="智伤帝">
<meta property="article:tag" content="࠴编程&#x2F;前端">
<meta property="article:tag" content="ࡄThreejs">
<meta property="article:tag" content="ࡅOpenGL">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/FXTD-odyssey/FXTD-odyssey.github.io@master/img/cover_04.png"><link rel="shortcut icon" href="//cdn.jsdelivr.net/gh/FXTD-odyssey/FXTD-odyssey.github.io@master/img/favicon.png"><link rel="canonical" href="https://blog.l0v0.com/posts/61471.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//hm.baidu.com"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="preconnect" href="//zz.bdstatic.com"/><meta name="google-site-verification" content="google15d1ccb0af66991a"/><meta name="msvalidate.01" content="D306EED72EF12BF89A2A951583FF91C7"/><meta name="baidu-site-verification" content="A3TUx6EZdy"/><meta name="360-site-verification" content="48ce68b0e3754c994b6e79677b842d48"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?cda99107ced8e9ef4d02339065438d4f";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script><script>var GLOBAL_CONFIG = { 
  root: '/',
  hexoversion: '5.4.2',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  ClickShowText: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  justifiedGallery: {
    js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
    css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isanchor: false
};

var saveToLocal = {
  set: function setWithExpiry(key, value, ttl) {
    const now = new Date()
    const expiryDay = ttl * 86400000
    const item = {
      value: value,
      expiry: now.getTime() + expiryDay,
    }
    localStorage.setItem(key, JSON.stringify(item))
  },

  get: function getWithExpiry(key) {
    const itemStr = localStorage.getItem(key)

    if (!itemStr) {
      return undefined
    }
    const item = JSON.parse(itemStr)
    const now = new Date()

    if (now.getTime() > item.expiry) {
      localStorage.removeItem(key)
      return undefined
    }
    return item.value
  }
}</script><script id="config_change">var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isSidebar: true,
  postUpdate: '2022-11-09 10:37:04'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(function () {
  window.activateDarkMode = function () {
    document.documentElement.setAttribute('data-theme', 'dark')
    if (document.querySelector('meta[name="theme-color"]') !== null) {
      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
    }
  }
  window.activateLightMode = function () {
    document.documentElement.setAttribute('data-theme', 'light')
    if (document.querySelector('meta[name="theme-color"]') !== null) {
      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
    }
  }

  const autoChangeMode = 'false'
  const t = saveToLocal.get('theme')
  if (autoChangeMode === '1') {
    const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
    const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
    const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
    const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

    if (t === undefined) {
      if (isLightMode) activateLightMode()
      else if (isDarkMode) activateDarkMode()
      else if (isNotSpecified || hasNoSupport) {
        const now = new Date()
        const hour = now.getHours()
        const isNight = hour <= 6 || hour >= 18
        isNight ? activateDarkMode() : activateLightMode()
      }
      window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {
        if (saveToLocal.get('theme') === undefined) {
          e.matches ? activateDarkMode() : activateLightMode()
        }
      })
    } else if (t === 'light') activateLightMode()
    else activateDarkMode()
  } else if (autoChangeMode === '2') {
    const now = new Date()
    const hour = now.getHours()
    const isNight = hour <= 6 || hour >= 18
    if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
    else if (t === 'light') activateLightMode()
    else activateDarkMode()
  } else {
    if (t === 'dark') activateDarkMode()
    else if (t === 'light') activateLightMode()
  }
})()</script><link rel="stylesheet" href="/css/iconfont.css"><link rel="stylesheet" href="/css/extra.css"><meta name="generator" content="Hexo 5.4.2"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" data-lazy-src="//cdn.jsdelivr.net/gh/FXTD-odyssey/FXTD-odyssey.github.io@master/img/avatar.png" onerror="onerror=null;src='//cdn.jsdelivr.net/gh/FXTD-odyssey/FXTD-odyssey.github.io@master/img/friend_404.gif'" alt="avatar"/></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">299</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">标签</div><div class="length_num">61</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">分类</div><div class="length_num">69</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 时间线</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 友情链接</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fa fa-list"></i><span> 系列总结</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/categories/%E6%95%88%E7%8E%87%E6%8F%90%E5%8D%87%E6%8C%87%E5%8D%97/"><span> 效率提升指南</span></a></li><li><a class="site-page" href="/categories/%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91/Unreal/Python"><span> Unreal Python</span></a></li><li><a class="site-page" href="/categories/Python/Python-%E7%BC%96%E7%A8%8B%E8%A7%84%E8%8C%83/"><span> Python 编程规范</span></a></li><li><a class="site-page" href="/categories/CG/Qt/Python%E7%BB%93%E5%90%88Qt%E7%B3%BB%E5%88%97%E5%BC%80%E5%8F%91%E6%95%99%E7%A8%8B/"><span> Python Qt 开发教程</span></a></li><li><a class="site-page" href="/tags/VScode/"><span> VScode 全面使用攻略</span></a></li><li><a class="site-page" href="/categories/Wiki/TiddlyWiki-%E9%A3%9F%E7%94%A8%E6%8C%87%E5%8D%97"><span> TiddlyWiki 使用指南</span></a></li><li><a class="site-page" href="/categories/%E5%89%8D%E7%AB%AF/hexo/"><span> Hexo博客搭建历程</span></a></li><li><a class="site-page" href="/categories/Photogrammetry/"><span> Photogrammetry</span></a></li><li><a class="site-page" href="/categories/%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91/Unity/Shader%E5%AD%A6%E4%B9%A0%E4%B9%8B%E8%B7%AF/"><span> Shader学习之路</span></a></li><li><a class="site-page" href="/categories/CG/Maya/Maya%20%E7%A0%94%E7%A9%B6%E8%AE%B0%E5%BD%95"><span> Maya 研究记录</span></a></li><li><a class="site-page" href="/categories/%E5%89%8D%E7%AB%AF/Vue/Vue%E5%AD%A6%E4%B9%A0%E4%B9%8B%E8%B7%AF/"><span> Vue学习之路</span></a></li><li><a class="site-page" href="/categories/%E5%9B%9E%E5%BF%86%E5%BD%95/"><span> 回忆录</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fa fa-user"></i><span> 关于我</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> 博客初心</span></a></li><li><a class="site-page" href="/about/log.html"><i class="fa-fw fa fa-gift"></i><span> 博客日志</span></a></li><li><a class="site-page" target="_blank" rel="noopener" href="https://wiki.l0v0.com/"><i class="fa-fw fa fa-book"></i><span> wiki 文档</span></a></li><li><a class="site-page" target="_blank" rel="noopener" href="http://hou.l0v0.com"><i class="fa-fw fa fa-futbol"></i><span> Houdini Wiki</span></a></li><li><a class="site-page" href="/about/todo.html"><i class="fa-fw fa fa-check"></i><span> 更新计划</span></a></li><li><a class="site-page" href="/about/plan.html"><i class="fa-fw fa fa-lightbulb"></i><span> 教程计划</span></a></li><li><a class="site-page" href="/about/focus.html"><i class="fa-fw fa fa-bullseye"></i><span> 关注列表</span></a></li><li><a class="site-page" href="/about/note/note.html"><i class="fa-fw fa fa-sticky-note"></i><span> 我的笔记</span></a></li><li><a class="site-page" href="/about/my_work.html"><i class="fa-fw fa fa-briefcase"></i><span> 我的作品</span></a></li><li><a class="site-page" href="/about/contact.html"><i class="fa-fw fa fa-id-badge"></i><span> 联系我</span></a></li></ul></div></div></div></div><div id="body-wrap"><div id="sidebar"><i class="fas fa-arrow-right on" id="toggle-sidebar"></i><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A1%88%E4%BE%8B%E6%95%88%E6%9E%9C"><span class="toc-number">1.</span> <span class="toc-text">案例效果</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A0%B8%E5%BF%83%E6%80%9D%E8%B7%AF"><span class="toc-number">2.</span> <span class="toc-text">核心思路</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%84%9A%E6%9C%AC%E5%89%8D%E8%A8%80"><span class="toc-number">3.</span> <span class="toc-text">脚本前言</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BD%91%E9%A1%B5%E4%BB%A3%E7%A0%81"><span class="toc-number">4.</span> <span class="toc-text">网页代码</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#scene-init-ver3-0"><span class="toc-number">5.</span> <span class="toc-text">scene_init-ver3.0</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#import-js%E5%8F%82%E8%80%83%E5%86%99%E6%B3%95"><span class="toc-number">6.</span> <span class="toc-text">import.js参考写法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-number">7.</span> <span class="toc-text">总结</span></a></li></ol></div></div></div><header class="post-bg" id="page-header" style="background-image: url(//cdn.jsdelivr.net/gh/FXTD-odyssey/FXTD-odyssey.github.io@master/img/cover_04.png)"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">智伤帝的个人博客</a></span><span id="menus"><div id="search_button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 时间线</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 友情链接</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fa fa-list"></i><span> 系列总结</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/categories/%E6%95%88%E7%8E%87%E6%8F%90%E5%8D%87%E6%8C%87%E5%8D%97/"><span> 效率提升指南</span></a></li><li><a class="site-page" href="/categories/%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91/Unreal/Python"><span> Unreal Python</span></a></li><li><a class="site-page" href="/categories/Python/Python-%E7%BC%96%E7%A8%8B%E8%A7%84%E8%8C%83/"><span> Python 编程规范</span></a></li><li><a class="site-page" href="/categories/CG/Qt/Python%E7%BB%93%E5%90%88Qt%E7%B3%BB%E5%88%97%E5%BC%80%E5%8F%91%E6%95%99%E7%A8%8B/"><span> Python Qt 开发教程</span></a></li><li><a class="site-page" href="/tags/VScode/"><span> VScode 全面使用攻略</span></a></li><li><a class="site-page" href="/categories/Wiki/TiddlyWiki-%E9%A3%9F%E7%94%A8%E6%8C%87%E5%8D%97"><span> TiddlyWiki 使用指南</span></a></li><li><a class="site-page" href="/categories/%E5%89%8D%E7%AB%AF/hexo/"><span> Hexo博客搭建历程</span></a></li><li><a class="site-page" href="/categories/Photogrammetry/"><span> Photogrammetry</span></a></li><li><a class="site-page" href="/categories/%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91/Unity/Shader%E5%AD%A6%E4%B9%A0%E4%B9%8B%E8%B7%AF/"><span> Shader学习之路</span></a></li><li><a class="site-page" href="/categories/CG/Maya/Maya%20%E7%A0%94%E7%A9%B6%E8%AE%B0%E5%BD%95"><span> Maya 研究记录</span></a></li><li><a class="site-page" href="/categories/%E5%89%8D%E7%AB%AF/Vue/Vue%E5%AD%A6%E4%B9%A0%E4%B9%8B%E8%B7%AF/"><span> Vue学习之路</span></a></li><li><a class="site-page" href="/categories/%E5%9B%9E%E5%BF%86%E5%BD%95/"><span> 回忆录</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fa fa-user"></i><span> 关于我</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> 博客初心</span></a></li><li><a class="site-page" href="/about/log.html"><i class="fa-fw fa fa-gift"></i><span> 博客日志</span></a></li><li><a class="site-page" target="_blank" rel="noopener" href="https://wiki.l0v0.com/"><i class="fa-fw fa fa-book"></i><span> wiki 文档</span></a></li><li><a class="site-page" target="_blank" rel="noopener" href="http://hou.l0v0.com"><i class="fa-fw fa fa-futbol"></i><span> Houdini Wiki</span></a></li><li><a class="site-page" href="/about/todo.html"><i class="fa-fw fa fa-check"></i><span> 更新计划</span></a></li><li><a class="site-page" href="/about/plan.html"><i class="fa-fw fa fa-lightbulb"></i><span> 教程计划</span></a></li><li><a class="site-page" href="/about/focus.html"><i class="fa-fw fa fa-bullseye"></i><span> 关注列表</span></a></li><li><a class="site-page" href="/about/note/note.html"><i class="fa-fw fa fa-sticky-note"></i><span> 我的笔记</span></a></li><li><a class="site-page" href="/about/my_work.html"><i class="fa-fw fa fa-briefcase"></i><span> 我的作品</span></a></li><li><a class="site-page" href="/about/contact.html"><i class="fa-fw fa fa-id-badge"></i><span> 联系我</span></a></li></ul></div></div><span class="close" id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></span></span></nav><div id="post-info"><div id="post-title"><div class="posttitle">Three.js - 学习之路（四）</div></div><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2018-08-01T12:15:28.000Z" title="发表于 2018-08-01 20:15:28">2018-08-01</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2022-11-09T02:37:04.714Z" title="更新于 2022-11-09 10:37:04">2022-11-09</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%89%8D%E7%AB%AF/">前端</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%89%8D%E7%AB%AF/three-js/">three.js</a></span></div><div class="meta-secondline"> <span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">16.4k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>91分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout_post" id="content-inner"><article id="post"><div class="post-content" id="article-container"><span id="more"></span>
<h2 id="案例效果"><a href="#案例效果" class="headerlink" title="案例效果"></a>案例效果</h2><blockquote>
<p><strong><a href="../my_work/OPENGL_homework/old_Method">OpenGL(WebGL) 大作业 面向过程封装</a></strong></p>
</blockquote>
<h2 id="核心思路"><a href="#核心思路" class="headerlink" title="核心思路"></a>核心思路</h2><blockquote>
<p>通过一个js提前将场景、灯光、控制按钮生成出来<br>只需要关心模型导入的部分以及刷新部分的编写</p>
</blockquote>
<h2 id="脚本前言"><a href="#脚本前言" class="headerlink" title="脚本前言"></a>脚本前言</h2><blockquote>
<p>这个脚本是今年（2018年）寒假的时候在聪哥家里学习three.js写的<br>我更新到了第三版之后，后面改成了面向对象的写法</p>
</blockquote>
<h2 id="网页代码"><a href="#网页代码" class="headerlink" title="网页代码"></a>网页代码</h2><blockquote>
<p>脚本依赖于以下的库</p>
</blockquote>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">body</span>&gt;</span></span><br><span class="line">   <span class="comment">&lt;!--设置webgl的id让threejs链接--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;webgl&quot;</span>&gt;</span></span><br><span class="line">      </span><br><span class="line">        <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;logo&quot;</span>&gt;</span></span><br><span class="line">           <span class="tag">&lt;<span class="name">div</span> <span class="attr">id</span>=<span class="string">&quot;container&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;js/jquery-3.2.1.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--链接threejs的库--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;js/three.js-master/build/three.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span><span class="comment">&lt;!--threejs 的主要脚本--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;js/three.js-master/examples/js/controls/OrbitControls.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span><span class="comment">&lt;!--实现摄像机点击旋转平移的脚本--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;js/three.js-master/examples/js/controls/PointerLockControls.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;js/three.js-master/examples/js/controls/TransformControls.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;js/three.js-master/examples/js/shaders/BokehShader2.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;js/three.js-master/examples/libs/stats.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span><span class="comment">&lt;!--显示帧率的脚本--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;js/three.js-master/examples/libs/dat.gui.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span><span class="comment">&lt;!--实现简单的gui界面方便调试的脚本--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;js/three.js-master/loaders/OBJLoader.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span><span class="comment">&lt;!--加载OBJ的脚本--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;js/three.js-master/loaders/DDSLoader.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span><span class="comment">&lt;!--加载DDS的脚本--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;js/three.js-master/examples/js/Detector.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span><span class="comment">&lt;!--检测webgl启动的脚本 目前已无使用--&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&lt;!--链接html5tooltips的库 实现小标签动画--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;js/microjs/html5tooltips/html5tooltips.1.7.2.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text/css&quot;</span> <span class="attr">href</span>=<span class="string">&quot;js/microjs/html5tooltips/html5tooltips.animation.css&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">link</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">link</span> <span class="attr">rel</span>=<span class="string">&quot;stylesheet&quot;</span> <span class="attr">type</span>=<span class="string">&quot;text/css&quot;</span> <span class="attr">href</span>=<span class="string">&quot;js/microjs/html5tooltips/html5tooltips.css&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">link</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&lt;!--链接animatelo的库 目前还没有使用--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;js/microjs/animatelo-master/dist/animatelo.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&lt;!--链接picoModal的库 实现按钮弹窗--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;js/microjs/picoModal.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&lt;!--链接isMobile的库 检测移动设备--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;js/microjs/isMobile/isMobile.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">&lt;!--链接progressbar的库 快速生成加载条--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;js/microjs/progressbar.min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--链接webglreport的库 检测webgl是否开启--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;js/underscore-min.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">&lt;!--导入封装用的js--&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;plugin/scene_init-ver3.0.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">script</span> <span class="attr">src</span>=<span class="string">&quot;plugin/import.js&quot;</span>&gt;</span><span class="tag">&lt;/<span class="name">script</span>&gt;</span></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"><span class="tag">&lt;/<span class="name">body</span>&gt;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="scene-init-ver3-0"><a href="#scene-init-ver3-0" class="headerlink" title="scene_init-ver3.0"></a>scene_init-ver3.0</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br><span class="line">173</span><br><span class="line">174</span><br><span class="line">175</span><br><span class="line">176</span><br><span class="line">177</span><br><span class="line">178</span><br><span class="line">179</span><br><span class="line">180</span><br><span class="line">181</span><br><span class="line">182</span><br><span class="line">183</span><br><span class="line">184</span><br><span class="line">185</span><br><span class="line">186</span><br><span class="line">187</span><br><span class="line">188</span><br><span class="line">189</span><br><span class="line">190</span><br><span class="line">191</span><br><span class="line">192</span><br><span class="line">193</span><br><span class="line">194</span><br><span class="line">195</span><br><span class="line">196</span><br><span class="line">197</span><br><span class="line">198</span><br><span class="line">199</span><br><span class="line">200</span><br><span class="line">201</span><br><span class="line">202</span><br><span class="line">203</span><br><span class="line">204</span><br><span class="line">205</span><br><span class="line">206</span><br><span class="line">207</span><br><span class="line">208</span><br><span class="line">209</span><br><span class="line">210</span><br><span class="line">211</span><br><span class="line">212</span><br><span class="line">213</span><br><span class="line">214</span><br><span class="line">215</span><br><span class="line">216</span><br><span class="line">217</span><br><span class="line">218</span><br><span class="line">219</span><br><span class="line">220</span><br><span class="line">221</span><br><span class="line">222</span><br><span class="line">223</span><br><span class="line">224</span><br><span class="line">225</span><br><span class="line">226</span><br><span class="line">227</span><br><span class="line">228</span><br><span class="line">229</span><br><span class="line">230</span><br><span class="line">231</span><br><span class="line">232</span><br><span class="line">233</span><br><span class="line">234</span><br><span class="line">235</span><br><span class="line">236</span><br><span class="line">237</span><br><span class="line">238</span><br><span class="line">239</span><br><span class="line">240</span><br><span class="line">241</span><br><span class="line">242</span><br><span class="line">243</span><br><span class="line">244</span><br><span class="line">245</span><br><span class="line">246</span><br><span class="line">247</span><br><span class="line">248</span><br><span class="line">249</span><br><span class="line">250</span><br><span class="line">251</span><br><span class="line">252</span><br><span class="line">253</span><br><span class="line">254</span><br><span class="line">255</span><br><span class="line">256</span><br><span class="line">257</span><br><span class="line">258</span><br><span class="line">259</span><br><span class="line">260</span><br><span class="line">261</span><br><span class="line">262</span><br><span class="line">263</span><br><span class="line">264</span><br><span class="line">265</span><br><span class="line">266</span><br><span class="line">267</span><br><span class="line">268</span><br><span class="line">269</span><br><span class="line">270</span><br><span class="line">271</span><br><span class="line">272</span><br><span class="line">273</span><br><span class="line">274</span><br><span class="line">275</span><br><span class="line">276</span><br><span class="line">277</span><br><span class="line">278</span><br><span class="line">279</span><br><span class="line">280</span><br><span class="line">281</span><br><span class="line">282</span><br><span class="line">283</span><br><span class="line">284</span><br><span class="line">285</span><br><span class="line">286</span><br><span class="line">287</span><br><span class="line">288</span><br><span class="line">289</span><br><span class="line">290</span><br><span class="line">291</span><br><span class="line">292</span><br><span class="line">293</span><br><span class="line">294</span><br><span class="line">295</span><br><span class="line">296</span><br><span class="line">297</span><br><span class="line">298</span><br><span class="line">299</span><br><span class="line">300</span><br><span class="line">301</span><br><span class="line">302</span><br><span class="line">303</span><br><span class="line">304</span><br><span class="line">305</span><br><span class="line">306</span><br><span class="line">307</span><br><span class="line">308</span><br><span class="line">309</span><br><span class="line">310</span><br><span class="line">311</span><br><span class="line">312</span><br><span class="line">313</span><br><span class="line">314</span><br><span class="line">315</span><br><span class="line">316</span><br><span class="line">317</span><br><span class="line">318</span><br><span class="line">319</span><br><span class="line">320</span><br><span class="line">321</span><br><span class="line">322</span><br><span class="line">323</span><br><span class="line">324</span><br><span class="line">325</span><br><span class="line">326</span><br><span class="line">327</span><br><span class="line">328</span><br><span class="line">329</span><br><span class="line">330</span><br><span class="line">331</span><br><span class="line">332</span><br><span class="line">333</span><br><span class="line">334</span><br><span class="line">335</span><br><span class="line">336</span><br><span class="line">337</span><br><span class="line">338</span><br><span class="line">339</span><br><span class="line">340</span><br><span class="line">341</span><br><span class="line">342</span><br><span class="line">343</span><br><span class="line">344</span><br><span class="line">345</span><br><span class="line">346</span><br><span class="line">347</span><br><span class="line">348</span><br><span class="line">349</span><br><span class="line">350</span><br><span class="line">351</span><br><span class="line">352</span><br><span class="line">353</span><br><span class="line">354</span><br><span class="line">355</span><br><span class="line">356</span><br><span class="line">357</span><br><span class="line">358</span><br><span class="line">359</span><br><span class="line">360</span><br><span class="line">361</span><br><span class="line">362</span><br><span class="line">363</span><br><span class="line">364</span><br><span class="line">365</span><br><span class="line">366</span><br><span class="line">367</span><br><span class="line">368</span><br><span class="line">369</span><br><span class="line">370</span><br><span class="line">371</span><br><span class="line">372</span><br><span class="line">373</span><br><span class="line">374</span><br><span class="line">375</span><br><span class="line">376</span><br><span class="line">377</span><br><span class="line">378</span><br><span class="line">379</span><br><span class="line">380</span><br><span class="line">381</span><br><span class="line">382</span><br><span class="line">383</span><br><span class="line">384</span><br><span class="line">385</span><br><span class="line">386</span><br><span class="line">387</span><br><span class="line">388</span><br><span class="line">389</span><br><span class="line">390</span><br><span class="line">391</span><br><span class="line">392</span><br><span class="line">393</span><br><span class="line">394</span><br><span class="line">395</span><br><span class="line">396</span><br><span class="line">397</span><br><span class="line">398</span><br><span class="line">399</span><br><span class="line">400</span><br><span class="line">401</span><br><span class="line">402</span><br><span class="line">403</span><br><span class="line">404</span><br><span class="line">405</span><br><span class="line">406</span><br><span class="line">407</span><br><span class="line">408</span><br><span class="line">409</span><br><span class="line">410</span><br><span class="line">411</span><br><span class="line">412</span><br><span class="line">413</span><br><span class="line">414</span><br><span class="line">415</span><br><span class="line">416</span><br><span class="line">417</span><br><span class="line">418</span><br><span class="line">419</span><br><span class="line">420</span><br><span class="line">421</span><br><span class="line">422</span><br><span class="line">423</span><br><span class="line">424</span><br><span class="line">425</span><br><span class="line">426</span><br><span class="line">427</span><br><span class="line">428</span><br><span class="line">429</span><br><span class="line">430</span><br><span class="line">431</span><br><span class="line">432</span><br><span class="line">433</span><br><span class="line">434</span><br><span class="line">435</span><br><span class="line">436</span><br><span class="line">437</span><br><span class="line">438</span><br><span class="line">439</span><br><span class="line">440</span><br><span class="line">441</span><br><span class="line">442</span><br><span class="line">443</span><br><span class="line">444</span><br><span class="line">445</span><br><span class="line">446</span><br><span class="line">447</span><br><span class="line">448</span><br><span class="line">449</span><br><span class="line">450</span><br><span class="line">451</span><br><span class="line">452</span><br><span class="line">453</span><br><span class="line">454</span><br><span class="line">455</span><br><span class="line">456</span><br><span class="line">457</span><br><span class="line">458</span><br><span class="line">459</span><br><span class="line">460</span><br><span class="line">461</span><br><span class="line">462</span><br><span class="line">463</span><br><span class="line">464</span><br><span class="line">465</span><br><span class="line">466</span><br><span class="line">467</span><br><span class="line">468</span><br><span class="line">469</span><br><span class="line">470</span><br><span class="line">471</span><br><span class="line">472</span><br><span class="line">473</span><br><span class="line">474</span><br><span class="line">475</span><br><span class="line">476</span><br><span class="line">477</span><br><span class="line">478</span><br><span class="line">479</span><br><span class="line">480</span><br><span class="line">481</span><br><span class="line">482</span><br><span class="line">483</span><br><span class="line">484</span><br><span class="line">485</span><br><span class="line">486</span><br><span class="line">487</span><br><span class="line">488</span><br><span class="line">489</span><br><span class="line">490</span><br><span class="line">491</span><br><span class="line">492</span><br><span class="line">493</span><br><span class="line">494</span><br><span class="line">495</span><br><span class="line">496</span><br><span class="line">497</span><br><span class="line">498</span><br><span class="line">499</span><br><span class="line">500</span><br><span class="line">501</span><br><span class="line">502</span><br><span class="line">503</span><br><span class="line">504</span><br><span class="line">505</span><br><span class="line">506</span><br><span class="line">507</span><br><span class="line">508</span><br><span class="line">509</span><br><span class="line">510</span><br><span class="line">511</span><br><span class="line">512</span><br><span class="line">513</span><br><span class="line">514</span><br><span class="line">515</span><br><span class="line">516</span><br><span class="line">517</span><br><span class="line">518</span><br><span class="line">519</span><br><span class="line">520</span><br><span class="line">521</span><br><span class="line">522</span><br><span class="line">523</span><br><span class="line">524</span><br><span class="line">525</span><br><span class="line">526</span><br><span class="line">527</span><br><span class="line">528</span><br><span class="line">529</span><br><span class="line">530</span><br><span class="line">531</span><br><span class="line">532</span><br><span class="line">533</span><br><span class="line">534</span><br><span class="line">535</span><br><span class="line">536</span><br><span class="line">537</span><br><span class="line">538</span><br><span class="line">539</span><br><span class="line">540</span><br><span class="line">541</span><br><span class="line">542</span><br><span class="line">543</span><br><span class="line">544</span><br><span class="line">545</span><br><span class="line">546</span><br><span class="line">547</span><br><span class="line">548</span><br><span class="line">549</span><br><span class="line">550</span><br><span class="line">551</span><br><span class="line">552</span><br><span class="line">553</span><br><span class="line">554</span><br><span class="line">555</span><br><span class="line">556</span><br><span class="line">557</span><br><span class="line">558</span><br><span class="line">559</span><br><span class="line">560</span><br><span class="line">561</span><br><span class="line">562</span><br><span class="line">563</span><br><span class="line">564</span><br><span class="line">565</span><br><span class="line">566</span><br><span class="line">567</span><br><span class="line">568</span><br><span class="line">569</span><br><span class="line">570</span><br><span class="line">571</span><br><span class="line">572</span><br><span class="line">573</span><br><span class="line">574</span><br><span class="line">575</span><br><span class="line">576</span><br><span class="line">577</span><br><span class="line">578</span><br><span class="line">579</span><br><span class="line">580</span><br><span class="line">581</span><br><span class="line">582</span><br><span class="line">583</span><br><span class="line">584</span><br><span class="line">585</span><br><span class="line">586</span><br><span class="line">587</span><br><span class="line">588</span><br><span class="line">589</span><br><span class="line">590</span><br><span class="line">591</span><br><span class="line">592</span><br><span class="line">593</span><br><span class="line">594</span><br><span class="line">595</span><br><span class="line">596</span><br><span class="line">597</span><br><span class="line">598</span><br><span class="line">599</span><br><span class="line">600</span><br><span class="line">601</span><br><span class="line">602</span><br><span class="line">603</span><br><span class="line">604</span><br><span class="line">605</span><br><span class="line">606</span><br><span class="line">607</span><br><span class="line">608</span><br><span class="line">609</span><br><span class="line">610</span><br><span class="line">611</span><br><span class="line">612</span><br><span class="line">613</span><br><span class="line">614</span><br><span class="line">615</span><br><span class="line">616</span><br><span class="line">617</span><br><span class="line">618</span><br><span class="line">619</span><br><span class="line">620</span><br><span class="line">621</span><br><span class="line">622</span><br><span class="line">623</span><br><span class="line">624</span><br><span class="line">625</span><br><span class="line">626</span><br><span class="line">627</span><br><span class="line">628</span><br><span class="line">629</span><br><span class="line">630</span><br><span class="line">631</span><br><span class="line">632</span><br><span class="line">633</span><br><span class="line">634</span><br><span class="line">635</span><br><span class="line">636</span><br><span class="line">637</span><br><span class="line">638</span><br><span class="line">639</span><br><span class="line">640</span><br><span class="line">641</span><br><span class="line">642</span><br><span class="line">643</span><br><span class="line">644</span><br><span class="line">645</span><br><span class="line">646</span><br><span class="line">647</span><br><span class="line">648</span><br><span class="line">649</span><br><span class="line">650</span><br><span class="line">651</span><br><span class="line">652</span><br><span class="line">653</span><br><span class="line">654</span><br><span class="line">655</span><br><span class="line">656</span><br><span class="line">657</span><br><span class="line">658</span><br><span class="line">659</span><br><span class="line">660</span><br><span class="line">661</span><br><span class="line">662</span><br><span class="line">663</span><br><span class="line">664</span><br><span class="line">665</span><br><span class="line">666</span><br><span class="line">667</span><br><span class="line">668</span><br><span class="line">669</span><br><span class="line">670</span><br><span class="line">671</span><br><span class="line">672</span><br><span class="line">673</span><br><span class="line">674</span><br><span class="line">675</span><br><span class="line">676</span><br><span class="line">677</span><br><span class="line">678</span><br><span class="line">679</span><br><span class="line">680</span><br><span class="line">681</span><br><span class="line">682</span><br><span class="line">683</span><br><span class="line">684</span><br><span class="line">685</span><br><span class="line">686</span><br><span class="line">687</span><br><span class="line">688</span><br><span class="line">689</span><br><span class="line">690</span><br><span class="line">691</span><br><span class="line">692</span><br><span class="line">693</span><br><span class="line">694</span><br><span class="line">695</span><br><span class="line">696</span><br><span class="line">697</span><br><span class="line">698</span><br><span class="line">699</span><br><span class="line">700</span><br><span class="line">701</span><br><span class="line">702</span><br><span class="line">703</span><br><span class="line">704</span><br><span class="line">705</span><br><span class="line">706</span><br><span class="line">707</span><br><span class="line">708</span><br><span class="line">709</span><br><span class="line">710</span><br><span class="line">711</span><br><span class="line">712</span><br><span class="line">713</span><br><span class="line">714</span><br><span class="line">715</span><br><span class="line">716</span><br><span class="line">717</span><br><span class="line">718</span><br><span class="line">719</span><br><span class="line">720</span><br><span class="line">721</span><br><span class="line">722</span><br><span class="line">723</span><br><span class="line">724</span><br><span class="line">725</span><br><span class="line">726</span><br><span class="line">727</span><br><span class="line">728</span><br><span class="line">729</span><br><span class="line">730</span><br><span class="line">731</span><br><span class="line">732</span><br><span class="line">733</span><br><span class="line">734</span><br><span class="line">735</span><br><span class="line">736</span><br><span class="line">737</span><br><span class="line">738</span><br><span class="line">739</span><br><span class="line">740</span><br><span class="line">741</span><br><span class="line">742</span><br><span class="line">743</span><br><span class="line">744</span><br><span class="line">745</span><br><span class="line">746</span><br><span class="line">747</span><br><span class="line">748</span><br><span class="line">749</span><br><span class="line">750</span><br><span class="line">751</span><br><span class="line">752</span><br><span class="line">753</span><br><span class="line">754</span><br><span class="line">755</span><br><span class="line">756</span><br><span class="line">757</span><br><span class="line">758</span><br><span class="line">759</span><br><span class="line">760</span><br><span class="line">761</span><br><span class="line">762</span><br><span class="line">763</span><br><span class="line">764</span><br><span class="line">765</span><br><span class="line">766</span><br><span class="line">767</span><br><span class="line">768</span><br><span class="line">769</span><br><span class="line">770</span><br><span class="line">771</span><br><span class="line">772</span><br><span class="line">773</span><br><span class="line">774</span><br><span class="line">775</span><br><span class="line">776</span><br><span class="line">777</span><br><span class="line">778</span><br><span class="line">779</span><br><span class="line">780</span><br><span class="line">781</span><br><span class="line">782</span><br><span class="line">783</span><br><span class="line">784</span><br><span class="line">785</span><br><span class="line">786</span><br><span class="line">787</span><br><span class="line">788</span><br><span class="line">789</span><br><span class="line">790</span><br><span class="line">791</span><br><span class="line">792</span><br><span class="line">793</span><br><span class="line">794</span><br><span class="line">795</span><br><span class="line">796</span><br><span class="line">797</span><br><span class="line">798</span><br><span class="line">799</span><br><span class="line">800</span><br><span class="line">801</span><br><span class="line">802</span><br><span class="line">803</span><br><span class="line">804</span><br><span class="line">805</span><br><span class="line">806</span><br><span class="line">807</span><br><span class="line">808</span><br><span class="line">809</span><br><span class="line">810</span><br><span class="line">811</span><br><span class="line">812</span><br><span class="line">813</span><br><span class="line">814</span><br><span class="line">815</span><br><span class="line">816</span><br><span class="line">817</span><br><span class="line">818</span><br><span class="line">819</span><br><span class="line">820</span><br><span class="line">821</span><br><span class="line">822</span><br><span class="line">823</span><br><span class="line">824</span><br><span class="line">825</span><br><span class="line">826</span><br><span class="line">827</span><br><span class="line">828</span><br><span class="line">829</span><br><span class="line">830</span><br><span class="line">831</span><br><span class="line">832</span><br><span class="line">833</span><br><span class="line">834</span><br><span class="line">835</span><br><span class="line">836</span><br><span class="line">837</span><br><span class="line">838</span><br><span class="line">839</span><br><span class="line">840</span><br><span class="line">841</span><br><span class="line">842</span><br><span class="line">843</span><br><span class="line">844</span><br><span class="line">845</span><br><span class="line">846</span><br><span class="line">847</span><br><span class="line">848</span><br><span class="line">849</span><br><span class="line">850</span><br><span class="line">851</span><br><span class="line">852</span><br><span class="line">853</span><br><span class="line">854</span><br><span class="line">855</span><br><span class="line">856</span><br><span class="line">857</span><br><span class="line">858</span><br><span class="line">859</span><br><span class="line">860</span><br><span class="line">861</span><br><span class="line">862</span><br><span class="line">863</span><br><span class="line">864</span><br><span class="line">865</span><br><span class="line">866</span><br><span class="line">867</span><br><span class="line">868</span><br><span class="line">869</span><br><span class="line">870</span><br><span class="line">871</span><br><span class="line">872</span><br><span class="line">873</span><br><span class="line">874</span><br><span class="line">875</span><br><span class="line">876</span><br><span class="line">877</span><br><span class="line">878</span><br><span class="line">879</span><br><span class="line">880</span><br><span class="line">881</span><br><span class="line">882</span><br><span class="line">883</span><br><span class="line">884</span><br><span class="line">885</span><br><span class="line">886</span><br><span class="line">887</span><br><span class="line">888</span><br><span class="line">889</span><br><span class="line">890</span><br><span class="line">891</span><br><span class="line">892</span><br><span class="line">893</span><br><span class="line">894</span><br><span class="line">895</span><br><span class="line">896</span><br><span class="line">897</span><br><span class="line">898</span><br><span class="line">899</span><br><span class="line">900</span><br><span class="line">901</span><br><span class="line">902</span><br><span class="line">903</span><br><span class="line">904</span><br><span class="line">905</span><br><span class="line">906</span><br><span class="line">907</span><br><span class="line">908</span><br><span class="line">909</span><br><span class="line">910</span><br><span class="line">911</span><br><span class="line">912</span><br><span class="line">913</span><br><span class="line">914</span><br><span class="line">915</span><br><span class="line">916</span><br><span class="line">917</span><br><span class="line">918</span><br><span class="line">919</span><br><span class="line">920</span><br><span class="line">921</span><br><span class="line">922</span><br><span class="line">923</span><br><span class="line">924</span><br><span class="line">925</span><br><span class="line">926</span><br><span class="line">927</span><br><span class="line">928</span><br><span class="line">929</span><br><span class="line">930</span><br><span class="line">931</span><br><span class="line">932</span><br><span class="line">933</span><br><span class="line">934</span><br><span class="line">935</span><br><span class="line">936</span><br><span class="line">937</span><br><span class="line">938</span><br><span class="line">939</span><br><span class="line">940</span><br><span class="line">941</span><br><span class="line">942</span><br><span class="line">943</span><br><span class="line">944</span><br><span class="line">945</span><br><span class="line">946</span><br><span class="line">947</span><br><span class="line">948</span><br><span class="line">949</span><br><span class="line">950</span><br><span class="line">951</span><br><span class="line">952</span><br><span class="line">953</span><br><span class="line">954</span><br><span class="line">955</span><br><span class="line">956</span><br><span class="line">957</span><br><span class="line">958</span><br><span class="line">959</span><br><span class="line">960</span><br><span class="line">961</span><br><span class="line">962</span><br><span class="line">963</span><br><span class="line">964</span><br><span class="line">965</span><br><span class="line">966</span><br><span class="line">967</span><br><span class="line">968</span><br><span class="line">969</span><br><span class="line">970</span><br><span class="line">971</span><br><span class="line">972</span><br><span class="line">973</span><br><span class="line">974</span><br><span class="line">975</span><br><span class="line">976</span><br><span class="line">977</span><br><span class="line">978</span><br><span class="line">979</span><br><span class="line">980</span><br><span class="line">981</span><br><span class="line">982</span><br><span class="line">983</span><br><span class="line">984</span><br><span class="line">985</span><br><span class="line">986</span><br><span class="line">987</span><br><span class="line">988</span><br><span class="line">989</span><br><span class="line">990</span><br><span class="line">991</span><br><span class="line">992</span><br><span class="line">993</span><br><span class="line">994</span><br><span class="line">995</span><br><span class="line">996</span><br><span class="line">997</span><br><span class="line">998</span><br><span class="line">999</span><br><span class="line">1000</span><br><span class="line">1001</span><br><span class="line">1002</span><br><span class="line">1003</span><br><span class="line">1004</span><br><span class="line">1005</span><br><span class="line">1006</span><br><span class="line">1007</span><br><span class="line">1008</span><br><span class="line">1009</span><br><span class="line">1010</span><br><span class="line">1011</span><br><span class="line">1012</span><br><span class="line">1013</span><br><span class="line">1014</span><br><span class="line">1015</span><br><span class="line">1016</span><br><span class="line">1017</span><br><span class="line">1018</span><br><span class="line">1019</span><br><span class="line">1020</span><br><span class="line">1021</span><br><span class="line">1022</span><br><span class="line">1023</span><br><span class="line">1024</span><br><span class="line">1025</span><br><span class="line">1026</span><br><span class="line">1027</span><br><span class="line">1028</span><br><span class="line">1029</span><br><span class="line">1030</span><br><span class="line">1031</span><br><span class="line">1032</span><br><span class="line">1033</span><br><span class="line">1034</span><br><span class="line">1035</span><br><span class="line">1036</span><br><span class="line">1037</span><br><span class="line">1038</span><br><span class="line">1039</span><br><span class="line">1040</span><br><span class="line">1041</span><br><span class="line">1042</span><br><span class="line">1043</span><br><span class="line">1044</span><br><span class="line">1045</span><br><span class="line">1046</span><br><span class="line">1047</span><br><span class="line">1048</span><br><span class="line">1049</span><br><span class="line">1050</span><br><span class="line">1051</span><br><span class="line">1052</span><br><span class="line">1053</span><br><span class="line">1054</span><br><span class="line">1055</span><br><span class="line">1056</span><br><span class="line">1057</span><br><span class="line">1058</span><br><span class="line">1059</span><br><span class="line">1060</span><br><span class="line">1061</span><br><span class="line">1062</span><br><span class="line">1063</span><br><span class="line">1064</span><br><span class="line">1065</span><br><span class="line">1066</span><br><span class="line">1067</span><br><span class="line">1068</span><br><span class="line">1069</span><br><span class="line">1070</span><br><span class="line">1071</span><br><span class="line">1072</span><br><span class="line">1073</span><br><span class="line">1074</span><br><span class="line">1075</span><br><span class="line">1076</span><br><span class="line">1077</span><br><span class="line">1078</span><br><span class="line">1079</span><br><span class="line">1080</span><br><span class="line">1081</span><br><span class="line">1082</span><br><span class="line">1083</span><br><span class="line">1084</span><br><span class="line">1085</span><br><span class="line">1086</span><br><span class="line">1087</span><br><span class="line">1088</span><br><span class="line">1089</span><br><span class="line">1090</span><br><span class="line">1091</span><br><span class="line">1092</span><br><span class="line">1093</span><br><span class="line">1094</span><br><span class="line">1095</span><br><span class="line">1096</span><br><span class="line">1097</span><br><span class="line">1098</span><br><span class="line">1099</span><br><span class="line">1100</span><br><span class="line">1101</span><br><span class="line">1102</span><br><span class="line">1103</span><br><span class="line">1104</span><br><span class="line">1105</span><br><span class="line">1106</span><br><span class="line">1107</span><br><span class="line">1108</span><br><span class="line">1109</span><br><span class="line">1110</span><br><span class="line">1111</span><br><span class="line">1112</span><br><span class="line">1113</span><br><span class="line">1114</span><br><span class="line">1115</span><br><span class="line">1116</span><br><span class="line">1117</span><br><span class="line">1118</span><br><span class="line">1119</span><br><span class="line">1120</span><br><span class="line">1121</span><br><span class="line">1122</span><br><span class="line">1123</span><br><span class="line">1124</span><br><span class="line">1125</span><br><span class="line">1126</span><br><span class="line">1127</span><br><span class="line">1128</span><br><span class="line">1129</span><br><span class="line">1130</span><br><span class="line">1131</span><br><span class="line">1132</span><br><span class="line">1133</span><br><span class="line">1134</span><br><span class="line">1135</span><br><span class="line">1136</span><br><span class="line">1137</span><br><span class="line">1138</span><br><span class="line">1139</span><br><span class="line">1140</span><br><span class="line">1141</span><br><span class="line">1142</span><br><span class="line">1143</span><br><span class="line">1144</span><br><span class="line">1145</span><br><span class="line">1146</span><br><span class="line">1147</span><br><span class="line">1148</span><br><span class="line">1149</span><br><span class="line">1150</span><br><span class="line">1151</span><br><span class="line">1152</span><br><span class="line">1153</span><br><span class="line">1154</span><br><span class="line">1155</span><br><span class="line">1156</span><br><span class="line">1157</span><br><span class="line">1158</span><br><span class="line">1159</span><br><span class="line">1160</span><br><span class="line">1161</span><br><span class="line">1162</span><br><span class="line">1163</span><br><span class="line">1164</span><br><span class="line">1165</span><br><span class="line">1166</span><br><span class="line">1167</span><br><span class="line">1168</span><br><span class="line">1169</span><br><span class="line">1170</span><br><span class="line">1171</span><br><span class="line">1172</span><br><span class="line">1173</span><br><span class="line">1174</span><br><span class="line">1175</span><br><span class="line">1176</span><br><span class="line">1177</span><br><span class="line">1178</span><br><span class="line">1179</span><br><span class="line">1180</span><br><span class="line">1181</span><br><span class="line">1182</span><br><span class="line">1183</span><br><span class="line">1184</span><br><span class="line">1185</span><br><span class="line">1186</span><br><span class="line">1187</span><br><span class="line">1188</span><br><span class="line">1189</span><br><span class="line">1190</span><br><span class="line">1191</span><br><span class="line">1192</span><br><span class="line">1193</span><br><span class="line">1194</span><br><span class="line">1195</span><br><span class="line">1196</span><br><span class="line">1197</span><br><span class="line">1198</span><br><span class="line">1199</span><br><span class="line">1200</span><br><span class="line">1201</span><br><span class="line">1202</span><br><span class="line">1203</span><br><span class="line">1204</span><br><span class="line">1205</span><br><span class="line">1206</span><br><span class="line">1207</span><br><span class="line">1208</span><br><span class="line">1209</span><br><span class="line">1210</span><br><span class="line">1211</span><br><span class="line">1212</span><br><span class="line">1213</span><br><span class="line">1214</span><br><span class="line">1215</span><br><span class="line">1216</span><br><span class="line">1217</span><br><span class="line">1218</span><br><span class="line">1219</span><br><span class="line">1220</span><br><span class="line">1221</span><br><span class="line">1222</span><br><span class="line">1223</span><br><span class="line">1224</span><br><span class="line">1225</span><br><span class="line">1226</span><br><span class="line">1227</span><br><span class="line">1228</span><br><span class="line">1229</span><br><span class="line">1230</span><br><span class="line">1231</span><br><span class="line">1232</span><br><span class="line">1233</span><br><span class="line">1234</span><br><span class="line">1235</span><br><span class="line">1236</span><br><span class="line">1237</span><br><span class="line">1238</span><br><span class="line">1239</span><br><span class="line">1240</span><br><span class="line">1241</span><br><span class="line">1242</span><br><span class="line">1243</span><br><span class="line">1244</span><br><span class="line">1245</span><br><span class="line">1246</span><br><span class="line">1247</span><br><span class="line">1248</span><br><span class="line">1249</span><br><span class="line">1250</span><br><span class="line">1251</span><br><span class="line">1252</span><br><span class="line">1253</span><br><span class="line">1254</span><br><span class="line">1255</span><br><span class="line">1256</span><br><span class="line">1257</span><br><span class="line">1258</span><br><span class="line">1259</span><br><span class="line">1260</span><br><span class="line">1261</span><br><span class="line">1262</span><br><span class="line">1263</span><br><span class="line">1264</span><br><span class="line">1265</span><br><span class="line">1266</span><br><span class="line">1267</span><br><span class="line">1268</span><br><span class="line">1269</span><br><span class="line">1270</span><br><span class="line">1271</span><br><span class="line">1272</span><br><span class="line">1273</span><br><span class="line">1274</span><br><span class="line">1275</span><br><span class="line">1276</span><br><span class="line">1277</span><br><span class="line">1278</span><br><span class="line">1279</span><br><span class="line">1280</span><br><span class="line">1281</span><br><span class="line">1282</span><br><span class="line">1283</span><br><span class="line">1284</span><br><span class="line">1285</span><br><span class="line">1286</span><br><span class="line">1287</span><br><span class="line">1288</span><br><span class="line">1289</span><br><span class="line">1290</span><br><span class="line">1291</span><br><span class="line">1292</span><br><span class="line">1293</span><br><span class="line">1294</span><br><span class="line">1295</span><br><span class="line">1296</span><br><span class="line">1297</span><br><span class="line">1298</span><br><span class="line">1299</span><br><span class="line">1300</span><br><span class="line">1301</span><br><span class="line">1302</span><br><span class="line">1303</span><br><span class="line">1304</span><br><span class="line">1305</span><br><span class="line">1306</span><br><span class="line">1307</span><br><span class="line">1308</span><br><span class="line">1309</span><br><span class="line">1310</span><br><span class="line">1311</span><br><span class="line">1312</span><br><span class="line">1313</span><br><span class="line">1314</span><br><span class="line">1315</span><br><span class="line">1316</span><br><span class="line">1317</span><br><span class="line">1318</span><br><span class="line">1319</span><br><span class="line">1320</span><br><span class="line">1321</span><br><span class="line">1322</span><br><span class="line">1323</span><br><span class="line">1324</span><br><span class="line">1325</span><br><span class="line">1326</span><br><span class="line">1327</span><br><span class="line">1328</span><br><span class="line">1329</span><br><span class="line">1330</span><br><span class="line">1331</span><br><span class="line">1332</span><br><span class="line">1333</span><br><span class="line">1334</span><br><span class="line">1335</span><br><span class="line">1336</span><br><span class="line">1337</span><br><span class="line">1338</span><br><span class="line">1339</span><br><span class="line">1340</span><br><span class="line">1341</span><br><span class="line">1342</span><br><span class="line">1343</span><br><span class="line">1344</span><br><span class="line">1345</span><br><span class="line">1346</span><br><span class="line">1347</span><br><span class="line">1348</span><br><span class="line">1349</span><br><span class="line">1350</span><br><span class="line">1351</span><br><span class="line">1352</span><br><span class="line">1353</span><br><span class="line">1354</span><br><span class="line">1355</span><br><span class="line">1356</span><br><span class="line">1357</span><br><span class="line">1358</span><br><span class="line">1359</span><br><span class="line">1360</span><br><span class="line">1361</span><br><span class="line">1362</span><br><span class="line">1363</span><br><span class="line">1364</span><br><span class="line">1365</span><br><span class="line">1366</span><br><span class="line">1367</span><br><span class="line">1368</span><br><span class="line">1369</span><br><span class="line">1370</span><br><span class="line">1371</span><br><span class="line">1372</span><br><span class="line">1373</span><br><span class="line">1374</span><br><span class="line">1375</span><br><span class="line">1376</span><br><span class="line">1377</span><br><span class="line">1378</span><br><span class="line">1379</span><br><span class="line">1380</span><br><span class="line">1381</span><br><span class="line">1382</span><br><span class="line">1383</span><br><span class="line">1384</span><br><span class="line">1385</span><br><span class="line">1386</span><br><span class="line">1387</span><br><span class="line">1388</span><br><span class="line">1389</span><br><span class="line">1390</span><br><span class="line">1391</span><br><span class="line">1392</span><br><span class="line">1393</span><br><span class="line">1394</span><br><span class="line">1395</span><br><span class="line">1396</span><br><span class="line">1397</span><br><span class="line">1398</span><br><span class="line">1399</span><br><span class="line">1400</span><br><span class="line">1401</span><br><span class="line">1402</span><br><span class="line">1403</span><br><span class="line">1404</span><br><span class="line">1405</span><br><span class="line">1406</span><br><span class="line">1407</span><br><span class="line">1408</span><br><span class="line">1409</span><br><span class="line">1410</span><br><span class="line">1411</span><br><span class="line">1412</span><br><span class="line">1413</span><br><span class="line">1414</span><br><span class="line">1415</span><br><span class="line">1416</span><br><span class="line">1417</span><br><span class="line">1418</span><br><span class="line">1419</span><br><span class="line">1420</span><br><span class="line">1421</span><br><span class="line">1422</span><br><span class="line">1423</span><br><span class="line">1424</span><br><span class="line">1425</span><br><span class="line">1426</span><br><span class="line">1427</span><br><span class="line">1428</span><br><span class="line">1429</span><br><span class="line">1430</span><br><span class="line">1431</span><br><span class="line">1432</span><br><span class="line">1433</span><br><span class="line">1434</span><br><span class="line">1435</span><br><span class="line">1436</span><br><span class="line">1437</span><br><span class="line">1438</span><br><span class="line">1439</span><br><span class="line">1440</span><br><span class="line">1441</span><br><span class="line">1442</span><br><span class="line">1443</span><br><span class="line">1444</span><br><span class="line">1445</span><br><span class="line">1446</span><br><span class="line">1447</span><br><span class="line">1448</span><br><span class="line">1449</span><br><span class="line">1450</span><br><span class="line">1451</span><br><span class="line">1452</span><br><span class="line">1453</span><br><span class="line">1454</span><br><span class="line">1455</span><br><span class="line">1456</span><br><span class="line">1457</span><br><span class="line">1458</span><br><span class="line">1459</span><br><span class="line">1460</span><br><span class="line">1461</span><br><span class="line">1462</span><br><span class="line">1463</span><br><span class="line">1464</span><br><span class="line">1465</span><br><span class="line">1466</span><br><span class="line">1467</span><br><span class="line">1468</span><br><span class="line">1469</span><br><span class="line">1470</span><br><span class="line">1471</span><br><span class="line">1472</span><br><span class="line">1473</span><br><span class="line">1474</span><br><span class="line">1475</span><br><span class="line">1476</span><br><span class="line">1477</span><br><span class="line">1478</span><br><span class="line">1479</span><br><span class="line">1480</span><br><span class="line">1481</span><br><span class="line">1482</span><br><span class="line">1483</span><br><span class="line">1484</span><br><span class="line">1485</span><br><span class="line">1486</span><br><span class="line">1487</span><br><span class="line">1488</span><br><span class="line">1489</span><br><span class="line">1490</span><br><span class="line">1491</span><br><span class="line">1492</span><br><span class="line">1493</span><br><span class="line">1494</span><br><span class="line">1495</span><br><span class="line">1496</span><br><span class="line">1497</span><br><span class="line">1498</span><br><span class="line">1499</span><br><span class="line">1500</span><br><span class="line">1501</span><br><span class="line">1502</span><br><span class="line">1503</span><br><span class="line">1504</span><br><span class="line">1505</span><br><span class="line">1506</span><br><span class="line">1507</span><br><span class="line">1508</span><br><span class="line">1509</span><br><span class="line">1510</span><br><span class="line">1511</span><br><span class="line">1512</span><br><span class="line">1513</span><br><span class="line">1514</span><br><span class="line">1515</span><br><span class="line">1516</span><br><span class="line">1517</span><br><span class="line">1518</span><br><span class="line">1519</span><br><span class="line">1520</span><br><span class="line">1521</span><br><span class="line">1522</span><br><span class="line">1523</span><br><span class="line">1524</span><br><span class="line">1525</span><br><span class="line">1526</span><br><span class="line">1527</span><br><span class="line">1528</span><br><span class="line">1529</span><br><span class="line">1530</span><br><span class="line">1531</span><br><span class="line">1532</span><br><span class="line">1533</span><br><span class="line">1534</span><br><span class="line">1535</span><br><span class="line">1536</span><br><span class="line">1537</span><br><span class="line">1538</span><br><span class="line">1539</span><br><span class="line">1540</span><br><span class="line">1541</span><br><span class="line">1542</span><br><span class="line">1543</span><br><span class="line">1544</span><br><span class="line">1545</span><br><span class="line">1546</span><br><span class="line">1547</span><br><span class="line">1548</span><br><span class="line">1549</span><br><span class="line">1550</span><br><span class="line">1551</span><br><span class="line">1552</span><br><span class="line">1553</span><br><span class="line">1554</span><br><span class="line">1555</span><br><span class="line">1556</span><br><span class="line">1557</span><br><span class="line">1558</span><br><span class="line">1559</span><br><span class="line">1560</span><br><span class="line">1561</span><br><span class="line">1562</span><br><span class="line">1563</span><br><span class="line">1564</span><br><span class="line">1565</span><br><span class="line">1566</span><br><span class="line">1567</span><br><span class="line">1568</span><br><span class="line">1569</span><br><span class="line">1570</span><br><span class="line">1571</span><br><span class="line">1572</span><br><span class="line">1573</span><br><span class="line">1574</span><br><span class="line">1575</span><br><span class="line">1576</span><br><span class="line">1577</span><br><span class="line">1578</span><br><span class="line">1579</span><br><span class="line">1580</span><br><span class="line">1581</span><br><span class="line">1582</span><br><span class="line">1583</span><br><span class="line">1584</span><br><span class="line">1585</span><br><span class="line">1586</span><br><span class="line">1587</span><br><span class="line">1588</span><br><span class="line">1589</span><br><span class="line">1590</span><br><span class="line">1591</span><br><span class="line">1592</span><br><span class="line">1593</span><br><span class="line">1594</span><br><span class="line">1595</span><br><span class="line">1596</span><br><span class="line">1597</span><br><span class="line">1598</span><br><span class="line">1599</span><br><span class="line">1600</span><br><span class="line">1601</span><br><span class="line">1602</span><br><span class="line">1603</span><br><span class="line">1604</span><br><span class="line">1605</span><br><span class="line">1606</span><br><span class="line">1607</span><br><span class="line">1608</span><br><span class="line">1609</span><br><span class="line">1610</span><br><span class="line">1611</span><br><span class="line">1612</span><br><span class="line">1613</span><br><span class="line">1614</span><br><span class="line">1615</span><br><span class="line">1616</span><br><span class="line">1617</span><br><span class="line">1618</span><br><span class="line">1619</span><br><span class="line">1620</span><br><span class="line">1621</span><br><span class="line">1622</span><br><span class="line">1623</span><br><span class="line">1624</span><br><span class="line">1625</span><br><span class="line">1626</span><br><span class="line">1627</span><br><span class="line">1628</span><br><span class="line">1629</span><br><span class="line">1630</span><br><span class="line">1631</span><br><span class="line">1632</span><br><span class="line">1633</span><br><span class="line">1634</span><br><span class="line">1635</span><br><span class="line">1636</span><br><span class="line">1637</span><br><span class="line">1638</span><br><span class="line">1639</span><br><span class="line">1640</span><br><span class="line">1641</span><br><span class="line">1642</span><br><span class="line">1643</span><br><span class="line">1644</span><br><span class="line">1645</span><br><span class="line">1646</span><br><span class="line">1647</span><br><span class="line">1648</span><br><span class="line">1649</span><br><span class="line">1650</span><br><span class="line">1651</span><br><span class="line">1652</span><br><span class="line">1653</span><br><span class="line">1654</span><br><span class="line">1655</span><br><span class="line">1656</span><br><span class="line">1657</span><br><span class="line">1658</span><br><span class="line">1659</span><br><span class="line">1660</span><br><span class="line">1661</span><br><span class="line">1662</span><br><span class="line">1663</span><br><span class="line">1664</span><br><span class="line">1665</span><br><span class="line">1666</span><br><span class="line">1667</span><br><span class="line">1668</span><br><span class="line">1669</span><br><span class="line">1670</span><br><span class="line">1671</span><br><span class="line">1672</span><br><span class="line">1673</span><br><span class="line">1674</span><br><span class="line">1675</span><br><span class="line">1676</span><br><span class="line">1677</span><br><span class="line">1678</span><br><span class="line">1679</span><br><span class="line">1680</span><br><span class="line">1681</span><br><span class="line">1682</span><br><span class="line">1683</span><br><span class="line">1684</span><br><span class="line">1685</span><br><span class="line">1686</span><br><span class="line">1687</span><br><span class="line">1688</span><br><span class="line">1689</span><br><span class="line">1690</span><br><span class="line">1691</span><br><span class="line">1692</span><br><span class="line">1693</span><br><span class="line">1694</span><br><span class="line">1695</span><br><span class="line">1696</span><br><span class="line">1697</span><br><span class="line">1698</span><br><span class="line">1699</span><br><span class="line">1700</span><br><span class="line">1701</span><br><span class="line">1702</span><br><span class="line">1703</span><br><span class="line">1704</span><br><span class="line">1705</span><br><span class="line">1706</span><br><span class="line">1707</span><br><span class="line">1708</span><br><span class="line">1709</span><br><span class="line">1710</span><br><span class="line">1711</span><br><span class="line">1712</span><br><span class="line">1713</span><br><span class="line">1714</span><br><span class="line">1715</span><br><span class="line">1716</span><br><span class="line">1717</span><br><span class="line">1718</span><br><span class="line">1719</span><br><span class="line">1720</span><br><span class="line">1721</span><br><span class="line">1722</span><br><span class="line">1723</span><br><span class="line">1724</span><br><span class="line">1725</span><br><span class="line">1726</span><br><span class="line">1727</span><br><span class="line">1728</span><br><span class="line">1729</span><br><span class="line">1730</span><br><span class="line">1731</span><br><span class="line">1732</span><br><span class="line">1733</span><br><span class="line">1734</span><br><span class="line">1735</span><br><span class="line">1736</span><br><span class="line">1737</span><br><span class="line">1738</span><br><span class="line">1739</span><br><span class="line">1740</span><br><span class="line">1741</span><br><span class="line">1742</span><br><span class="line">1743</span><br><span class="line">1744</span><br><span class="line">1745</span><br><span class="line">1746</span><br><span class="line">1747</span><br><span class="line">1748</span><br><span class="line">1749</span><br><span class="line">1750</span><br><span class="line">1751</span><br><span class="line">1752</span><br><span class="line">1753</span><br><span class="line">1754</span><br><span class="line">1755</span><br><span class="line">1756</span><br><span class="line">1757</span><br><span class="line">1758</span><br><span class="line">1759</span><br><span class="line">1760</span><br><span class="line">1761</span><br><span class="line">1762</span><br><span class="line">1763</span><br><span class="line">1764</span><br><span class="line">1765</span><br><span class="line">1766</span><br><span class="line">1767</span><br><span class="line">1768</span><br><span class="line">1769</span><br><span class="line">1770</span><br><span class="line">1771</span><br><span class="line">1772</span><br><span class="line">1773</span><br><span class="line">1774</span><br><span class="line">1775</span><br><span class="line">1776</span><br><span class="line">1777</span><br><span class="line">1778</span><br><span class="line">1779</span><br><span class="line">1780</span><br><span class="line">1781</span><br><span class="line">1782</span><br><span class="line">1783</span><br><span class="line">1784</span><br><span class="line">1785</span><br><span class="line">1786</span><br><span class="line">1787</span><br><span class="line">1788</span><br><span class="line">1789</span><br><span class="line">1790</span><br><span class="line">1791</span><br><span class="line">1792</span><br><span class="line">1793</span><br><span class="line">1794</span><br><span class="line">1795</span><br><span class="line">1796</span><br><span class="line">1797</span><br><span class="line">1798</span><br><span class="line">1799</span><br><span class="line">1800</span><br><span class="line">1801</span><br><span class="line">1802</span><br><span class="line">1803</span><br><span class="line">1804</span><br><span class="line">1805</span><br><span class="line">1806</span><br><span class="line">1807</span><br><span class="line">1808</span><br><span class="line">1809</span><br><span class="line">1810</span><br><span class="line">1811</span><br><span class="line">1812</span><br><span class="line">1813</span><br><span class="line">1814</span><br><span class="line">1815</span><br><span class="line">1816</span><br><span class="line">1817</span><br><span class="line">1818</span><br><span class="line">1819</span><br><span class="line">1820</span><br><span class="line">1821</span><br><span class="line">1822</span><br><span class="line">1823</span><br><span class="line">1824</span><br><span class="line">1825</span><br><span class="line">1826</span><br><span class="line">1827</span><br><span class="line">1828</span><br><span class="line">1829</span><br><span class="line">1830</span><br><span class="line">1831</span><br><span class="line">1832</span><br><span class="line">1833</span><br><span class="line">1834</span><br><span class="line">1835</span><br><span class="line">1836</span><br><span class="line">1837</span><br><span class="line">1838</span><br><span class="line">1839</span><br><span class="line">1840</span><br><span class="line">1841</span><br><span class="line">1842</span><br><span class="line">1843</span><br><span class="line">1844</span><br><span class="line">1845</span><br><span class="line">1846</span><br><span class="line">1847</span><br><span class="line">1848</span><br><span class="line">1849</span><br><span class="line">1850</span><br><span class="line">1851</span><br><span class="line">1852</span><br><span class="line">1853</span><br><span class="line">1854</span><br><span class="line">1855</span><br><span class="line">1856</span><br><span class="line">1857</span><br><span class="line">1858</span><br><span class="line">1859</span><br><span class="line">1860</span><br><span class="line">1861</span><br><span class="line">1862</span><br><span class="line">1863</span><br><span class="line">1864</span><br><span class="line">1865</span><br><span class="line">1866</span><br><span class="line">1867</span><br><span class="line">1868</span><br><span class="line">1869</span><br><span class="line">1870</span><br><span class="line">1871</span><br><span class="line">1872</span><br><span class="line">1873</span><br><span class="line">1874</span><br><span class="line">1875</span><br><span class="line">1876</span><br><span class="line">1877</span><br><span class="line">1878</span><br><span class="line">1879</span><br><span class="line">1880</span><br><span class="line">1881</span><br><span class="line">1882</span><br><span class="line">1883</span><br><span class="line">1884</span><br><span class="line">1885</span><br><span class="line">1886</span><br><span class="line">1887</span><br><span class="line">1888</span><br><span class="line">1889</span><br><span class="line">1890</span><br><span class="line">1891</span><br><span class="line">1892</span><br><span class="line">1893</span><br><span class="line">1894</span><br><span class="line">1895</span><br><span class="line">1896</span><br><span class="line">1897</span><br><span class="line">1898</span><br><span class="line">1899</span><br><span class="line">1900</span><br><span class="line">1901</span><br><span class="line">1902</span><br><span class="line">1903</span><br><span class="line">1904</span><br><span class="line">1905</span><br><span class="line">1906</span><br><span class="line">1907</span><br><span class="line">1908</span><br><span class="line">1909</span><br><span class="line">1910</span><br><span class="line">1911</span><br><span class="line">1912</span><br><span class="line">1913</span><br><span class="line">1914</span><br><span class="line">1915</span><br><span class="line">1916</span><br><span class="line">1917</span><br><span class="line">1918</span><br><span class="line">1919</span><br><span class="line">1920</span><br><span class="line">1921</span><br><span class="line">1922</span><br><span class="line">1923</span><br><span class="line">1924</span><br><span class="line">1925</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">/************************/</span></span><br><span class="line"><span class="comment">/*******添加全屏按钮********/</span></span><br><span class="line"><span class="comment">/*****并且添加全屏功能*******/</span>                       </span><br><span class="line"> <span class="comment">/************************/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//使用JQuery实现按钮添加</span></span><br><span class="line"><span class="keyword">var</span> bar_path_Su,bar_path_S,bar_path_Y,bar_path_an,bar_path_Yu,bar_path_logobar_path_i_upper,bar_path_i_lower,tooltip_stop,tooltip_background;</span><br><span class="line">$(<span class="keyword">function</span>(<span class="params"></span>)&#123; </span><br><span class="line">        </span><br><span class="line">        <span class="comment">//webgl加载失败时显示提示 代码复制自webglreport.js </span></span><br><span class="line">        <span class="keyword">var</span> webglVersion = <span class="variable language_">window</span>.<span class="property">location</span>.<span class="property">search</span>.<span class="title function_">indexOf</span>(<span class="string">&#x27;v=2&#x27;</span>) &gt; <span class="number">0</span> ? <span class="number">2</span> : <span class="number">1</span>;</span><br><span class="line">        <span class="keyword">var</span> report = &#123;</span><br><span class="line">            <span class="attr">platform</span>: navigator.<span class="property">platform</span>,</span><br><span class="line">            <span class="attr">userAgent</span>: navigator.<span class="property">userAgent</span>,</span><br><span class="line">            <span class="attr">webglVersion</span>: webglVersion</span><br><span class="line">        &#125;;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (webglVersion === <span class="number">2</span>) &#123;</span><br><span class="line">            $(<span class="string">&#x27;body&#x27;</span>).<span class="title function_">addClass</span>(<span class="string">&#x27;webgl2&#x27;</span>);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> ((webglVersion === <span class="number">2</span> &amp;&amp; !<span class="variable language_">window</span>.<span class="property">WebGL2RenderingContext</span>) ||</span><br><span class="line">            (webglVersion === <span class="number">1</span> &amp;&amp; !<span class="variable language_">window</span>.<span class="property">WebGLRenderingContext</span>)) &#123;</span><br><span class="line">            <span class="comment">// The browser does not support WebGL</span></span><br><span class="line">            <span class="comment">//显示浏览器不支持webgl的信息</span></span><br><span class="line">            <span class="title function_">webgl_fail</span>();</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> canvas = $(<span class="string">&#x27;&lt;canvas /&gt;&#x27;</span>, &#123; <span class="attr">width</span>: <span class="string">&#x27;1&#x27;</span>, <span class="attr">height</span>: <span class="string">&#x27;1&#x27;</span> &#125;).<span class="title function_">appendTo</span>(<span class="string">&#x27;body&#x27;</span>);</span><br><span class="line">        <span class="keyword">var</span> gl;</span><br><span class="line">        <span class="keyword">var</span> possibleNames = (webglVersion === <span class="number">2</span>) ? [<span class="string">&#x27;webgl2&#x27;</span>, <span class="string">&#x27;experimental-webgl2&#x27;</span>] : [<span class="string">&#x27;webgl&#x27;</span>, <span class="string">&#x27;experimental-webgl&#x27;</span>];</span><br><span class="line">        <span class="keyword">var</span> contextName = _.<span class="title function_">find</span>(possibleNames, <span class="keyword">function</span> (<span class="params">name</span>) &#123;</span><br><span class="line">            gl = canvas[<span class="number">0</span>].<span class="title function_">getContext</span>(name, &#123; <span class="attr">stencil</span>: <span class="literal">true</span> &#125;);</span><br><span class="line">            <span class="keyword">return</span> !!gl;</span><br><span class="line">        &#125;);</span><br><span class="line">        canvas.<span class="title function_">remove</span>();</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> (!gl) &#123;</span><br><span class="line">            <span class="comment">// The browser supports WebGL, but initialization failed</span></span><br><span class="line">            <span class="comment">//显示浏览器需要开启webgl的信息</span></span><br><span class="line">            <span class="title function_">webgl_update</span>();</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//添加按钮的CSS样式</span></span><br><span class="line">    <span class="keyword">var</span> main_css = $(<span class="string">&quot;&lt;style&gt;&lt;/style&gt;&quot;</span>).<span class="title function_">text</span>(<span class="string">&quot;#container&#123;position:absolute;width:100%;height:5%;margin-top:40% ;right:25%;&#125;#logo&#123;position:absolute;width:40%;left:40%;top:30%;&#125; #main&#123;position: fixed;bottom: 20px;right: 20px;padding: 1px 15px;color: #fff;background-color: #89a;opacity: 0.7;border-radius: 50%;font-size: 50px;transition: transform 0.2s linear;&#125;  #main:hover &#123;cursor: pointer;opacity: 1;transform: rotate(180deg);&#125;#help_btn &#123;position: fixed;bottom: 100px;right: 30px;padding: 5px 5px;color: #fff;background-color: #89a;opacity: 0.7;border-radius: 50%;font-size: 50px;cursor:pointer;&#125;#full_btn &#123;position: fixed;bottom: 150px;right: 30px;padding: 5px 5px;color: #fff;background-color: #89a;opacity: 0.7;border-radius: 50%;font-size: 50px;cursor:pointer;&#125;#share_btn &#123;position: fixed;bottom: 200px;right: 30px;padding: 5px 5px;color: #fff;background-color: #89a;opacity: 0.7;border-radius: 50%;font-size: 50px;cursor:pointer;&#125;#stop_btn &#123;position: fixed;bottom: 250px;right: 30px;padding: 5px 5px;color: #fff;background-color: #89a;opacity: 0.7;border-radius: 50%;font-size: 50px;cursor:pointer;&#125;#origin_btn &#123;position: fixed;bottom: 300px;right: 30px;padding: 5px 5px;color: #fff;background-color: #89a;opacity: 0.7;border-radius: 50%;font-size: 50px;cursor:pointer;&#125;     #color_dark_btn &#123;position: fixed;bottom: 200px;right: 80px;padding: 5px 5px;color: #fff;background-color: #89a;opacity: 0.7;border-radius: 50%;font-size: 50px;cursor:pointer;&#125;    #color_white_btn &#123;position: fixed;bottom: 200px;right: 80px;padding: 5px 5px;color: #fff;background-color: #89a;opacity: 0.7;border-radius: 50%;font-size: 50px;cursor:pointer;&#125; #color_white_btn_small &#123;position: fixed;bottom: 20px;right: 20px;padding: 5px 5px;color: #fff;background-color: #89a;opacity: 0.7;border-radius: 50%;font-size: 50px;cursor:pointer;&#125; #color_dark_btn_small &#123;position: fixed;bottom: 20px;right: 45px;padding: 5px 5px;color: #fff;background-color: #89a;opacity: 0.7;border-radius: 50%;font-size: 50px;cursor:pointer;&#125; #panel &#123;padding: 0; margin: 0; width: 200px;height: 500px;background: #a0a0f0;position: absolute;right:3px;top:20%;border:2px solid #bbb&#125;    #blocker &#123;position: absolute; top:0px;width: 100%;height: 100%;background-color: rgba(0,0,0,0.5);&#125;    #instructions &#123;width: 100%;height: 100%;display: -webkit-box;display: -moz-box;display: box;-webkit-box-orient: horizontal;-moz-box-orient: horizontal;box-orient: horizontal;-webkit-box-pack: center;-moz-box-pack: center;box-pack: center;-webkit-box-align: center;-moz-box-align: center;box-align: center;color: #ffffff;text-align: center;cursor: pointer;&#125;&quot;</span>);</span><br><span class="line">    </span><br><span class="line">    $(<span class="string">&quot;body&quot;</span>).<span class="title function_">append</span>(main_css);</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">    <span class="comment">//添加按钮</span></span><br><span class="line">    $(<span class="string">&quot;#webgl&quot;</span>).<span class="title function_">after</span>(<span class="string">&quot;&lt;button id=&#x27;main&#x27; onclick=&#x27;icon_display()&#x27; onDblClick=&#x27;express()&#x27;&gt;+&lt;/button&gt;&quot;</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="title function_">tooltip_anim</span>(<span class="string">&quot;main&quot;</span>,<span class="string">&quot;主菜单&quot;</span>);</span><br><span class="line">    </span><br><span class="line">    $(<span class="string">&quot;#webgl&quot;</span>).<span class="title function_">after</span>(<span class="string">&quot;&lt;img id=&#x27;help_btn&#x27; src=&#x27;http://webgl.suiyuankj.com/images/ico/information.ico&#x27; width=&#x27;32px&#x27; height=&#x27;32px&#x27; onclick=&#x27;help_display()&#x27;&gt;&quot;</span>) </span><br><span class="line">    </span><br><span class="line">    <span class="title function_">tooltip_anim</span>(<span class="string">&quot;help_btn&quot;</span>,<span class="string">&quot;帮助&quot;</span>);<span class="comment">//添加按钮tooltip</span></span><br><span class="line">    </span><br><span class="line">    $(<span class="string">&quot;#help_btn&quot;</span>).<span class="title function_">hide</span>();<span class="comment">//隐藏按钮</span></span><br><span class="line">    </span><br><span class="line">    $(<span class="string">&quot;#webgl&quot;</span>).<span class="title function_">after</span>(<span class="string">&quot;&lt;img id=&#x27;full_btn&#x27; src=&#x27;http://webgl.suiyuankj.com/images/ico/statusNotDone.ico&#x27; width=&#x27;32px&#x27; height=&#x27;32px&#x27; onclick=&#x27;full_screen_fun()&#x27;&gt;&quot;</span>) </span><br><span class="line">    </span><br><span class="line">    <span class="title function_">tooltip_anim</span>(<span class="string">&quot;full_btn&quot;</span>,<span class="string">&quot;全屏&quot;</span>);<span class="comment">//添加按钮tooltip</span></span><br><span class="line">    </span><br><span class="line">    $(<span class="string">&quot;#full_btn&quot;</span>).<span class="title function_">hide</span>();<span class="comment">//隐藏按钮</span></span><br><span class="line">    </span><br><span class="line">    $(<span class="string">&quot;#webgl&quot;</span>).<span class="title function_">after</span>(<span class="string">&quot;&lt;img id=&#x27;share_btn&#x27; src=&#x27;http://webgl.suiyuankj.com/images/ico/flag.ico&#x27; width=&#x27;32px&#x27; height=&#x27;32px&#x27; onclick=&#x27;share_display()&#x27;&gt;&quot;</span>) </span><br><span class="line">    </span><br><span class="line">    tooltip_background = <span class="title function_">tooltip_anim</span>(<span class="string">&quot;share_btn&quot;</span>,<span class="string">&quot;背景颜色&quot;</span>);<span class="comment">//这里用这个无法删除改变按钮</span></span><br><span class="line">    </span><br><span class="line">    $(<span class="string">&quot;#share_btn&quot;</span>).<span class="title function_">hide</span>();<span class="comment">//隐藏按钮</span></span><br><span class="line">    </span><br><span class="line">    $(<span class="string">&quot;#webgl&quot;</span>).<span class="title function_">after</span>(<span class="string">&quot;&lt;img id=&#x27;stop_btn&#x27; src=&#x27;http://webgl.suiyuankj.com/images/ico/jumplist_pausealltask.ico&#x27; width=&#x27;32px&#x27; height=&#x27;32px&#x27; onclick=&#x27;rotate_stop()&#x27;&gt;&quot;</span>) </span><br><span class="line">    </span><br><span class="line">    tooltip_stop = <span class="title function_">tooltip_anim</span>(<span class="string">&quot;stop_btn&quot;</span>,<span class="string">&quot;暂停旋转&quot;</span>);<span class="comment">//添加按钮tooltip</span></span><br><span class="line">    </span><br><span class="line">    $(<span class="string">&quot;#stop_btn&quot;</span>).<span class="title function_">hide</span>();<span class="comment">//隐藏按钮</span></span><br><span class="line">    </span><br><span class="line">    $(<span class="string">&quot;#webgl&quot;</span>).<span class="title function_">after</span>(<span class="string">&quot;&lt;img id=&#x27;origin_btn&#x27; src=&#x27;http://webgl.suiyuankj.com/images/ico/sync.ico&#x27; width=&#x27;32px&#x27; height=&#x27;32px&#x27;onclick=&#x27;origin_position()&#x27;&gt;&quot;</span>) </span><br><span class="line">    </span><br><span class="line">    <span class="title function_">tooltip_anim</span>(<span class="string">&quot;origin_btn&quot;</span>,<span class="string">&quot;初始位置&quot;</span>);<span class="comment">//添加按钮tooltip</span></span><br><span class="line">    </span><br><span class="line">    $(<span class="string">&quot;#origin_btn&quot;</span>).<span class="title function_">hide</span>();<span class="comment">//隐藏按钮</span></span><br><span class="line">    </span><br><span class="line">    $(<span class="string">&quot;#webgl&quot;</span>).<span class="title function_">after</span>(<span class="string">&quot;&lt;img id=&#x27;color_white_btn&#x27; src=&#x27;http://webgl.suiyuankj.com/images/ico/white.jpg&#x27; width=&#x27;32px&#x27; height=&#x27;32px&#x27;onclick=&#x27;white_BG()&#x27;&gt;&quot;</span>) </span><br><span class="line">    </span><br><span class="line">    <span class="title function_">tooltip_anim</span>(<span class="string">&quot;color_white_btn&quot;</span>,<span class="string">&quot;白背景&quot;</span>,<span class="string">&#x27;top&#x27;</span>);<span class="comment">//添加按钮tooltip</span></span><br><span class="line">    </span><br><span class="line">    $(<span class="string">&quot;#color_white_btn&quot;</span>).<span class="title function_">hide</span>();<span class="comment">//隐藏按钮</span></span><br><span class="line">    </span><br><span class="line">    $(<span class="string">&quot;#webgl&quot;</span>).<span class="title function_">after</span>(<span class="string">&quot;&lt;img id=&#x27;color_dark_btn&#x27; src=&#x27;http://webgl.suiyuankj.com/images/ico/dark.jpg&#x27; width=&#x27;32px&#x27; height=&#x27;32px&#x27;onclick=&#x27;dark_BG()&#x27;&gt;&quot;</span>) </span><br><span class="line">    </span><br><span class="line">    <span class="title function_">tooltip_anim</span>(<span class="string">&quot;color_dark_btn&quot;</span>,<span class="string">&quot;黑背景&quot;</span>,<span class="string">&#x27;top&#x27;</span>);<span class="comment">//添加按钮tooltip</span></span><br><span class="line">    </span><br><span class="line">    $(<span class="string">&quot;#color_dark_btn&quot;</span>).<span class="title function_">hide</span>();<span class="comment">//隐藏按钮</span></span><br><span class="line">    </span><br><span class="line">    $(<span class="string">&quot;#webgl&quot;</span>).<span class="title function_">after</span>(<span class="string">&quot;&lt;img id=&#x27;color_white_btn_small&#x27; src=&#x27;http://webgl.suiyuankj.com/images/ico/white.jpg&#x27; width=&#x27;10px&#x27; height=&#x27;10px&#x27;onclick=&#x27;white_BG()&#x27; &gt;&quot;</span>) </span><br><span class="line">    </span><br><span class="line">    <span class="title function_">tooltip_anim</span>(<span class="string">&quot;color_white_btn_small&quot;</span>,<span class="string">&quot;白背景&quot;</span>,<span class="string">&#x27;top&#x27;</span>);<span class="comment">//添加按钮tooltip</span></span><br><span class="line">    </span><br><span class="line">    $(<span class="string">&quot;#color_white_btn_small&quot;</span>).<span class="title function_">hide</span>();<span class="comment">//隐藏按钮</span></span><br><span class="line">    </span><br><span class="line">    $(<span class="string">&quot;#webgl&quot;</span>).<span class="title function_">after</span>(<span class="string">&quot;&lt;img id=&#x27;color_dark_btn_small&#x27; src=&#x27;http://webgl.suiyuankj.com/images/ico/dark.jpg&#x27; width=&#x27;10px&#x27; height=&#x27;10px&#x27;onclick=&#x27;dark_BG()&#x27; &gt;&quot;</span>)   </span><br><span class="line">    </span><br><span class="line">    <span class="title function_">tooltip_anim</span>(<span class="string">&quot;color_dark_btn_small&quot;</span>,<span class="string">&quot;黑背景&quot;</span>,<span class="string">&#x27;top&#x27;</span>);<span class="comment">//添加按钮tooltip</span></span><br><span class="line">    </span><br><span class="line">    $(<span class="string">&quot;#color_dark_btn_small&quot;</span>).<span class="title function_">hide</span>();<span class="comment">//隐藏按钮</span></span><br><span class="line">    </span><br><span class="line">    $(<span class="string">&quot;#webgl&quot;</span>).<span class="title function_">append</span>(<span class="string">&quot;&lt;div id=&#x27;panel&#x27;&gt;&lt;/div&gt;&quot;</span>);<span class="comment">//控制面板</span></span><br><span class="line">    $(<span class="string">&quot;#panel&quot;</span>).<span class="title function_">hide</span>();<span class="comment">//隐藏面板</span></span><br><span class="line">    </span><br><span class="line">     $(<span class="string">&quot;#panel&quot;</span>).<span class="title function_">append</span>(<span class="string">&quot;&lt;div id=&#x27;transform&#x27; style=&#x27;position:absolute;top:5px;left:20px;&#x27;&gt;&lt;center&gt;&lt;p&gt;&lt;b&gt;属性面板&lt;/b&gt;&lt;/p&gt;&lt;/center&gt;&lt;div id=&#x27;panel_translate&#x27;style=&#x27;position:relative;margin:5px;&#x27;&gt;平移 &lt;input value=&#x27;0.0&#x27; class=&#x27;translateX&#x27; style=&#x27;border:2px solid transparent;background-color: transparent; cursor: col-resize; width: 25px;margin:0px 5px;&#x27;&gt;&lt;input value=&#x27;0.0&#x27; class=&#x27;translateY&#x27; style=&#x27;background-color: transparent; cursor: col-resize; width: 25px;margin:0px 5px;&#x27;&gt;&lt;input value=&#x27;0.0&#x27; class=&#x27;translateZ&#x27; style=&#x27;background-color: transparent; cursor: col-resize; width: 25px;margin:0px 5px;&#x27;&gt;&lt;/div&gt;&lt;div id=&#x27;panel_rotate&#x27;style=&#x27;position:relative;margin:5px;&#x27;&gt;旋转 &lt;input class=&#x27;Number&#x27; style=&#x27;background-color: transparent; cursor: col-resize; width: 25px;margin:0px 5px;&#x27;&gt;&lt;input class=&#x27;Number&#x27; style=&#x27;background-color: transparent; cursor: col-resize; width: 25px;margin:0px 5px;&#x27;&gt;&lt;input class=&#x27;Number&#x27; style=&#x27;background-color: transparent; cursor: col-resize; width: 25px;margin:0px 5px;&#x27;&gt;&lt;/div&gt;&lt;div id=&#x27;panel_scale&#x27;style=&#x27;position:relative;margin:5px;&#x27;&gt;缩放 &lt;input class=&#x27;Number&#x27; style=&#x27;background-color: transparent; cursor: col-resize; width: 25px;margin:0px 5px;&#x27;&gt;&lt;input class=&#x27;Number&#x27; style=&#x27;background-color: transparent; cursor: col-resize; width: 25px;margin:0px 5px;&#x27;&gt;&lt;input class=&#x27;Number&#x27; style=&#x27;background-color: transparent; cursor: col-resize; width: 25px;margin:0px 5px;&#x27;&gt;&lt;/div&gt;&lt;/div&gt;&quot;</span>);<span class="comment">//控制面板</span></span><br><span class="line"></span><br><span class="line">    <span class="title function_">ico_size</span>();<span class="comment">//默认使用小图标（大图标在手机端竖屏时使用）</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">//如果当前窗口过小，隐藏主菜单按钮</span></span><br><span class="line">    <span class="keyword">if</span>(<span class="variable language_">window</span>.<span class="property">innerHeight</span>&lt;<span class="number">300</span> || <span class="variable language_">window</span>.<span class="property">innerWidth</span> &lt; <span class="number">300</span>)&#123;</span><br><span class="line">                <span class="title function_">rotate_stop</span>();</span><br><span class="line">                $(<span class="string">&quot;#main&quot;</span>).<span class="title function_">hide</span>();</span><br><span class="line">                $(<span class="string">&quot;#color_white_btn_small&quot;</span>).<span class="title function_">show</span>();</span><br><span class="line">                $(<span class="string">&quot;#color_dark_btn_small&quot;</span>).<span class="title function_">show</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    html5tooltips.<span class="title function_">refresh</span>();<span class="comment">//通过这个刷新tooltip 方可正常显示</span></span><br><span class="line">    <span class="comment">//加载SVG路径生成公司logo为动画做准备</span></span><br><span class="line">    $(<span class="string">&quot;#logo&quot;</span>).<span class="title function_">append</span>(<span class="string">&quot; &lt;svg xmlns=&#x27;http://www.w3.org/2000/svg&#x27; viewBox=&#x27;0 0 600 400&#x27; &gt;&lt;defs&gt;&lt;style&gt;.a&#123;fill:none;&#125;.b&#123;fill:#1d815e;&#125;.c&#123;fill:#3ea251;&#125;&lt;/style&gt;&lt;/defs&gt;            &lt;path fill-opacity=&#x27;0&#x27; stroke-width=&#x27;1&#x27; stroke=&#x27;#bbb&#x27;  d=&#x27;M533.5,390.2V339.7c0-2.9,1.2-4,4.1-4.1h23.5c1.8,0,2.8,1,2.8,2.6s0,1.9,0,2.8q0,12.5,0,25h0q0,12.8,0,25.7a1.7,1.7,0,0,0,.3.9,2.1,2.1,0,0,0,1.2-.4c2.3-2.2,4.4-4.5,6.8-6.7a4.8,4.8,0,0,0,1.6-3.9q-.1-16.6-.1-33.2c0-5.6,0-11.1-.1-16.7a5.9,5.9,0,0,0-1.1-3.3,6.8,6.8,0,0,0-5.8-2.5H531c-2.7,0-5.7,1.6-6.2,4.6-.1.7-.6.9-1.2.7l-1.1-.5-4.7-3.2c-2-1.3-4.3-1.6-6-.2s-2.4,5.2-.8,6.5,6.3,4.8,9.4,7.2,3,1.9,1.6,5.1-1.9,2.9-4,2.8h-24a7.3,7.3,0,0,0-7.3,7.3q0,15.2.2,30.5a5.1,5.1,0,0,0,3.6,5,11.3,11.3,0,0,0,3.2.4h26.9c.7,0,.9-.4.7-1a3.3,3.3,0,0,0-.6-.9l-6.3-7.3a1.9,1.9,0,0,0-1.6-.7H499.8a9.5,9.5,0,0,1-2.3-.3c-1.3-.4-1.7-1-1.7-2.4q-.1-8.9-.1-17.9c0-1.8.6-2.5,2.3-3h23.3c1.4,0,1.9.5,2,1.9s0,.8,0,1.3q0,13.8-.1,27.6a2.4,2.4,0,0,0,2.5,2.7H531A2.3,2.3,0,0,0,533.5,390.2Z&#x27; transform=&#x27;translate(-268.6 -160.1)&#x27;/&gt;        &lt;path fill-opacity=&#x27;0&#x27; stroke-width=&#x27;1&#x27; stroke=&#x27;#bbb&#x27;  d=&#x27;M363.2,326.6a2.7,2.7,0,0,1,2.5,2.8c0,1.6,0,3.3,0,4.9a2.3,2.3,0,0,1-2,2.3h-2.2l-79.9-.3c-2-.1-3.1.9-3.2,3-.1,4.7-.1,9.4,0,14.1a2.7,2.7,0,0,0,3,2.7h23.6a9,9,0,0,1,5.2,1.6,5.3,5.3,0,0,1,2.2,4.3c.2,2.5.2,5,.2,7.5,0,5.9,0,11.8,0,17.7A5.8,5.8,0,0,1,307,393H270.6l-1.2-.3a4.8,4.8,0,0,1,.6-1l4.2-4.3c1.4-1.5,2.9-2.9,4.4-4.3a2.8,2.8,0,0,1,1.7-.5h19.3c2.3,0,3.1-.7,3.1-3s-.1-7.3-.2-10.9c0-1.5-1-2.3-2.8-2.4H275.8a7.2,7.2,0,0,1-7.1-5.5,3.8,3.8,0,0,1-.1-1c0-8.4-.1-16.8,0-25.2.1-4.4,2.1-7.8,7.4-8.1C279,326.4,361.8,326.5,363.2,326.6Z&#x27; transform=&#x27;translate(-268.6 -160.1)&#x27;/&gt;        &lt;path fill-opacity=&#x27;0&#x27; stroke-width=&#x27;1&#x27; stroke=&#x27;#bbb&#x27;  d=&#x27;M387.2,326.2h11.5c1.8,3.4,4.3,8,6.2,11.3a40.2,40.2,0,0,0,2.6,3.8c.5.7.9.3,1.2-.2l5.2-9.1,3.3-5.9h75.7c.5,0,.5.9.1,1.3l-8.9,8.2a2.1,2.1,0,0,1-1.3.3H425.7a1.3,1.3,0,0,0-1.3.8c-2.5,4.6-4.9,9.3-7.6,13.7-.9,1.4-2.3,4.2-2.3,4.2s-.4,26.7-.5,35.3c0,1.4-.7,2.6-1.9,2.6H405c-1.8,0-2.7-.7-2.7-2.5,0-7.9-.1-16.2-.1-24,0-3.4.1-7.7,0-11l-.9-1.9c-4.5-8.9-8.9-16.8-13.5-25.6C387.6,327.4,387.4,326.7,387.2,326.2Z&#x27; transform=&#x27;translate(-268.6 -160.1)&#x27;/&gt;        &lt;path fill-opacity=&#x27;0&#x27; stroke-width=&#x27;1&#x27; stroke=&#x27;#bbb&#x27;  d=&#x27;M318.6,364.6q0-10.7,0-21.4a2.4,2.4,0,0,1,2.4-2.5h5.2a2.4,2.4,0,0,1,2.6,2.6q.1,17.9.2,35.9c0,2.3.8,3.2,3.2,3.2h21.8c.9,0,1.3-.3,1.3-1.3q0-12.1,0-24.1c0-4.6.1-9.2.2-13.7,0-1.3.5-2.5,2.3-2.5h5.4a2.7,2.7,0,0,1,2.6,3c0,1.2-.2,19.3-.2,27.1,0,5.3.1,10.6,0,15.9a6.9,6.9,0,0,1-1.6,4.9,3.6,3.6,0,0,1-2.8,1.2H333.7c-3.1,0-6.2.2-9.3,0s-5.8-1.8-5.8-5.6c0-7.6,0-15.2,0-22.7Z&#x27; transform=&#x27;translate(-268.6 -160.1)&#x27;/&gt;        &lt;path fill-opacity=&#x27;0&#x27; stroke-width=&#x27;1&#x27; stroke=&#x27;#bbb&#x27;  d=&#x27;M432.9,364.8q0-10.7,0-21.5c0-2.3.8-3.1,3.1-3.1h4.1a2.6,2.6,0,0,1,2.7,3c0,1,.1,2,.1,3q0,16.1,0,32.2c0,.4,0,.8,0,1.2a2.3,2.3,0,0,0,2.6,2.4h20.7c2,0,2.9-.8,3.2-2.8a22.7,22.7,0,0,0,.1-2.4c0-11,0-23.7,0-34.7a1.8,1.8,0,0,1,1.8-1.3H478a1.9,1.9,0,0,1,1.9,2c0,1.3,0,2.6,0,3.9q0,15.2.1,30.4,0,4.5.1,8.9c0,2.5-.7,4.7-3.1,5.9a6.8,6.8,0,0,1-2.4.6c-4.4.3-11.7.1-17.6.1H438.9c-3.8,0-5.6-1.8-5.8-5.3-.1-1.9-.1-3.9-.1-5.8,0-5.5,0-11.1,0-16.6Z&#x27; transform=&#x27;translate(-268.6 -160.1)&#x27;/&gt;        &lt;path fill-opacity=&#x27;0&#x27; stroke-width=&#x27;1&#x27; stroke=&#x27;#bbb&#x27;  d=&#x27;M372.6,366.2q0-11.4,0-22.9c0-1.7.7-2.4,2.3-2.5h5.5c.9,0,2.2.3,2.3,1.5s.1,2.7.1,4q.1,22.3,0,44.5c0,1.5-.3,1.8-1.8,1.9h-7.2a1.4,1.4,0,0,1-1.3-1.4C372.4,383.6,372.5,366.2,372.6,366.2Z&#x27; transform=&#x27;translate(-268.6 -160.1)&#x27;/&gt;        &lt;path fill-opacity=&#x27;0&#x27; stroke-width=&#x27;1&#x27; stroke=&#x27;#bbb&#x27;  d=&#x27;M377.4,326.3h-2.8a3.7,3.7,0,0,0-3.9,3.7c0,.9,0,2.2,0,3.2a3.1,3.1,0,0,0,2.8,2.9c2.5.2,4.7.1,7.2.1a2.7,2.7,0,0,0,2.7-2.8c0-1,0-2.8,0-3.9a3.5,3.5,0,0,0-3.1-3.1Z&#x27; transform=&#x27;translate(-268.6 -160.1)&#x27;/&gt;                     &lt;!--animation path--&gt;    &lt;path fill-opacity=&#x27;0&#x27; stroke-width=&#x27;3&#x27; stroke=&#x27;#1d815e&#x27;  id=&#x27;an&#x27;  d=&#x27;M533.5,390.2V339.7c0-2.9,1.2-4,4.1-4.1h23.5c1.8,0,2.8,1,2.8,2.6s0,1.9,0,2.8q0,12.5,0,25h0q0,12.8,0,25.7a1.7,1.7,0,0,0,.3.9,2.1,2.1,0,0,0,1.2-.4c2.3-2.2,4.4-4.5,6.8-6.7a4.8,4.8,0,0,0,1.6-3.9q-.1-16.6-.1-33.2c0-5.6,0-11.1-.1-16.7a5.9,5.9,0,0,0-1.1-3.3,6.8,6.8,0,0,0-5.8-2.5H531c-2.7,0-5.7,1.6-6.2,4.6-.1.7-.6.9-1.2.7l-1.1-.5-4.7-3.2c-2-1.3-4.3-1.6-6-.2s-2.4,5.2-.8,6.5,6.3,4.8,9.4,7.2,3,1.9,1.6,5.1-1.9,2.9-4,2.8h-24a7.3,7.3,0,0,0-7.3,7.3q0,15.2.2,30.5a5.1,5.1,0,0,0,3.6,5,11.3,11.3,0,0,0,3.2.4h26.9c.7,0,.9-.4.7-1a3.3,3.3,0,0,0-.6-.9l-6.3-7.3a1.9,1.9,0,0,0-1.6-.7H499.8a9.5,9.5,0,0,1-2.3-.3c-1.3-.4-1.7-1-1.7-2.4q-.1-8.9-.1-17.9c0-1.8.6-2.5,2.3-3h23.3c1.4,0,1.9.5,2,1.9s0,.8,0,1.3q0,13.8-.1,27.6a2.4,2.4,0,0,0,2.5,2.7H531A2.3,2.3,0,0,0,533.5,390.2Z&#x27; transform=&#x27;translate(-268.6 -160.1)&#x27;/&gt;        &lt;path fill-opacity=&#x27;0&#x27; stroke-width=&#x27;3&#x27; stroke=&#x27;#1d815e&#x27;  id=&#x27;s&#x27;  d=&#x27;M363.2,326.6a2.7,2.7,0,0,1,2.5,2.8c0,1.6,0,3.3,0,4.9a2.3,2.3,0,0,1-2,2.3h-2.2l-79.9-.3c-2-.1-3.1.9-3.2,3-.1,4.7-.1,9.4,0,14.1a2.7,2.7,0,0,0,3,2.7h23.6a9,9,0,0,1,5.2,1.6,5.3,5.3,0,0,1,2.2,4.3c.2,2.5.2,5,.2,7.5,0,5.9,0,11.8,0,17.7A5.8,5.8,0,0,1,307,393H270.6l-1.2-.3a4.8,4.8,0,0,1,.6-1l4.2-4.3c1.4-1.5,2.9-2.9,4.4-4.3a2.8,2.8,0,0,1,1.7-.5h19.3c2.3,0,3.1-.7,3.1-3s-.1-7.3-.2-10.9c0-1.5-1-2.3-2.8-2.4H275.8a7.2,7.2,0,0,1-7.1-5.5,3.8,3.8,0,0,1-.1-1c0-8.4-.1-16.8,0-25.2.1-4.4,2.1-7.8,7.4-8.1C279,326.4,361.8,326.5,363.2,326.6Z&#x27; transform=&#x27;translate(-268.6 -160.1)&#x27;/&gt;        &lt;path fill-opacity=&#x27;0&#x27; stroke-width=&#x27;3&#x27; stroke=&#x27;#1d815e&#x27;  id=&#x27;y&#x27;  d=&#x27;M387.2,326.2h11.5c1.8,3.4,4.3,8,6.2,11.3a40.2,40.2,0,0,0,2.6,3.8c.5.7.9.3,1.2-.2l5.2-9.1,3.3-5.9h75.7c.5,0,.5.9.1,1.3l-8.9,8.2a2.1,2.1,0,0,1-1.3.3H425.7a1.3,1.3,0,0,0-1.3.8c-2.5,4.6-4.9,9.3-7.6,13.7-.9,1.4-2.3,4.2-2.3,4.2s-.4,26.7-.5,35.3c0,1.4-.7,2.6-1.9,2.6H405c-1.8,0-2.7-.7-2.7-2.5,0-7.9-.1-16.2-.1-24,0-3.4.1-7.7,0-11l-.9-1.9c-4.5-8.9-8.9-16.8-13.5-25.6C387.6,327.4,387.4,326.7,387.2,326.2Z&#x27; transform=&#x27;translate(-268.6 -160.1)&#x27;/&gt;        &lt;path fill-opacity=&#x27;0&#x27; stroke-width=&#x27;3&#x27; stroke=&#x27;#1d815e&#x27;  id=&#x27;Su&#x27;  d=&#x27;M318.6,364.6q0-10.7,0-21.4a2.4,2.4,0,0,1,2.4-2.5h5.2a2.4,2.4,0,0,1,2.6,2.6q.1,17.9.2,35.9c0,2.3.8,3.2,3.2,3.2h21.8c.9,0,1.3-.3,1.3-1.3q0-12.1,0-24.1c0-4.6.1-9.2.2-13.7,0-1.3.5-2.5,2.3-2.5h5.4a2.7,2.7,0,0,1,2.6,3c0,1.2-.2,19.3-.2,27.1,0,5.3.1,10.6,0,15.9a6.9,6.9,0,0,1-1.6,4.9,3.6,3.6,0,0,1-2.8,1.2H333.7c-3.1,0-6.2.2-9.3,0s-5.8-1.8-5.8-5.6c0-7.6,0-15.2,0-22.7Z&#x27; transform=&#x27;translate(-268.6 -160.1)&#x27;/&gt;        &lt;path fill-opacity=&#x27;0&#x27; stroke-width=&#x27;3&#x27; stroke=&#x27;#1d815e&#x27;  id=&#x27;Yu&#x27;  d=&#x27;M432.9,364.8q0-10.7,0-21.5c0-2.3.8-3.1,3.1-3.1h4.1a2.6,2.6,0,0,1,2.7,3c0,1,.1,2,.1,3q0,16.1,0,32.2c0,.4,0,.8,0,1.2a2.3,2.3,0,0,0,2.6,2.4h20.7c2,0,2.9-.8,3.2-2.8a22.7,22.7,0,0,0,.1-2.4c0-11,0-23.7,0-34.7a1.8,1.8,0,0,1,1.8-1.3H478a1.9,1.9,0,0,1,1.9,2c0,1.3,0,2.6,0,3.9q0,15.2.1,30.4,0,4.5.1,8.9c0,2.5-.7,4.7-3.1,5.9a6.8,6.8,0,0,1-2.4.6c-4.4.3-11.7.1-17.6.1H438.9c-3.8,0-5.6-1.8-5.8-5.3-.1-1.9-.1-3.9-.1-5.8,0-5.5,0-11.1,0-16.6Z&#x27; transform=&#x27;translate(-268.6 -160.1)&#x27;/&gt;        &lt;path fill-opacity=&#x27;0&#x27; stroke-width=&#x27;3&#x27; stroke=&#x27;#1d815e&#x27;  id=&#x27;i-lower&#x27;  d=&#x27;M372.6,366.2q0-11.4,0-22.9c0-1.7.7-2.4,2.3-2.5h5.5c.9,0,2.2.3,2.3,1.5s.1,2.7.1,4q.1,22.3,0,44.5c0,1.5-.3,1.8-1.8,1.9h-7.2a1.4,1.4,0,0,1-1.3-1.4C372.4,383.6,372.5,366.2,372.6,366.2Z&#x27; transform=&#x27;translate(-268.6 -160.1)&#x27;/&gt;        &lt;path fill-opacity=&#x27;0&#x27; stroke-width=&#x27;3&#x27; stroke=&#x27;#1d815e&#x27;  id=&#x27;i-upper&#x27;  d=&#x27;M377.4,326.3h-2.8a3.7,3.7,0,0,0-3.9,3.7c0,.9,0,2.2,0,3.2a3.1,3.1,0,0,0,2.8,2.9c2.5.2,4.7.1,7.2.1a2.7,2.7,0,0,0,2.7-2.8c0-1,0-2.8,0-3.9a3.5,3.5,0,0,0-3.1-3.1Z&#x27; transform=&#x27;translate(-268.6 -160.1)&#x27;/&gt;               &lt;path fill-opacity=&#x27;0&#x27; stroke-width=&#x27;3&#x27; stroke=&#x27;#1d815e&#x27;  id=&#x27;logo_path&#x27;  d=&#x27;M354.1,298.4m85.8-14.3a54.6,54.6,0,0,1-16.6,4.3,57.8,57.8,0,0,1-9.7.1,55.7,55.7,0,0,1-9.6-1.5,58.6,58.6,0,0,1-12.1-4.5,56.9,56.9,0,0,1-15.7-12,63.5,63.5,0,0,1-5.4-6.9c-2.1-3.1-3.2-5.6-3.6-6.2a8.2,8.2,0,0,0-3.6-3.5,8.1,8.1,0,0,0-10.8,3.7,8,8,0,0,0,.1,7.2,69.8,69.8,0,0,0,4,7.1c2.2,3.3,4.9,6.7,5.5,7.4a72.6,72.6,0,0,0,11.6,11,71.5,71.5,0,0,0,14.4,8.5,75.6,75.6,0,0,0,13.9,4.5c1.9.4,4.6.9,6.3,1.1s6.8.6,8.3.6a77.5,77.5,0,0,0,17.6-1.9,72.5,72.5,0,0,0,17.4-6.6c1.7-.9,4.6-2.7,6.3-3.8a95.2,95.2,0,0,0,8.5-6.7,106,106,0,0,0,8.3-8.9,62.9,62.9,0,0,0,4.9-7.2c.9-1.4,2.4-4.4,3.6-6.8a74.6,74.6,0,0,0,4-10.8,76.1,76.1,0,0,0,2.3-12c.1-1.7.4-5.7.4-8.3s-.3-5.7-.3-5.8a74.8,74.8,0,0,0-3.1-15.2,81.1,81.1,0,0,0-4.1-10.2,8.2,8.2,0,0,0-12.5-2.6,8.3,8.3,0,0,0-2.4,3.5,8.3,8.3,0,0,0,.1,5.8,52.5,52.5,0,0,1,3.5,8.4c.6,2,1.2,4.3,1.4,5.2a23,23,0,0,1,.3,3.3,5.5,5.5,0,0,1-3.3,4.2c-2,.8-3.9.6-6.8-1-7.5-4.3-16.7-4.8-21.3-4.8-7.6-.1-16.8,3.4-21.9,5.6-13.5,5.9-15.7,8.3-23.9,8.3a25.5,25.5,0,0,1-18.1-7.8,25.2,25.2,0,0,1-7-15.8,24.1,24.1,0,0,1,1.5-10.7,25.7,25.7,0,0,1,3.8-6.8c1.6-2.1,3.9-4.2,8.1-7.5a61.1,61.1,0,0,1,12.6-7.1,54,54,0,0,1,12.7-3.5,65.6,65.6,0,0,1,15-.1,58.2,58.2,0,0,1,15.4,4.1,52.8,52.8,0,0,1,8.8,4.7c2.1,1.4,3.6,2.6,5.9,4.4a8.4,8.4,0,0,0,8.6.1,7.8,7.8,0,0,0,3.6-4.8,8.2,8.2,0,0,0-2.9-8.7l-3.8-2.9a77.9,77.9,0,0,0-7.1-4.5,72.4,72.4,0,0,0-9.1-4.3,70.7,70.7,0,0,0-19.3-4.5,73.8,73.8,0,0,0-15.9.3,69,69,0,0,0-14.7,3.5,57.7,57.7,0,0,0-8.9,3.9,51.2,51.2,0,0,0-8.1,4.8,63.7,63.7,0,0,0-14.1,13.1,40.9,40.9,0,0,0-6.5,13,38.7,38.7,0,0,0-1.7,10.7,43,43,0,0,0,2.6,15.6,42.2,42.2,0,0,0,9,14.1,43.7,43.7,0,0,0,13.4,9.3c8.3,3.5,13.6,3.3,18.3,3.4,12.1-.9,15-4.6,28-9.7s21.1-3.5,26.5-1.8,9.6,3.2,12.2,9.4a13.9,13.9,0,0,1,.8,5.2,33.2,33.2,0,0,1-1,6,24.6,24.6,0,0,1-3.3,7,22.7,22.7,0,0,1-2.1,2.8l-1.9,2c-.8.8-5.5,4.5-6.2,5.1C447.7,280.4,442.5,283,439.9,284.1Z&#x27; transform=&#x27;translate(-268.6 -160.1)&#x27;/&gt;    &quot;</span>);</span><br><span class="line">    <span class="comment">//设置SVG内部id 的动画效果</span></span><br><span class="line">    <span class="keyword">var</span> bar_Su = <span class="keyword">new</span> <span class="title class_">ProgressBar</span>.<span class="title class_">Path</span>(<span class="string">&#x27;#Su&#x27;</span>, &#123;</span><br><span class="line">          <span class="attr">easing</span>: <span class="string">&#x27;easeInOut&#x27;</span>,</span><br><span class="line">          <span class="attr">duration</span>: <span class="number">1000</span></span><br><span class="line">        &#125;);</span><br><span class="line">    bar_Su.<span class="title function_">set</span>(<span class="number">0</span>);</span><br><span class="line">    bar_path_Su = bar_Su;<span class="comment">//赋值到全局变量上，供后面使用</span></span><br><span class="line">    </span><br><span class="line">        <span class="keyword">var</span> bar_S = <span class="keyword">new</span> <span class="title class_">ProgressBar</span>.<span class="title class_">Path</span>(<span class="string">&#x27;#s&#x27;</span>, &#123;</span><br><span class="line">          <span class="attr">easing</span>: <span class="string">&#x27;easeInOut&#x27;</span>,</span><br><span class="line">          <span class="attr">duration</span>: <span class="number">1000</span></span><br><span class="line">        &#125;);</span><br><span class="line">        bar_S.<span class="title function_">set</span>(<span class="number">0</span>);</span><br><span class="line">        bar_path_S = bar_S;</span><br><span class="line">        <span class="keyword">var</span> bar_i_upper = <span class="keyword">new</span> <span class="title class_">ProgressBar</span>.<span class="title class_">Path</span>(<span class="string">&#x27;#i-upper&#x27;</span>, &#123;</span><br><span class="line">          <span class="attr">easing</span>: <span class="string">&#x27;easeInOut&#x27;</span>,</span><br><span class="line">          <span class="attr">duration</span>: <span class="number">1000</span></span><br><span class="line">        &#125;);</span><br><span class="line">        bar_i_upper.<span class="title function_">set</span>(<span class="number">0</span>);</span><br><span class="line">        bar_path_i_upper = bar_i_upper;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">var</span> bar_i_lower = <span class="keyword">new</span> <span class="title class_">ProgressBar</span>.<span class="title class_">Path</span>(<span class="string">&#x27;#i-lower&#x27;</span>, &#123;</span><br><span class="line">          <span class="attr">easing</span>: <span class="string">&#x27;easeInOut&#x27;</span>,</span><br><span class="line">          <span class="attr">duration</span>: <span class="number">1000</span></span><br><span class="line">        &#125;);</span><br><span class="line">        bar_i_lower.<span class="title function_">set</span>(<span class="number">0</span>);</span><br><span class="line">        bar_path_i_lower = bar_i_lower;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">var</span> bar_Y = <span class="keyword">new</span> <span class="title class_">ProgressBar</span>.<span class="title class_">Path</span>(<span class="string">&#x27;#y&#x27;</span>, &#123;</span><br><span class="line">          <span class="attr">easing</span>: <span class="string">&#x27;easeInOut&#x27;</span>,</span><br><span class="line">          <span class="attr">duration</span>: <span class="number">1000</span></span><br><span class="line">        &#125;);</span><br><span class="line">        bar_Y.<span class="title function_">set</span>(<span class="number">0</span>);</span><br><span class="line">        bar_path_Y = bar_Y;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">var</span> bar_Yu = <span class="keyword">new</span> <span class="title class_">ProgressBar</span>.<span class="title class_">Path</span>(<span class="string">&#x27;#Yu&#x27;</span>, &#123;</span><br><span class="line">          <span class="attr">easing</span>: <span class="string">&#x27;easeInOut&#x27;</span>,</span><br><span class="line">          <span class="attr">duration</span>: <span class="number">1000</span></span><br><span class="line">        &#125;);</span><br><span class="line">        bar_Yu.<span class="title function_">set</span>(<span class="number">0</span>);</span><br><span class="line">       bar_path_Yu = bar_Yu;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">var</span> bar_an = <span class="keyword">new</span> <span class="title class_">ProgressBar</span>.<span class="title class_">Path</span>(<span class="string">&#x27;#an&#x27;</span>, &#123;</span><br><span class="line">          <span class="attr">easing</span>: <span class="string">&#x27;easeInOut&#x27;</span>,</span><br><span class="line">          <span class="attr">duration</span>: <span class="number">1000</span></span><br><span class="line">        &#125;);</span><br><span class="line">        bar_an.<span class="title function_">set</span>(<span class="number">0</span>);</span><br><span class="line">        bar_path_an = bar_an;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">var</span> bar_logo = <span class="keyword">new</span> <span class="title class_">ProgressBar</span>.<span class="title class_">Path</span>(<span class="string">&#x27;#logo_path&#x27;</span>, &#123;</span><br><span class="line">          <span class="attr">easing</span>: <span class="string">&#x27;easeInOut&#x27;</span>,</span><br><span class="line">          <span class="attr">duration</span>: <span class="number">1000</span></span><br><span class="line">        &#125;);</span><br><span class="line">        bar_logo.<span class="title function_">set</span>(<span class="number">0</span>);</span><br><span class="line">        bar_path_logo = bar_logo;</span><br><span class="line">&#125;);</span><br><span class="line"></span><br><span class="line"><span class="comment">/*************************/</span></span><br><span class="line"><span class="comment">/***添加tooltip的函数封装***/</span></span><br><span class="line"><span class="comment">/************************/</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">tooltip_anim</span>(<span class="params">id,text,direction,animateType,color</span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> tooltip = <span class="keyword">new</span> <span class="title class_">HTML5TooltipUIComponent</span>;</span><br><span class="line">    <span class="keyword">var</span> target = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>(id);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//预设没有传参的数据</span></span><br><span class="line">    animateType = animateType ===<span class="literal">undefined</span> ? <span class="string">&quot;scalein&quot;</span> : animateType; </span><br><span class="line">    color = color === <span class="literal">undefined</span> ? <span class="string">&#x27;bamboo&#x27;</span> :color;</span><br><span class="line">    direction = direction === <span class="literal">undefined</span> ?<span class="string">&#x27;left&#x27;</span>:direction;</span><br><span class="line">    tooltip.<span class="title function_">set</span>(&#123;</span><br><span class="line">      <span class="attr">animateFunction</span>: animateType,</span><br><span class="line">      <span class="attr">color</span>: color,</span><br><span class="line">      <span class="attr">contentText</span>: text,</span><br><span class="line">      <span class="attr">stickTo</span>: direction,</span><br><span class="line">      <span class="attr">target</span>: target</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    target.<span class="title function_">addEventListener</span>(<span class="string">&#x27;mouseenter&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">      tooltip.<span class="title function_">show</span>();<span class="comment">//鼠标在上面时显示tooltip</span></span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    target.<span class="title function_">addEventListener</span>(<span class="string">&#x27;mouseleave&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>)&#123;</span><br><span class="line">      tooltip.<span class="title function_">hide</span>();<span class="comment">//鼠标离开时取消显示</span></span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    tooltip.<span class="title function_">mount</span>();</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> tooltip;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/************************/</span></span><br><span class="line"><span class="comment">/*****识别手机横竖屏状态****/</span></span><br><span class="line"><span class="comment">/*****调整按钮图标的大小****/</span></span><br><span class="line"><span class="comment">/************************/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> screen_horizontal_check = <span class="literal">true</span>;</span><br><span class="line"><span class="comment">//判断手机横竖屏状态：  参考网上的代码</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">hengshuping</span>(<span class="params"></span>)&#123; </span><br><span class="line">    <span class="keyword">if</span>(<span class="variable language_">window</span>.<span class="property">orientation</span>==<span class="number">180</span>||<span class="variable language_">window</span>.<span class="property">orientation</span>==<span class="number">0</span>)</span><br><span class="line">    &#123; </span><br><span class="line">        <span class="comment">//alert(&quot;竖屏状态！&quot;) </span></span><br><span class="line">        <span class="title function_">large_ico</span>();</span><br><span class="line">        screen_horizontal_check = <span class="literal">true</span>;</span><br><span class="line">    &#125; </span><br><span class="line">    <span class="keyword">if</span>(<span class="variable language_">window</span>.<span class="property">orientation</span>==<span class="number">90</span>||<span class="variable language_">window</span>.<span class="property">orientation</span>==-<span class="number">90</span>)</span><br><span class="line">    &#123; </span><br><span class="line">        <span class="comment">//alert(&quot;横屏状态！&quot;) </span></span><br><span class="line">        <span class="title function_">tiny_ico</span>();</span><br><span class="line">        screen_horizontal_check = <span class="literal">false</span>;</span><br><span class="line">    &#125; </span><br><span class="line">&#125; </span><br><span class="line"><span class="title function_">hengshuping</span>();<span class="comment">//打开网页就进行识别</span></span><br><span class="line"><span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&quot;onorientationchange&quot;</span> <span class="keyword">in</span> <span class="variable language_">window</span> ? <span class="string">&quot;orientationchange&quot;</span> : <span class="string">&quot;resize&quot;</span>, hengshuping, <span class="literal">false</span>); </span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//移动设备适应图标大小</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">ico_size</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">if</span>(isMobile.<span class="property">any</span> == <span class="literal">true</span> &amp;&amp; full_screen_check == <span class="literal">false</span>)&#123;</span><br><span class="line">    <span class="comment">//默认打开网页额时候放大按钮</span></span><br><span class="line">        <span class="keyword">if</span>(screen_horizontal_check)&#123;</span><br><span class="line">            <span class="title function_">large_ico</span>();</span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="comment">//当全屏的时候 恢复按钮大小   </span></span><br><span class="line">        <span class="title function_">tiny_ico</span>();</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//大图标 设置的函数</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">large_ico</span>(<span class="params"></span>)&#123;</span><br><span class="line">    $(<span class="string">&quot;#main&quot;</span>).<span class="title function_">css</span>(<span class="string">&#x27;padding&#x27;</span>,<span class="string">&#x27;20px 48px &#x27;</span>);</span><br><span class="line">    $(<span class="string">&quot;#main&quot;</span>).<span class="title function_">css</span>(<span class="string">&#x27;font-size&#x27;</span>,<span class="string">&#x27;100px &#x27;</span>);</span><br><span class="line">    $(<span class="string">&quot;#help_btn&quot;</span>).<span class="title function_">attr</span>(<span class="string">&#x27;width&#x27;</span>,<span class="string">&#x27;64px&#x27;</span>);</span><br><span class="line">    $(<span class="string">&quot;#full_btn&quot;</span>).<span class="title function_">attr</span>(<span class="string">&#x27;width&#x27;</span>,<span class="string">&#x27;64px&#x27;</span>); </span><br><span class="line">    $(<span class="string">&quot;#share_btn&quot;</span>).<span class="title function_">attr</span>(<span class="string">&#x27;width&#x27;</span>,<span class="string">&#x27;64px&#x27;</span>);</span><br><span class="line">    $(<span class="string">&quot;#stop_btn&quot;</span>).<span class="title function_">attr</span>(<span class="string">&#x27;width&#x27;</span>,<span class="string">&#x27;64px&#x27;</span>);</span><br><span class="line">    $(<span class="string">&quot;#origin_btn&quot;</span>).<span class="title function_">attr</span>(<span class="string">&#x27;width&#x27;</span>,<span class="string">&#x27;64px&#x27;</span>);</span><br><span class="line">    $(<span class="string">&quot;#color_dark_btn&quot;</span>).<span class="title function_">attr</span>(<span class="string">&#x27;width&#x27;</span>,<span class="string">&#x27;64px&#x27;</span>);</span><br><span class="line">    $(<span class="string">&quot;#color_white_btn&quot;</span>).<span class="title function_">attr</span>(<span class="string">&#x27;width&#x27;</span>,<span class="string">&#x27;64px&#x27;</span>);</span><br><span class="line">    </span><br><span class="line">    $(<span class="string">&quot;#help_btn&quot;</span>).<span class="title function_">attr</span>(<span class="string">&#x27;height&#x27;</span>,<span class="string">&#x27;64px&#x27;</span>);</span><br><span class="line">    $(<span class="string">&quot;#full_btn&quot;</span>).<span class="title function_">attr</span>(<span class="string">&#x27;height&#x27;</span>,<span class="string">&#x27;64px&#x27;</span>); </span><br><span class="line">    $(<span class="string">&quot;#share_btn&quot;</span>).<span class="title function_">attr</span>(<span class="string">&#x27;height&#x27;</span>,<span class="string">&#x27;64px&#x27;</span>);</span><br><span class="line">    $(<span class="string">&quot;#stop_btn&quot;</span>).<span class="title function_">attr</span>(<span class="string">&#x27;height&#x27;</span>,<span class="string">&#x27;64px&#x27;</span>);</span><br><span class="line">    $(<span class="string">&quot;#origin_btn&quot;</span>).<span class="title function_">attr</span>(<span class="string">&#x27;height&#x27;</span>,<span class="string">&#x27;64px&#x27;</span>);</span><br><span class="line">    $(<span class="string">&quot;#color_dark_btn&quot;</span>).<span class="title function_">attr</span>(<span class="string">&#x27;height&#x27;</span>,<span class="string">&#x27;64px&#x27;</span>);</span><br><span class="line">    $(<span class="string">&quot;#color_white_btn&quot;</span>).<span class="title function_">attr</span>(<span class="string">&#x27;height&#x27;</span>,<span class="string">&#x27;64px&#x27;</span>);</span><br><span class="line">          </span><br><span class="line">    $(<span class="string">&quot;#help_btn&quot;</span>).<span class="title function_">css</span>(<span class="string">&#x27;padding&#x27;</span>,<span class="string">&#x27;20px 20px&#x27;</span>);</span><br><span class="line">    $(<span class="string">&quot;#full_btn&quot;</span>).<span class="title function_">css</span>(<span class="string">&#x27;padding&#x27;</span>,<span class="string">&#x27;20px 20px&#x27;</span>); </span><br><span class="line">    $(<span class="string">&quot;#share_btn&quot;</span>).<span class="title function_">css</span>(<span class="string">&#x27;padding&#x27;</span>,<span class="string">&#x27;20px 20px&#x27;</span>);</span><br><span class="line">    $(<span class="string">&quot;#stop_btn&quot;</span>).<span class="title function_">css</span>(<span class="string">&#x27;padding&#x27;</span>,<span class="string">&#x27;20px 20px&#x27;</span>);</span><br><span class="line">    $(<span class="string">&quot;#origin_btn&quot;</span>).<span class="title function_">css</span>(<span class="string">&#x27;padding&#x27;</span>,<span class="string">&#x27;20px 20px&#x27;</span>);</span><br><span class="line">    $(<span class="string">&quot;#color_dark_btn&quot;</span>).<span class="title function_">css</span>(<span class="string">&#x27;padding&#x27;</span>,<span class="string">&#x27;20px 20px&#x27;</span>);</span><br><span class="line">    $(<span class="string">&quot;#color_white_btn&quot;</span>).<span class="title function_">css</span>(<span class="string">&#x27;padding&#x27;</span>,<span class="string">&#x27;20px 20px&#x27;</span>);</span><br><span class="line">    </span><br><span class="line">    $(<span class="string">&quot;#help_btn&quot;</span>).<span class="title function_">css</span>(<span class="string">&#x27;bottom&#x27;</span>,<span class="string">&#x27;200px&#x27;</span>);</span><br><span class="line">    $(<span class="string">&quot;#full_btn&quot;</span>).<span class="title function_">css</span>(<span class="string">&#x27;bottom&#x27;</span>,<span class="string">&#x27;325px&#x27;</span>); </span><br><span class="line">    $(<span class="string">&quot;#share_btn&quot;</span>).<span class="title function_">css</span>(<span class="string">&#x27;bottom&#x27;</span>,<span class="string">&#x27;450px&#x27;</span>);</span><br><span class="line">    $(<span class="string">&quot;#stop_btn&quot;</span>).<span class="title function_">css</span>(<span class="string">&#x27;bottom&#x27;</span>,<span class="string">&#x27;575px&#x27;</span>);</span><br><span class="line">    $(<span class="string">&quot;#origin_btn&quot;</span>).<span class="title function_">css</span>(<span class="string">&#x27;bottom&#x27;</span>,<span class="string">&#x27;700px&#x27;</span>);</span><br><span class="line">    $(<span class="string">&quot;#color_dark_btn&quot;</span>).<span class="title function_">css</span>(<span class="string">&#x27;bottom&#x27;</span>,<span class="string">&#x27;450px&#x27;</span>);</span><br><span class="line">    $(<span class="string">&quot;#color_white_btn&quot;</span>).<span class="title function_">css</span>(<span class="string">&#x27;bottom&#x27;</span>,<span class="string">&#x27;450px&#x27;</span>);</span><br><span class="line">        </span><br><span class="line">    $(<span class="string">&quot;#help_btn&quot;</span>).<span class="title function_">css</span>(<span class="string">&#x27;right&#x27;</span>,<span class="string">&#x27;50px&#x27;</span>);</span><br><span class="line">    $(<span class="string">&quot;#full_btn&quot;</span>).<span class="title function_">css</span>(<span class="string">&#x27;right&#x27;</span>,<span class="string">&#x27;50px&#x27;</span>); </span><br><span class="line">    $(<span class="string">&quot;#share_btn&quot;</span>).<span class="title function_">css</span>(<span class="string">&#x27;right&#x27;</span>,<span class="string">&#x27;50px&#x27;</span>);</span><br><span class="line">    $(<span class="string">&quot;#stop_btn&quot;</span>).<span class="title function_">css</span>(<span class="string">&#x27;right&#x27;</span>,<span class="string">&#x27;50px&#x27;</span>);</span><br><span class="line">    $(<span class="string">&quot;#origin_btn&quot;</span>).<span class="title function_">css</span>(<span class="string">&#x27;right&#x27;</span>,<span class="string">&#x27;50px&#x27;</span>);</span><br><span class="line">    $(<span class="string">&quot;#color_dark_btn&quot;</span>).<span class="title function_">css</span>(<span class="string">&#x27;right&#x27;</span>,<span class="string">&#x27;160px&#x27;</span>);</span><br><span class="line">    $(<span class="string">&quot;#color_white_btn&quot;</span>).<span class="title function_">css</span>(<span class="string">&#x27;right&#x27;</span>,<span class="string">&#x27;270px&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//小图标 其实就是默认图标大小</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">tiny_ico</span>(<span class="params"></span>)&#123;</span><br><span class="line">    $(<span class="string">&quot;#main&quot;</span>).<span class="title function_">css</span>(<span class="string">&#x27;padding&#x27;</span>,<span class="string">&#x27;1px 15px &#x27;</span>);</span><br><span class="line">    $(<span class="string">&quot;#main&quot;</span>).<span class="title function_">css</span>(<span class="string">&#x27;font-size&#x27;</span>,<span class="string">&#x27;50px &#x27;</span>);</span><br><span class="line">    $(<span class="string">&quot;#help_btn&quot;</span>).<span class="title function_">attr</span>(<span class="string">&#x27;width&#x27;</span>,<span class="string">&#x27;32px&#x27;</span>);</span><br><span class="line">    $(<span class="string">&quot;#full_btn&quot;</span>).<span class="title function_">attr</span>(<span class="string">&#x27;width&#x27;</span>,<span class="string">&#x27;32px&#x27;</span>); </span><br><span class="line">    $(<span class="string">&quot;#share_btn&quot;</span>).<span class="title function_">attr</span>(<span class="string">&#x27;width&#x27;</span>,<span class="string">&#x27;32px&#x27;</span>);</span><br><span class="line">    $(<span class="string">&quot;#stop_btn&quot;</span>).<span class="title function_">attr</span>(<span class="string">&#x27;width&#x27;</span>,<span class="string">&#x27;32px&#x27;</span>);</span><br><span class="line">    $(<span class="string">&quot;#origin_btn&quot;</span>).<span class="title function_">attr</span>(<span class="string">&#x27;width&#x27;</span>,<span class="string">&#x27;32px&#x27;</span>);</span><br><span class="line">    $(<span class="string">&quot;#color_dark_btn&quot;</span>).<span class="title function_">attr</span>(<span class="string">&#x27;width&#x27;</span>,<span class="string">&#x27;32px&#x27;</span>);</span><br><span class="line">    $(<span class="string">&quot;#color_white_btn&quot;</span>).<span class="title function_">attr</span>(<span class="string">&#x27;width&#x27;</span>,<span class="string">&#x27;32px&#x27;</span>);</span><br><span class="line">    </span><br><span class="line">    $(<span class="string">&quot;#help_btn&quot;</span>).<span class="title function_">attr</span>(<span class="string">&#x27;height&#x27;</span>,<span class="string">&#x27;32px&#x27;</span>);</span><br><span class="line">    $(<span class="string">&quot;#full_btn&quot;</span>).<span class="title function_">attr</span>(<span class="string">&#x27;height&#x27;</span>,<span class="string">&#x27;32px&#x27;</span>); </span><br><span class="line">    $(<span class="string">&quot;#share_btn&quot;</span>).<span class="title function_">attr</span>(<span class="string">&#x27;height&#x27;</span>,<span class="string">&#x27;32px&#x27;</span>);</span><br><span class="line">    $(<span class="string">&quot;#stop_btn&quot;</span>).<span class="title function_">attr</span>(<span class="string">&#x27;height&#x27;</span>,<span class="string">&#x27;32px&#x27;</span>);</span><br><span class="line">    $(<span class="string">&quot;#origin_btn&quot;</span>).<span class="title function_">attr</span>(<span class="string">&#x27;height&#x27;</span>,<span class="string">&#x27;32px&#x27;</span>);</span><br><span class="line">    $(<span class="string">&quot;#color_dark_btn&quot;</span>).<span class="title function_">attr</span>(<span class="string">&#x27;height&#x27;</span>,<span class="string">&#x27;32px&#x27;</span>);</span><br><span class="line">    $(<span class="string">&quot;#color_white_btn&quot;</span>).<span class="title function_">attr</span>(<span class="string">&#x27;height&#x27;</span>,<span class="string">&#x27;32px&#x27;</span>);</span><br><span class="line">          </span><br><span class="line">    $(<span class="string">&quot;#help_btn&quot;</span>).<span class="title function_">css</span>(<span class="string">&#x27;padding&#x27;</span>,<span class="string">&#x27;5px 5px&#x27;</span>);</span><br><span class="line">    $(<span class="string">&quot;#full_btn&quot;</span>).<span class="title function_">css</span>(<span class="string">&#x27;padding&#x27;</span>,<span class="string">&#x27;5px 5px&#x27;</span>); </span><br><span class="line">    $(<span class="string">&quot;#share_btn&quot;</span>).<span class="title function_">css</span>(<span class="string">&#x27;padding&#x27;</span>,<span class="string">&#x27;5px 5px&#x27;</span>);</span><br><span class="line">    $(<span class="string">&quot;#stop_btn&quot;</span>).<span class="title function_">css</span>(<span class="string">&#x27;padding&#x27;</span>,<span class="string">&#x27;5px 5px&#x27;</span>);</span><br><span class="line">    $(<span class="string">&quot;#origin_btn&quot;</span>).<span class="title function_">css</span>(<span class="string">&#x27;padding&#x27;</span>,<span class="string">&#x27;5px 5px&#x27;</span>);</span><br><span class="line">    $(<span class="string">&quot;#color_dark_btn&quot;</span>).<span class="title function_">css</span>(<span class="string">&#x27;padding&#x27;</span>,<span class="string">&#x27;5px 5px&#x27;</span>);</span><br><span class="line">    $(<span class="string">&quot;#color_white_btn&quot;</span>).<span class="title function_">css</span>(<span class="string">&#x27;padding&#x27;</span>,<span class="string">&#x27;5px 5px&#x27;</span>);</span><br><span class="line">    </span><br><span class="line">    $(<span class="string">&quot;#help_btn&quot;</span>).<span class="title function_">css</span>(<span class="string">&#x27;bottom&#x27;</span>,<span class="string">&#x27;100px&#x27;</span>);</span><br><span class="line">    $(<span class="string">&quot;#full_btn&quot;</span>).<span class="title function_">css</span>(<span class="string">&#x27;bottom&#x27;</span>,<span class="string">&#x27;150px&#x27;</span>); </span><br><span class="line">    $(<span class="string">&quot;#share_btn&quot;</span>).<span class="title function_">css</span>(<span class="string">&#x27;bottom&#x27;</span>,<span class="string">&#x27;200px&#x27;</span>);</span><br><span class="line">    $(<span class="string">&quot;#stop_btn&quot;</span>).<span class="title function_">css</span>(<span class="string">&#x27;bottom&#x27;</span>,<span class="string">&#x27;250px&#x27;</span>);</span><br><span class="line">    $(<span class="string">&quot;#origin_btn&quot;</span>).<span class="title function_">css</span>(<span class="string">&#x27;bottom&#x27;</span>,<span class="string">&#x27;300px&#x27;</span>);</span><br><span class="line">    $(<span class="string">&quot;#color_dark_btn&quot;</span>).<span class="title function_">css</span>(<span class="string">&#x27;bottom&#x27;</span>,<span class="string">&#x27;200px&#x27;</span>);</span><br><span class="line">    $(<span class="string">&quot;#color_white_btn&quot;</span>).<span class="title function_">css</span>(<span class="string">&#x27;bottom&#x27;</span>,<span class="string">&#x27;200px&#x27;</span>);</span><br><span class="line">        </span><br><span class="line">    $(<span class="string">&quot;#help_btn&quot;</span>).<span class="title function_">css</span>(<span class="string">&#x27;right&#x27;</span>,<span class="string">&#x27;30px&#x27;</span>);</span><br><span class="line">    $(<span class="string">&quot;#full_btn&quot;</span>).<span class="title function_">css</span>(<span class="string">&#x27;right&#x27;</span>,<span class="string">&#x27;30px&#x27;</span>); </span><br><span class="line">    $(<span class="string">&quot;#share_btn&quot;</span>).<span class="title function_">css</span>(<span class="string">&#x27;right&#x27;</span>,<span class="string">&#x27;30px&#x27;</span>);</span><br><span class="line">    $(<span class="string">&quot;#stop_btn&quot;</span>).<span class="title function_">css</span>(<span class="string">&#x27;right&#x27;</span>,<span class="string">&#x27;30px&#x27;</span>);</span><br><span class="line">    $(<span class="string">&quot;#origin_btn&quot;</span>).<span class="title function_">css</span>(<span class="string">&#x27;right&#x27;</span>,<span class="string">&#x27;30px&#x27;</span>);</span><br><span class="line">    $(<span class="string">&quot;#color_dark_btn&quot;</span>).<span class="title function_">css</span>(<span class="string">&#x27;right&#x27;</span>,<span class="string">&#x27;80px&#x27;</span>);</span><br><span class="line">    $(<span class="string">&quot;#color_white_btn&quot;</span>).<span class="title function_">css</span>(<span class="string">&#x27;right&#x27;</span>,<span class="string">&#x27;130px&#x27;</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*************************/</span></span><br><span class="line"><span class="comment">/*******实现按钮功能********/</span></span><br><span class="line"><span class="comment">/************************/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">/*主菜单 显示按钮功能*/</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">icon_display</span>(<span class="params"></span>)&#123;  </span><br><span class="line">    $(<span class="string">&quot;#help_btn&quot;</span>).<span class="title function_">fadeToggle</span>(<span class="number">100</span>);</span><br><span class="line">    $(<span class="string">&quot;#full_btn&quot;</span>).<span class="title function_">fadeToggle</span>(<span class="number">200</span>);</span><br><span class="line">    $(<span class="string">&quot;#share_btn&quot;</span>).<span class="title function_">fadeToggle</span>(<span class="number">300</span>);</span><br><span class="line">    $(<span class="string">&quot;#stop_btn&quot;</span>).<span class="title function_">fadeToggle</span>(<span class="number">400</span>);</span><br><span class="line">    $(<span class="string">&quot;#origin_btn&quot;</span>).<span class="title function_">fadeToggle</span>(<span class="number">500</span>);</span><br><span class="line">    $(<span class="string">&quot;#color_dark_btn&quot;</span>).<span class="title function_">hide</span>();</span><br><span class="line">    $(<span class="string">&quot;#color_white_btn&quot;</span>).<span class="title function_">hide</span>();</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*按帮助按钮弹出窗口*/</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">help_display</span>(<span class="params"></span>)&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//检测是否是移动设备 弹出不同的帮助文档 分别指示触摸和鼠标</span></span><br><span class="line">    <span class="keyword">if</span>(isMobile.<span class="property">any</span>)&#123;</span><br><span class="line">        <span class="comment">//这里使用picoModal的弹框 代码引用自官方文档</span></span><br><span class="line">    <span class="title function_">picoModal</span>(&#123;</span><br><span class="line">      <span class="attr">content</span>: </span><br><span class="line">       <span class="string">&quot;&lt;div style= &#x27;float:left; margin:10px 10px ;&#x27;&gt;&lt;center&gt;&lt;img src = &#x27;http://webgl.suiyuankj.com/images/ico/sync.ico&#x27; width=&#x27;100px&#x27; height=&#x27;100px&#x27;&gt;&lt;/br&gt;单手滑动进行旋转&lt;/center&gt;&lt;/div&gt;&quot;</span> +</span><br><span class="line">        <span class="string">&quot;&lt;div style= &#x27;float:left; margin:10px 10px ;&#x27;&gt;&lt;center&gt;&lt;img src = &#x27;http://webgl.suiyuankj.com/images/ico/sync.ico&#x27; width=&#x27;100px&#x27; height=&#x27;100px&#x27;&gt;&lt;/br&gt;双手滑动进行缩放&lt;/center&gt;&lt;/div&gt;&quot;</span> +</span><br><span class="line">        <span class="string">&quot;&lt;div style= &#x27;float:left; margin:10px 10px ;&#x27;&gt;&lt;center&gt;&lt;img src = &#x27;http://webgl.suiyuankj.com/images/ico/sync.ico&#x27; width=&#x27;100px&#x27; height=&#x27;100px&#x27;&gt;&lt;/br&gt;三指滑动进行平移&lt;/center&gt;&lt;/div&gt;&quot;</span> </span><br><span class="line">       ,</span><br><span class="line">      <span class="attr">overlayStyles</span>: <span class="keyword">function</span> (<span class="params"> styles </span>) &#123; styles.<span class="property">opacity</span> = <span class="number">0</span>; &#125;,</span><br><span class="line">      <span class="attr">modalStyles</span>: <span class="keyword">function</span> (<span class="params"> styles </span>) &#123; styles.<span class="property">opacity</span> = <span class="number">0</span>; &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">  .<span class="title function_">afterShow</span>(<span class="keyword">function</span>(<span class="params">modal</span>)&#123;</span><br><span class="line">      $(modal.<span class="title function_">overlayElem</span>()).<span class="title function_">animate</span>(&#123;<span class="attr">opacity</span>: <span class="number">.5</span>&#125;);</span><br><span class="line">      $(modal.<span class="title function_">modalElem</span>()).<span class="title function_">animate</span>(&#123;<span class="attr">opacity</span>: <span class="number">1</span>&#125;);</span><br><span class="line">  &#125;)</span><br><span class="line">  .<span class="title function_">beforeClose</span>(<span class="keyword">function</span>(<span class="params">modal, event</span>) &#123;</span><br><span class="line">      event.<span class="title function_">preventDefault</span>();</span><br><span class="line">      $(modal.<span class="title function_">overlayElem</span>()).<span class="title function_">add</span>(modal.<span class="title function_">modalElem</span>())</span><br><span class="line">          .<span class="title function_">animate</span>(</span><br><span class="line">              &#123; <span class="attr">opacity</span>: <span class="number">0</span> &#125;,</span><br><span class="line">              &#123; <span class="attr">complete</span>: modal.<span class="property">forceClose</span> &#125;</span><br><span class="line">          );</span><br><span class="line">  &#125;)</span><br><span class="line">  .<span class="title function_">show</span>();</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="comment">//这里使用picoModal的弹框 代码引用自官方文档</span></span><br><span class="line">    <span class="title function_">picoModal</span>(&#123;</span><br><span class="line">      <span class="attr">content</span>: </span><br><span class="line">       <span class="string">&quot;&lt;div style= &#x27;float:left; margin:10px 10px ;&#x27;&gt;&lt;center&gt;&lt;img src = &#x27;http://webgl.suiyuankj.com/images/ico/sync.ico&#x27; width=&#x27;100px&#x27; height=&#x27;100px&#x27;&gt;&lt;/br&gt;鼠标左键进行旋转&lt;/center&gt;&lt;/div&gt;&quot;</span> +</span><br><span class="line">        <span class="string">&quot;&lt;div style= &#x27;float:left; margin:10px 10px ;&#x27;&gt;&lt;center&gt;&lt;img src = &#x27;http://webgl.suiyuankj.com/images/ico/sync.ico&#x27; width=&#x27;100px&#x27; height=&#x27;100px&#x27;&gt;&lt;/br&gt;鼠标滚轮进行缩放&lt;/center&gt;&lt;/div&gt;&quot;</span> +</span><br><span class="line">        <span class="string">&quot;&lt;div style= &#x27;float:left; margin:10px 10px ;&#x27;&gt;&lt;center&gt;&lt;img src = &#x27;http://webgl.suiyuankj.com/images/ico/sync.ico&#x27; width=&#x27;100px&#x27; height=&#x27;100px&#x27;&gt;&lt;/br&gt;鼠标右键进行平移&lt;/center&gt;&lt;/div&gt;&quot;</span> </span><br><span class="line">       ,</span><br><span class="line">      <span class="attr">overlayStyles</span>: <span class="keyword">function</span> (<span class="params"> styles </span>) &#123; styles.<span class="property">opacity</span> = <span class="number">0</span>; &#125;,</span><br><span class="line">      <span class="attr">modalStyles</span>: <span class="keyword">function</span> (<span class="params"> styles </span>) &#123; styles.<span class="property">opacity</span> = <span class="number">0</span>; &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">  .<span class="title function_">afterShow</span>(<span class="keyword">function</span>(<span class="params">modal</span>)&#123;</span><br><span class="line">      $(modal.<span class="title function_">overlayElem</span>()).<span class="title function_">animate</span>(&#123;<span class="attr">opacity</span>: <span class="number">.5</span>&#125;);</span><br><span class="line">      $(modal.<span class="title function_">modalElem</span>()).<span class="title function_">animate</span>(&#123;<span class="attr">opacity</span>: <span class="number">1</span>&#125;);</span><br><span class="line">  &#125;)</span><br><span class="line">  .<span class="title function_">beforeClose</span>(<span class="keyword">function</span>(<span class="params">modal, event</span>) &#123;</span><br><span class="line">      event.<span class="title function_">preventDefault</span>();</span><br><span class="line">      $(modal.<span class="title function_">overlayElem</span>()).<span class="title function_">add</span>(modal.<span class="title function_">modalElem</span>())</span><br><span class="line">          .<span class="title function_">animate</span>(</span><br><span class="line">              &#123; <span class="attr">opacity</span>: <span class="number">0</span> &#125;,</span><br><span class="line">              &#123; <span class="attr">complete</span>: modal.<span class="property">forceClose</span> &#125;</span><br><span class="line">          );</span><br><span class="line">  &#125;)</span><br><span class="line">  .<span class="title function_">show</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*分享按钮*/</span> <span class="comment">//现在是背景颜色修改功能了 233</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> share_click = <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">share_display</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">if</span>(share_click)&#123;</span><br><span class="line">        tooltip_background.<span class="title function_">set</span>(&#123;<span class="attr">stickTo</span>:<span class="string">&quot;right&quot;</span>&#125;);</span><br><span class="line">        share_click = <span class="literal">false</span>;</span><br><span class="line">        $(<span class="string">&quot;#color_dark_btn&quot;</span>).<span class="title function_">toggle</span>(<span class="number">500</span>);</span><br><span class="line">        $(<span class="string">&quot;#color_white_btn&quot;</span>).<span class="title function_">toggle</span>(<span class="number">500</span>);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        tooltip_background.<span class="title function_">set</span>(&#123;<span class="attr">stickTo</span>:<span class="string">&quot;left&quot;</span>&#125;);</span><br><span class="line">        share_click = <span class="literal">true</span>;</span><br><span class="line">        $(<span class="string">&quot;#color_dark_btn&quot;</span>).<span class="title function_">toggle</span>(<span class="number">500</span>);</span><br><span class="line">        $(<span class="string">&quot;#color_white_btn&quot;</span>).<span class="title function_">toggle</span>(<span class="number">500</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//更改背景颜色的函数</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">dark_BG</span>(<span class="params"></span>)&#123;</span><br><span class="line">    scene.<span class="property">background</span> = <span class="keyword">new</span> <span class="variable constant_">THREE</span>.<span class="title class_">Color</span>( <span class="number">0x333333</span> );<span class="comment">//灰色背景</span></span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">white_BG</span>(<span class="params"></span>)&#123;</span><br><span class="line">    scene.<span class="property">background</span> = <span class="keyword">new</span> <span class="variable constant_">THREE</span>.<span class="title class_">Color</span>( <span class="number">0xF0FFFF</span> );<span class="comment">//白蓝色背景</span></span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*旋转停止按钮*/</span></span><br><span class="line"><span class="keyword">var</span> rotate_check = <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">rotate_stop</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">if</span>(rotate_check)&#123;</span><br><span class="line">        rotate_check=<span class="literal">false</span>;  $(<span class="string">&quot;#stop_btn&quot;</span>).<span class="title function_">attr</span>(<span class="string">&quot;src&quot;</span>,<span class="string">&quot;http://webgl.suiyuankj.com/images/ico/jumplist_startalltask.ico&quot;</span>);  <span class="comment">//修改图标</span></span><br><span class="line">        tooltip_stop.<span class="title function_">set</span>(&#123;<span class="attr">contentText</span>:<span class="string">&quot;开始旋转&quot;</span>&#125;);<span class="comment">//修改tooltip提示</span></span><br><span class="line">        html5tooltips.<span class="title function_">refresh</span>();</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        rotate_check=<span class="literal">true</span>;  $(<span class="string">&quot;#stop_btn&quot;</span>).<span class="title function_">attr</span>(<span class="string">&quot;src&quot;</span>,<span class="string">&quot;http://webgl.suiyuankj.com/images/ico/jumplist_pausealltask.ico&quot;</span>);<span class="comment">//修改图标</span></span><br><span class="line">        tooltip_stop.<span class="title function_">set</span>(&#123;<span class="attr">contentText</span>:<span class="string">&#x27;暂停旋转&#x27;</span>&#125;);<span class="comment">//修改tooltip提示</span></span><br><span class="line">        html5tooltips.<span class="title function_">refresh</span>();</span><br><span class="line">    &#125;   </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*设置全屏函数，供全屏按钮调用*/</span></span><br><span class="line"><span class="keyword">var</span> full_screen_check = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">full_screen_fun</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">if</span>(full_screen_check)&#123;</span><br><span class="line">        <span class="title function_">exitFull</span>();<span class="comment">//退出全屏</span></span><br><span class="line">        <span class="title function_">ico_size</span>();<span class="comment">//自动检测 自适应图标大小</span></span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="title function_">requestFullScreen</span>(<span class="variable language_">document</span>.<span class="property">documentElement</span>);<span class="comment">//  全屏整个网页</span></span><br><span class="line">        <span class="title function_">ico_size</span>();<span class="comment">//自动检测 自适应图标大小</span></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//全屏功能</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">requestFullScreen</span>(<span class="params">element</span>) &#123;</span><br><span class="line">    <span class="comment">// 判断各种浏览器，找到正确的方法</span></span><br><span class="line">    full_screen_check = <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">var</span> requestMethod = element.<span class="property">requestFullScreen</span> || <span class="comment">//W3C</span></span><br><span class="line">    element.<span class="property">webkitRequestFullScreen</span> ||    <span class="comment">//Chrome等</span></span><br><span class="line">    element.<span class="property">mozRequestFullScreen</span> || <span class="comment">//FireFox</span></span><br><span class="line">    element.<span class="property">msRequestFullScreen</span>; <span class="comment">//IE11</span></span><br><span class="line">    <span class="keyword">if</span> (requestMethod) &#123;</span><br><span class="line">        requestMethod.<span class="title function_">call</span>(element);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">typeof</span> <span class="variable language_">window</span>.<span class="property">ActiveXObject</span> !== <span class="string">&quot;undefined&quot;</span>) &#123;<span class="comment">//for Internet Explorer</span></span><br><span class="line">        <span class="keyword">var</span> wscript = <span class="keyword">new</span> <span class="title class_">ActiveXObject</span>(<span class="string">&quot;WScript.Shell&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span> (wscript !== <span class="literal">null</span>) &#123;</span><br><span class="line">            wscript.<span class="title class_">SendKeys</span>(<span class="string">&quot;&#123;F11&#125;&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//退出全屏 判断浏览器种类</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">exitFull</span>(<span class="params"></span>) &#123;</span><br><span class="line">    full_screen_check = <span class="literal">false</span>;</span><br><span class="line">    <span class="comment">// 判断各种浏览器，找到正确的方法</span></span><br><span class="line">    <span class="keyword">var</span> exitMethod = <span class="variable language_">document</span>.<span class="property">exitFullscreen</span> || <span class="comment">//W3C</span></span><br><span class="line">    <span class="variable language_">document</span>.<span class="property">mozCancelFullScreen</span> ||    <span class="comment">//Chrome等</span></span><br><span class="line">    <span class="variable language_">document</span>.<span class="property">webkitExitFullscreen</span> || <span class="comment">//FireFox</span></span><br><span class="line">    <span class="variable language_">document</span>.<span class="property">webkitExitFullscreen</span>; <span class="comment">//IE11</span></span><br><span class="line">    <span class="keyword">if</span> (exitMethod) &#123;</span><br><span class="line">        exitMethod.<span class="title function_">call</span>(<span class="variable language_">document</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (<span class="keyword">typeof</span> <span class="variable language_">window</span>.<span class="property">ActiveXObject</span> !== <span class="string">&quot;undefined&quot;</span>) &#123;<span class="comment">//for Internet Explorer</span></span><br><span class="line">        <span class="keyword">var</span> wscript = <span class="keyword">new</span> <span class="title class_">ActiveXObject</span>(<span class="string">&quot;WScript.Shell&quot;</span>);</span><br><span class="line">        <span class="keyword">if</span> (wscript !== <span class="literal">null</span>) &#123;</span><br><span class="line">            wscript.<span class="title class_">SendKeys</span>(<span class="string">&quot;&#123;F11&#125;&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">&#125; </span><br><span class="line"></span><br><span class="line"><span class="comment">//摄像机回到默认位置</span></span><br><span class="line"><span class="keyword">var</span> camera_check;<span class="comment">//默认摄像机就会自动归位</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">origin_position</span>(<span class="params"></span>)&#123; </span><br><span class="line">    camera_check = <span class="literal">true</span>;  <span class="comment">//点击归位按钮自动归位</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/*获取摄像机位置初值 采用vector向量约束*/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> cameraPosX,cameraPosY,cameraPosZ;</span><br><span class="line">cameraPosX = <span class="number">5</span>;</span><br><span class="line">cameraPosY = <span class="number">2</span>;</span><br><span class="line">cameraPosZ = <span class="number">3</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> <span class="title class_">PosRange</span> = <span class="number">0.3</span>;</span><br><span class="line"><span class="keyword">var</span> <span class="title class_">PosChange</span> = <span class="number">0.3</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//摄像机位置修正 function</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">cameraFix</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="comment">//约束摄像机目标点</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span>(camera_orbitControl_check)&#123;</span><br><span class="line">        controls.<span class="property">target</span> = <span class="keyword">new</span> <span class="variable constant_">THREE</span>.<span class="title class_">Vector3</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>)</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//摄像机位置修正 通过持续递减和递增让摄像机复位</span></span><br><span class="line">    <span class="keyword">if</span>( camera.<span class="property">position</span>.<span class="property">x</span> &gt;= cameraPosX+<span class="title class_">PosRange</span>)&#123;</span><br><span class="line">       camera.<span class="property">position</span>.<span class="property">x</span> -= <span class="title class_">PosChange</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>( camera.<span class="property">position</span>.<span class="property">x</span> &lt;= cameraPosX-<span class="title class_">PosRange</span>)&#123;</span><br><span class="line">        camera.<span class="property">position</span>.<span class="property">x</span> += <span class="title class_">PosChange</span>;</span><br><span class="line">    &#125; </span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span>( camera.<span class="property">position</span>.<span class="property">y</span> &gt;= cameraPosY+<span class="title class_">PosRange</span>)&#123;</span><br><span class="line">        camera.<span class="property">position</span>.<span class="property">y</span> -= <span class="title class_">PosChange</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>( camera.<span class="property">position</span>.<span class="property">y</span> &lt;= cameraPosY-<span class="title class_">PosRange</span>)&#123;</span><br><span class="line">        camera.<span class="property">position</span>.<span class="property">y</span> += <span class="title class_">PosChange</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span>( camera.<span class="property">position</span>.<span class="property">z</span> &gt;= cameraPosZ+<span class="title class_">PosRange</span>)&#123;</span><br><span class="line">        camera.<span class="property">position</span>.<span class="property">z</span> -= <span class="title class_">PosChange</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>( camera.<span class="property">position</span>.<span class="property">z</span> &lt;= cameraPosZ-<span class="title class_">PosRange</span>)&#123;</span><br><span class="line">        camera.<span class="property">position</span>.<span class="property">z</span> += <span class="title class_">PosChange</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//复位完成 关闭修正功能 </span></span><br><span class="line">    <span class="keyword">if</span>(camera.<span class="property">position</span>.<span class="property">x</span> &lt;= cameraPosX+<span class="title class_">PosChange</span> &amp;&amp; camera.<span class="property">position</span>.<span class="property">x</span> &gt;= cameraPosX-<span class="title class_">PosChange</span> &amp;&amp;camera.<span class="property">position</span>.<span class="property">y</span> &lt;= cameraPosY+<span class="title class_">PosChange</span> &amp;&amp; camera.<span class="property">position</span>.<span class="property">y</span> &gt;= cameraPosY-<span class="title class_">PosChange</span> &amp;&amp;camera.<span class="property">position</span>.<span class="property">z</span> &lt;= cameraPosZ+<span class="title class_">PosChange</span> &amp;&amp; camera.<span class="property">position</span>.<span class="property">z</span> &gt;= cameraPosZ-<span class="title class_">PosChange</span> )&#123;</span><br><span class="line">        camera_check = <span class="literal">false</span>;  </span><br><span class="line">    &#125;  </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/************************/</span></span><br><span class="line"><span class="comment">/******自动化按钮函数******/</span></span><br><span class="line"><span class="comment">/************************/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//自动修正摄像机位置</span></span><br><span class="line"><span class="keyword">var</span> cameraTimer;</span><br><span class="line"><span class="keyword">var</span> rotateTimer;</span><br><span class="line"></span><br><span class="line"><span class="comment">//旋转时停止旋转</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;webgl&quot;</span>).<span class="title function_">addEventListener</span>(<span class="string">&#x27;touchstart&#x27;</span>,rotate_AutoStop_0,<span class="literal">false</span> );</span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;webgl&quot;</span>).<span class="title function_">addEventListener</span>(<span class="string">&#x27;touchend&#x27;</span>, rotate_AutoStop_1, <span class="literal">false</span> );</span><br><span class="line"></span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;webgl&quot;</span>).<span class="title function_">addEventListener</span>( <span class="string">&#x27;mousedown&#x27;</span>,rotate_AutoStop_0,<span class="literal">false</span> );</span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&quot;webgl&quot;</span>).<span class="title function_">addEventListener</span>( <span class="string">&#x27;mouseup&#x27;</span>, rotate_AutoStop_1, <span class="literal">false</span> );</span><br><span class="line"></span><br><span class="line">rotateTimer = <span class="built_in">setTimeout</span>(<span class="string">&quot;rotate_stop();&quot;</span>,<span class="number">10000</span>);<span class="comment">//定时10秒之后自动旋转</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">rotate_AutoStop_0</span>(<span class="params"></span>)&#123;</span><br><span class="line">        <span class="built_in">clearTimeout</span>(rotateTimer);</span><br><span class="line">        <span class="comment">//clearTimeout(cameraTimer);</span></span><br><span class="line">        rotate_check = <span class="literal">true</span>;</span><br><span class="line">        <span class="title function_">rotate_stop</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">rotate_AutoStop_1</span>(<span class="params"></span>)&#123;</span><br><span class="line">        </span><br><span class="line">        rotateTimer=<span class="built_in">setTimeout</span>(<span class="string">&quot;rotate_stop();&quot;</span>,<span class="number">3000</span>);</span><br><span class="line">        <span class="comment">//cameraTimer=setTimeout(&quot;camera_check = true;&quot;,10000);</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/************************/</span></span><br><span class="line"><span class="comment">/************************/</span></span><br><span class="line"><span class="comment">/************************/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//这段代码可以在右上角显示帧率</span></span><br><span class="line"><span class="comment">//需要stats.min.js支持</span></span><br><span class="line"><span class="keyword">var</span> stats = <span class="keyword">new</span> <span class="title class_">Stats</span>();  </span><br><span class="line">  </span><br><span class="line"> stats.<span class="title function_">setMode</span>(<span class="number">0</span>);   </span><br><span class="line"> stats.<span class="property">domElement</span>.<span class="property">style</span>.<span class="property">position</span> = <span class="string">&#x27;absolute&#x27;</span>;  </span><br><span class="line"> stats.<span class="property">domElement</span>.<span class="property">style</span>.<span class="property">left</span> = <span class="string">&#x27;0px&#x27;</span>;  </span><br><span class="line"> stats.<span class="property">domElement</span>.<span class="property">style</span>.<span class="property">top</span> = <span class="string">&#x27;0px&#x27;</span>;  </span><br><span class="line"> <span class="variable language_">document</span>.<span class="property">body</span>.<span class="title function_">appendChild</span>(stats.<span class="property">domElement</span>);  </span><br><span class="line"></span><br><span class="line"><span class="comment">/************************/</span></span><br><span class="line"><span class="comment">/*****webgl报错函数********/</span></span><br><span class="line"><span class="comment">/************************/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//浏览器不支持webgl时 弹出消息的函数 此处调用在最顶部</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">webgl_fail</span>(<span class="params"></span>) &#123;</span><br><span class="line">    <span class="comment">//这里依然采用picoModal插件 代码复制自官方（修改弹出内容）</span></span><br><span class="line">   <span class="title function_">picoModal</span>(&#123;</span><br><span class="line">      <span class="attr">content</span>: </span><br><span class="line">       <span class="string">&quot;&lt;center&gt;&lt;strong&gt;当前浏览器没有webgl功能&lt;/br&gt;无法浏览本页面的的内容&lt;/br&gt;您可以更新版本或者使用其他浏览器&lt;/br&gt;推荐使用最新版的chrome浏览器&lt;strong&gt;&lt;/center&gt;&lt;/br&gt;&quot;</span></span><br><span class="line">       ,</span><br><span class="line">      <span class="attr">overlayStyles</span>: <span class="keyword">function</span> (<span class="params"> styles </span>) &#123; styles.<span class="property">opacity</span> = <span class="number">0</span>; &#125;,</span><br><span class="line">      <span class="attr">modalStyles</span>: <span class="keyword">function</span> (<span class="params"> styles </span>) &#123; styles.<span class="property">opacity</span> = <span class="number">0</span>; &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">  .<span class="title function_">afterShow</span>(<span class="keyword">function</span>(<span class="params">modal</span>)&#123;</span><br><span class="line">      $(modal.<span class="title function_">overlayElem</span>()).<span class="title function_">animate</span>(&#123;<span class="attr">opacity</span>: <span class="number">.5</span>&#125;);</span><br><span class="line">      $(modal.<span class="title function_">modalElem</span>()).<span class="title function_">animate</span>(&#123;<span class="attr">opacity</span>: <span class="number">1</span>&#125;);</span><br><span class="line">  &#125;)</span><br><span class="line">  .<span class="title function_">beforeClose</span>(<span class="keyword">function</span>(<span class="params">modal, event</span>) &#123;</span><br><span class="line">      event.<span class="title function_">preventDefault</span>();</span><br><span class="line">      $(modal.<span class="title function_">overlayElem</span>()).<span class="title function_">add</span>(modal.<span class="title function_">modalElem</span>())</span><br><span class="line">          .<span class="title function_">animate</span>(</span><br><span class="line">              &#123; <span class="attr">opacity</span>: <span class="number">0</span> &#125;,</span><br><span class="line">              &#123; <span class="attr">complete</span>: modal.<span class="property">forceClose</span> &#125;</span><br><span class="line">          );</span><br><span class="line">  &#125;)</span><br><span class="line">  .<span class="title function_">show</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//浏览器未开启webgl 弹出消息的函数</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">webgl_update</span>(<span class="params"></span>) &#123;</span><br><span class="line">   <span class="title function_">picoModal</span>(&#123;</span><br><span class="line">      <span class="attr">content</span>: </span><br><span class="line">       <span class="string">&quot;&lt;center&gt;&lt;strong&gt;当前浏览器没有开启webgl 无法加载本页面&lt;strong&gt;&lt;/center&gt;&lt;/br&gt;&lt;/br&gt;&quot;</span> +</span><br><span class="line">       <span class="string">&quot;&lt;center&gt;&lt;strong&gt;需要在浏览器中开启 硬件加速功能 以加载webgl&lt;strong&gt;&lt;/center&gt;&lt;/br&gt;&lt;/br&gt;&quot;</span> +</span><br><span class="line">       <span class="string">&quot;&lt;center&gt;&lt;strong&gt;如果开启 硬件加速功能 不能解决问题&lt;strong&gt;&lt;/center&gt;&lt;/br&gt;&quot;</span> +</span><br><span class="line">       <span class="string">&quot;&lt;center&gt;&lt;strong&gt;说明你的显卡较弱被浏览器屏蔽&lt;strong&gt;&lt;/center&gt;&lt;/br&gt;&quot;</span> +</span><br><span class="line">       <span class="string">&quot;&lt;center&gt;&lt;strong&gt;你需要在浏览器上的地址上输入\&quot;chrome://flags\&quot;&lt;/br&gt;启用Override software rendering list 选项&lt;/br&gt;（中文译名为：覆盖软件渲染列表）&lt;/br&gt;然后重启浏览器&lt;strong&gt;&lt;/center&gt;&lt;/br&gt;&quot;</span> +</span><br><span class="line">       <span class="string">&quot;&lt;center&gt;&lt;strong&gt;上述解决方案来自 &lt;a href=&#x27;https://www.zhihu.com/question/19647275&#x27;&gt;@知乎&lt;/a&gt;&lt;strong&gt;&lt;/center&gt;&lt;/br&gt;&quot;</span> +</span><br><span class="line">       <span class="string">&quot;&lt;center&gt;&lt;strong&gt;更多解决方案 &lt;a href=&#x27;http://blog.csdn.net/long405581649/article/details/22614153&#x27;&gt;@链接&lt;/a&gt;&lt;strong&gt;&lt;/center&gt;&lt;/br&gt;&quot;</span> </span><br><span class="line">       ,</span><br><span class="line">      <span class="attr">overlayStyles</span>: <span class="keyword">function</span> (<span class="params"> styles </span>) &#123; styles.<span class="property">opacity</span> = <span class="number">0</span>; &#125;,</span><br><span class="line">      <span class="attr">modalStyles</span>: <span class="keyword">function</span> (<span class="params"> styles </span>) &#123; styles.<span class="property">opacity</span> = <span class="number">0</span>; &#125;</span><br><span class="line">  &#125;)</span><br><span class="line">  .<span class="title function_">afterShow</span>(<span class="keyword">function</span>(<span class="params">modal</span>)&#123;</span><br><span class="line">      $(modal.<span class="title function_">overlayElem</span>()).<span class="title function_">animate</span>(&#123;<span class="attr">opacity</span>: <span class="number">.5</span>&#125;);</span><br><span class="line">      $(modal.<span class="title function_">modalElem</span>()).<span class="title function_">animate</span>(&#123;<span class="attr">opacity</span>: <span class="number">1</span>&#125;);</span><br><span class="line">  &#125;)</span><br><span class="line">  .<span class="title function_">beforeClose</span>(<span class="keyword">function</span>(<span class="params">modal, event</span>) &#123;</span><br><span class="line">      event.<span class="title function_">preventDefault</span>();</span><br><span class="line">      $(modal.<span class="title function_">overlayElem</span>()).<span class="title function_">add</span>(modal.<span class="title function_">modalElem</span>())</span><br><span class="line">          .<span class="title function_">animate</span>(</span><br><span class="line">              &#123; <span class="attr">opacity</span>: <span class="number">0</span> &#125;,</span><br><span class="line">              &#123; <span class="attr">complete</span>: modal.<span class="property">forceClose</span> &#125;</span><br><span class="line">          );</span><br><span class="line">  &#125;)</span><br><span class="line">  .<span class="title function_">show</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/*****************************/</span></span><br><span class="line"><span class="comment">/*********搭建三维场景**********/</span></span><br><span class="line"><span class="comment">/*设置好望向坐标原点的orbit摄像机*/</span></span><br><span class="line"><span class="comment">/****************************/</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> scene = <span class="keyword">new</span> <span class="variable constant_">THREE</span>.<span class="title class_">Scene</span>();<span class="comment">//创建三维场景</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> camera = <span class="keyword">new</span> <span class="variable constant_">THREE</span>.<span class="title class_">PerspectiveCamera</span>( <span class="number">75</span>, <span class="variable language_">window</span>.<span class="property">innerWidth</span> / <span class="variable language_">window</span>.<span class="property">innerHeight</span>, <span class="number">0.1</span>, <span class="number">10000</span> );<span class="comment">//创建摄像机</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> renderer = <span class="keyword">new</span> <span class="variable constant_">THREE</span>.<span class="title class_">WebGLRenderer</span>(&#123;</span><br><span class="line">    <span class="attr">antialias</span>: <span class="literal">true</span>,</span><br><span class="line">    <span class="attr">alpha</span>:<span class="literal">false</span>,</span><br><span class="line">    <span class="attr">preserveDrawingBuffer</span>: <span class="literal">false</span>&#125;);<span class="comment">//使用Webgl渲染 </span></span><br><span class="line"></span><br><span class="line">renderer.<span class="title function_">setSize</span>( <span class="variable language_">window</span>.<span class="property">innerWidth</span> - <span class="number">3</span>, <span class="variable language_">window</span>.<span class="property">innerHeight</span>-<span class="number">3</span> );<span class="comment">//设置渲染的范围大小</span></span><br><span class="line">renderer.<span class="title function_">setPixelRatio</span>( <span class="variable language_">window</span>.<span class="property">devicePixelRatio</span> );</span><br><span class="line">renderer.<span class="property">shadowMapEnabled</span> = <span class="literal">true</span>; <span class="comment">//为渲染器开启 深度贴图阴影</span></span><br><span class="line">renderer.<span class="property">shadowMapType</span> = <span class="variable constant_">THREE</span>.<span class="property">PCFSoftShadowMap</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//将渲染的内容添加到HTML中</span></span><br><span class="line"><span class="variable language_">document</span>.<span class="title function_">getElementById</span>(<span class="string">&#x27;webgl&#x27;</span>).<span class="title function_">appendChild</span>( renderer.<span class="property">domElement</span> );</span><br><span class="line"></span><br><span class="line"><span class="comment">//开启pointerLock摄像机</span></span><br><span class="line"><span class="keyword">var</span> controls;</span><br><span class="line"><span class="keyword">var</span> controlsEnabled = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> moveForward = <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">var</span> moveBackward = <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">var</span> moveLeft = <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">var</span> moveRight = <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">var</span> canJump = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> prevTime = performance.<span class="title function_">now</span>();</span><br><span class="line"><span class="keyword">var</span> velocity = <span class="keyword">new</span> <span class="variable constant_">THREE</span>.<span class="title class_">Vector3</span>();</span><br><span class="line"><span class="keyword">var</span> direction = <span class="keyword">new</span> <span class="variable constant_">THREE</span>.<span class="title class_">Vector3</span>();</span><br><span class="line"><span class="comment">//var raycaster;</span></span><br><span class="line"><span class="keyword">var</span> objects = [];</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">camera_pointerLockControl</span>(<span class="params"></span>)&#123;</span><br><span class="line"></span><br><span class="line">    </span><br><span class="line">    controls = <span class="keyword">new</span> <span class="variable constant_">THREE</span>.<span class="title class_">PointerLockControls</span>( camera );</span><br><span class="line">    scene.<span class="title function_">add</span>( controls.<span class="title function_">getObject</span>() );</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> onKeyDown = <span class="keyword">function</span> (<span class="params"> event </span>) &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">switch</span> ( event.<span class="property">keyCode</span> ) &#123;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">case</span> <span class="number">38</span>: <span class="comment">// up</span></span><br><span class="line">            <span class="keyword">case</span> <span class="number">87</span>: <span class="comment">// w</span></span><br><span class="line">                moveForward = <span class="literal">true</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">case</span> <span class="number">37</span>: <span class="comment">// left</span></span><br><span class="line">            <span class="keyword">case</span> <span class="number">65</span>: <span class="comment">// a</span></span><br><span class="line">                moveLeft = <span class="literal">true</span>; <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">case</span> <span class="number">40</span>: <span class="comment">// down</span></span><br><span class="line">            <span class="keyword">case</span> <span class="number">83</span>: <span class="comment">// s</span></span><br><span class="line">                moveBackward = <span class="literal">true</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">case</span> <span class="number">39</span>: <span class="comment">// right</span></span><br><span class="line">            <span class="keyword">case</span> <span class="number">68</span>: <span class="comment">// d</span></span><br><span class="line">                moveRight = <span class="literal">true</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">case</span> <span class="number">32</span>: <span class="comment">// space</span></span><br><span class="line">                <span class="keyword">if</span> ( canJump === <span class="literal">true</span> ) velocity.<span class="property">y</span> += <span class="number">250</span>;</span><br><span class="line">                canJump = <span class="literal">false</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> onKeyUp = <span class="keyword">function</span> (<span class="params"> event </span>) &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">switch</span>( event.<span class="property">keyCode</span> ) &#123;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">case</span> <span class="number">38</span>: <span class="comment">// up</span></span><br><span class="line">            <span class="keyword">case</span> <span class="number">87</span>: <span class="comment">// w</span></span><br><span class="line">                moveForward = <span class="literal">false</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">case</span> <span class="number">37</span>: <span class="comment">// left</span></span><br><span class="line">            <span class="keyword">case</span> <span class="number">65</span>: <span class="comment">// a</span></span><br><span class="line">                moveLeft = <span class="literal">false</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">case</span> <span class="number">40</span>: <span class="comment">// down</span></span><br><span class="line">            <span class="keyword">case</span> <span class="number">83</span>: <span class="comment">// s</span></span><br><span class="line">                moveBackward = <span class="literal">false</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">case</span> <span class="number">39</span>: <span class="comment">// right</span></span><br><span class="line">            <span class="keyword">case</span> <span class="number">68</span>: <span class="comment">// d</span></span><br><span class="line">                moveRight = <span class="literal">false</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;;</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">document</span>.<span class="title function_">addEventListener</span>( <span class="string">&#x27;keydown&#x27;</span>, onKeyDown, <span class="literal">false</span> );</span><br><span class="line">    <span class="variable language_">document</span>.<span class="title function_">addEventListener</span>( <span class="string">&#x27;keyup&#x27;</span>, onKeyUp, <span class="literal">false</span> );</span><br><span class="line">    raycaster = <span class="keyword">new</span> <span class="variable constant_">THREE</span>.<span class="title class_">Raycaster</span>( <span class="keyword">new</span> <span class="variable constant_">THREE</span>.<span class="title class_">Vector3</span>(), <span class="keyword">new</span> <span class="variable constant_">THREE</span>.<span class="title class_">Vector3</span>( <span class="number">0</span>, - <span class="number">1</span>, <span class="number">0</span> ), <span class="number">0</span>, <span class="number">10</span> );</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">camera_pointerLockControl_block</span>(<span class="params"></span>)&#123;</span><br><span class="line">        $(<span class="string">&#x27;#webgl&#x27;</span>).<span class="title function_">append</span>(<span class="string">&quot;&lt;div id=\&quot;blocker\&quot;&gt;&lt;div id=\&quot;instructions\&quot;&gt;&lt;span style=\&quot;font-size:40px\&quot;&gt;点击开始&lt;/span&gt;&lt;br /&gt;(键盘WASD键可以移动, 空格键可以跳跃, 鼠标可以控制镜头)&lt;/div&gt;&lt;/div&gt;&quot;</span>);</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> blocker = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>( <span class="string">&#x27;blocker&#x27;</span> );</span><br><span class="line">        <span class="keyword">var</span> instructions = <span class="variable language_">document</span>.<span class="title function_">getElementById</span>( <span class="string">&#x27;instructions&#x27;</span> );</span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> havePointerLock = <span class="string">&#x27;pointerLockElement&#x27;</span> <span class="keyword">in</span> <span class="variable language_">document</span> || <span class="string">&#x27;mozPointerLockElement&#x27;</span> <span class="keyword">in</span> <span class="variable language_">document</span> || <span class="string">&#x27;webkitPointerLockElement&#x27;</span> <span class="keyword">in</span> <span class="variable language_">document</span>;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> ( havePointerLock ) &#123;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">var</span> element = <span class="variable language_">document</span>.<span class="property">body</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">var</span> pointerlockchange = <span class="keyword">function</span> (<span class="params"> event </span>) &#123;</span><br><span class="line"></span><br><span class="line">                <span class="keyword">if</span> ( <span class="variable language_">document</span>.<span class="property">pointerLockElement</span> === element || <span class="variable language_">document</span>.<span class="property">mozPointerLockElement</span> === element || <span class="variable language_">document</span>.<span class="property">webkitPointerLockElement</span> === element ) &#123;</span><br><span class="line"></span><br><span class="line">                    controlsEnabled = <span class="literal">true</span>;</span><br><span class="line">                    controls.<span class="property">enabled</span> = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">                    blocker.<span class="property">style</span>.<span class="property">display</span> = <span class="string">&#x27;none&#x27;</span>;</span><br><span class="line"></span><br><span class="line">                &#125; <span class="keyword">else</span> &#123;</span><br><span class="line"></span><br><span class="line">                    controls.<span class="property">enabled</span> = <span class="literal">false</span>;</span><br><span class="line"></span><br><span class="line">                    blocker.<span class="property">style</span>.<span class="property">display</span> = <span class="string">&#x27;block&#x27;</span>;</span><br><span class="line"></span><br><span class="line">                    instructions.<span class="property">style</span>.<span class="property">display</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line"></span><br><span class="line">                &#125;</span><br><span class="line"></span><br><span class="line">            &#125;;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">var</span> pointerlockerror = <span class="keyword">function</span> (<span class="params"> event </span>) &#123;</span><br><span class="line"></span><br><span class="line">                instructions.<span class="property">style</span>.<span class="property">display</span> = <span class="string">&#x27;&#x27;</span>;</span><br><span class="line"></span><br><span class="line">            &#125;;</span><br><span class="line"></span><br><span class="line">            <span class="comment">// Hook pointer lock state change events</span></span><br><span class="line">            <span class="variable language_">document</span>.<span class="title function_">addEventListener</span>( <span class="string">&#x27;pointerlockchange&#x27;</span>, pointerlockchange, <span class="literal">false</span> );</span><br><span class="line">            <span class="variable language_">document</span>.<span class="title function_">addEventListener</span>( <span class="string">&#x27;mozpointerlockchange&#x27;</span>, pointerlockchange, <span class="literal">false</span> );</span><br><span class="line">            <span class="variable language_">document</span>.<span class="title function_">addEventListener</span>( <span class="string">&#x27;webkitpointerlockchange&#x27;</span>, pointerlockchange, <span class="literal">false</span> );</span><br><span class="line"></span><br><span class="line">            <span class="variable language_">document</span>.<span class="title function_">addEventListener</span>( <span class="string">&#x27;pointerlockerror&#x27;</span>, pointerlockerror, <span class="literal">false</span> );</span><br><span class="line">            <span class="variable language_">document</span>.<span class="title function_">addEventListener</span>( <span class="string">&#x27;mozpointerlockerror&#x27;</span>, pointerlockerror, <span class="literal">false</span> );</span><br><span class="line">            <span class="variable language_">document</span>.<span class="title function_">addEventListener</span>( <span class="string">&#x27;webkitpointerlockerror&#x27;</span>, pointerlockerror, <span class="literal">false</span> );</span><br><span class="line"></span><br><span class="line">            instructions.<span class="title function_">addEventListener</span>( <span class="string">&#x27;click&#x27;</span>, <span class="keyword">function</span> (<span class="params"> event </span>) &#123;</span><br><span class="line"></span><br><span class="line">                instructions.<span class="property">style</span>.<span class="property">display</span> = <span class="string">&#x27;none&#x27;</span>;</span><br><span class="line"></span><br><span class="line">                <span class="comment">// Ask the browser to lock the pointer</span></span><br><span class="line">                element.<span class="property">requestPointerLock</span> = element.<span class="property">requestPointerLock</span> || element.<span class="property">mozRequestPointerLock</span> || element.<span class="property">webkitRequestPointerLock</span>;</span><br><span class="line">                element.<span class="title function_">requestPointerLock</span>();</span><br><span class="line"></span><br><span class="line">            &#125;, <span class="literal">false</span> );</span><br><span class="line"></span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line"></span><br><span class="line">            instructions.<span class="property">innerHTML</span> = <span class="string">&#x27;Your browser doesn\&#x27;t seem to support Pointer Lock API&#x27;</span>;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">camera_pointerLockControl_collison_detect</span>(<span class="params"></span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> angle = controls.<span class="title function_">getObject</span>().<span class="property">rotation</span>.<span class="property">y</span>;</span><br><span class="line">                    </span><br><span class="line">    <span class="keyword">var</span> raycaster_top = <span class="keyword">new</span> <span class="variable constant_">THREE</span>.<span class="title class_">Raycaster</span>( <span class="keyword">new</span> <span class="variable constant_">THREE</span>.<span class="title class_">Vector3</span>(), <span class="keyword">new</span> <span class="variable constant_">THREE</span>.<span class="title class_">Vector3</span>( <span class="number">0</span>, <span class="number">1</span>, <span class="number">0</span>), <span class="number">0</span>, <span class="number">1</span> );</span><br><span class="line"></span><br><span class="line">    raycaster_top.<span class="property">ray</span>.<span class="property">origin</span>.<span class="title function_">copy</span>( controls.<span class="title function_">getObject</span>().<span class="property">position</span> );</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> intersections_top = raycaster_top.<span class="title function_">intersectObjects</span>( objects );</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> ( intersections_top.<span class="property">length</span> &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="comment">//console.log(&quot;detect_top&quot;);</span></span><br><span class="line">        velocity.<span class="property">y</span> = <span class="title class_">Math</span>.<span class="title function_">min</span>( <span class="number">0</span>, velocity.<span class="property">y</span> );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> raycaster_front = <span class="keyword">new</span> <span class="variable constant_">THREE</span>.<span class="title class_">Raycaster</span>( <span class="keyword">new</span> <span class="variable constant_">THREE</span>.<span class="title class_">Vector3</span>(), <span class="keyword">new</span> <span class="variable constant_">THREE</span>.<span class="title class_">Vector3</span>( -<span class="title class_">Math</span>.<span class="title function_">sin</span>(angle), <span class="number">0</span>, -<span class="title class_">Math</span>.<span class="title function_">cos</span>(angle)), <span class="number">0</span>, <span class="number">2</span> );</span><br><span class="line"></span><br><span class="line">    raycaster_front.<span class="property">ray</span>.<span class="property">origin</span>.<span class="title function_">copy</span>( controls.<span class="title function_">getObject</span>().<span class="property">position</span> );</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> intersections_front = raycaster_front.<span class="title function_">intersectObjects</span>( objects );</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> ( intersections_front.<span class="property">length</span> &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="comment">//console.log(&quot;detect_front&quot;);</span></span><br><span class="line">        velocity.<span class="property">z</span> = <span class="title class_">Math</span>.<span class="title function_">max</span>( <span class="number">0</span>, velocity.<span class="property">z</span> );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> raycaster_back = <span class="keyword">new</span> <span class="variable constant_">THREE</span>.<span class="title class_">Raycaster</span>( <span class="keyword">new</span> <span class="variable constant_">THREE</span>.<span class="title class_">Vector3</span>(), <span class="keyword">new</span> <span class="variable constant_">THREE</span>.<span class="title class_">Vector3</span>( -<span class="title class_">Math</span>.<span class="title function_">sin</span>(angle + <span class="title class_">Math</span>.<span class="property">PI</span>), <span class="number">0</span>, -<span class="title class_">Math</span>.<span class="title function_">cos</span>(angle + <span class="title class_">Math</span>.<span class="property">PI</span>)), <span class="number">0</span>, <span class="number">2</span> );</span><br><span class="line"></span><br><span class="line">    raycaster_back.<span class="property">ray</span>.<span class="property">origin</span>.<span class="title function_">copy</span>( controls.<span class="title function_">getObject</span>().<span class="property">position</span> );</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> intersections_back = raycaster_back.<span class="title function_">intersectObjects</span>( objects );</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> ( intersections_back.<span class="property">length</span> &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="comment">//console.log(&quot;detect_back&quot;);</span></span><br><span class="line">        velocity.<span class="property">z</span> = <span class="title class_">Math</span>.<span class="title function_">min</span>( <span class="number">0</span>, velocity.<span class="property">z</span> );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> raycaster_left = <span class="keyword">new</span> <span class="variable constant_">THREE</span>.<span class="title class_">Raycaster</span>( <span class="keyword">new</span> <span class="variable constant_">THREE</span>.<span class="title class_">Vector3</span>(), <span class="keyword">new</span> <span class="variable constant_">THREE</span>.<span class="title class_">Vector3</span>( -<span class="title class_">Math</span>.<span class="title function_">sin</span>(angle + <span class="title class_">Math</span>.<span class="property">PI</span>/<span class="number">2</span>), <span class="number">0</span>, -<span class="title class_">Math</span>.<span class="title function_">cos</span>(angle + <span class="title class_">Math</span>.<span class="property">PI</span>/<span class="number">2</span>)), <span class="number">0</span>, <span class="number">2</span> );</span><br><span class="line"></span><br><span class="line">    raycaster_left.<span class="property">ray</span>.<span class="property">origin</span>.<span class="title function_">copy</span>( controls.<span class="title function_">getObject</span>().<span class="property">position</span> );</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> intersections_left = raycaster_left.<span class="title function_">intersectObjects</span>( objects );</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> ( intersections_left.<span class="property">length</span> &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="comment">//console.log(&quot;detect_left&quot;);</span></span><br><span class="line">        velocity.<span class="property">x</span> = <span class="title class_">Math</span>.<span class="title function_">max</span>( <span class="number">0</span>, velocity.<span class="property">x</span> );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> raycaster_right = <span class="keyword">new</span> <span class="variable constant_">THREE</span>.<span class="title class_">Raycaster</span>( <span class="keyword">new</span> <span class="variable constant_">THREE</span>.<span class="title class_">Vector3</span>(), <span class="keyword">new</span> <span class="variable constant_">THREE</span>.<span class="title class_">Vector3</span>( -<span class="title class_">Math</span>.<span class="title function_">sin</span>(angle - <span class="title class_">Math</span>.<span class="property">PI</span>/<span class="number">2</span>), <span class="number">0</span>, -<span class="title class_">Math</span>.<span class="title function_">cos</span>(angle - <span class="title class_">Math</span>.<span class="property">PI</span>/<span class="number">2</span>)), <span class="number">0</span>, <span class="number">2</span> );</span><br><span class="line"></span><br><span class="line">    raycaster_right.<span class="property">ray</span>.<span class="property">origin</span>.<span class="title function_">copy</span>( controls.<span class="title function_">getObject</span>().<span class="property">position</span> );</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> intersections_right = raycaster_right.<span class="title function_">intersectObjects</span>( objects );</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> ( intersections_right.<span class="property">length</span> &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="comment">//console.log(&quot;detect_right&quot;);</span></span><br><span class="line">        velocity.<span class="property">x</span> = <span class="title class_">Math</span>.<span class="title function_">min</span>( <span class="number">0</span>, velocity.<span class="property">x</span> );</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> raycaster_down = <span class="keyword">new</span> <span class="variable constant_">THREE</span>.<span class="title class_">Raycaster</span>( <span class="keyword">new</span> <span class="variable constant_">THREE</span>.<span class="title class_">Vector3</span>(), <span class="keyword">new</span> <span class="variable constant_">THREE</span>.<span class="title class_">Vector3</span>( <span class="number">0</span>, - <span class="number">1</span>, <span class="number">0</span> ), <span class="number">0</span>, <span class="number">10</span> );</span><br><span class="line"></span><br><span class="line">    raycaster_down.<span class="property">ray</span>.<span class="property">origin</span>.<span class="title function_">copy</span>( controls.<span class="title function_">getObject</span>().<span class="property">position</span> );</span><br><span class="line">    <span class="comment">//raycaster_down.ray.origin.y += 10;</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> intersections_down = raycaster_down.<span class="title function_">intersectObjects</span>( objects );</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> ( intersections_down.<span class="property">length</span> &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        velocity.<span class="property">y</span> = <span class="title class_">Math</span>.<span class="title function_">max</span>( <span class="number">0</span>, velocity.<span class="property">y</span> );</span><br><span class="line">        canJump = <span class="literal">true</span>; </span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> raycaster = <span class="keyword">new</span> <span class="variable constant_">THREE</span>.<span class="title class_">Raycaster</span>( <span class="keyword">new</span> <span class="variable constant_">THREE</span>.<span class="title class_">Vector3</span>(), <span class="keyword">new</span> <span class="variable constant_">THREE</span>.<span class="title class_">Vector3</span>( -<span class="title class_">Math</span>.<span class="title function_">sin</span>(angle), <span class="number">0</span>, -<span class="title class_">Math</span>.<span class="title function_">cos</span>(angle)), <span class="number">0</span>, <span class="number">5</span> );</span><br><span class="line"></span><br><span class="line">    raycaster.<span class="property">ray</span>.<span class="property">origin</span>.<span class="title function_">copy</span>( controls.<span class="title function_">getObject</span>().<span class="property">position</span> );</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> intersections = raycaster.<span class="title function_">intersectObjects</span>( objects );</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> ( intersections.<span class="property">length</span> &gt; <span class="number">0</span>) &#123;</span><br><span class="line">        <span class="comment">/*var glowMesh	= new THREEx.GeometricGlowMesh(intersections[0])</span></span><br><span class="line"><span class="comment">	    intersections[0].add(glowMesh.object3d)</span></span><br><span class="line"><span class="comment">        var insideUniforms	= glowMesh.insideMesh.material.uniforms</span></span><br><span class="line"><span class="comment">        insideUniforms.glowColor.value.set(&#x27;white&#x27;)</span></span><br><span class="line"><span class="comment">        var outsideUniforms	= glowMesh.outsideMesh.material.uniforms</span></span><br><span class="line"><span class="comment">        outsideUniforms.glowColor.value.set(&#x27;white&#x27;)*/</span></span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//开启orbit摄像机</span></span><br><span class="line">camera_orbitControl_check = <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">camera_orbitControl</span>(<span class="params">minDistance,maxDistance,enableDamping,dampingFactor,rotateSpeed,zoomSpeed</span>)&#123;</span><br><span class="line">    camera_orbitControl_check = <span class="literal">true</span>;</span><br><span class="line">    <span class="comment">//启用orbit摄像机 可以实现环绕360度摄像机 支持缩放功能 需要OrbitControls.js支持 </span></span><br><span class="line">    controls = <span class="keyword">new</span> <span class="variable constant_">THREE</span>.<span class="title class_">OrbitControls</span>( camera, renderer.<span class="property">domElement</span> );</span><br><span class="line">    <span class="comment">//设置摄像机的位置（摄像机在0，0，0位置，看不见东西）</span></span><br><span class="line">    camera.<span class="property">position</span>.<span class="property">z</span> = <span class="number">25</span>;</span><br><span class="line">    camera.<span class="property">position</span>.<span class="property">y</span> = <span class="number">20</span>;</span><br><span class="line">    camera.<span class="property">position</span>.<span class="property">x</span> = <span class="number">25</span>;</span><br><span class="line">    controls.<span class="property">target</span> = <span class="keyword">new</span> <span class="variable constant_">THREE</span>.<span class="title class_">Vector3</span>(<span class="number">0</span>, <span class="number">0</span>, <span class="number">0</span>);</span><br><span class="line">    <span class="comment">//camera.lookAt(new THREE.Vector3(0, 30, 0));//使摄像机望向原点</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">//这里为参数设置初值 </span></span><br><span class="line">    <span class="comment">/*</span></span><br><span class="line"><span class="comment">    a==b?b++:0</span></span><br><span class="line"><span class="comment">    这个就是如果a等于b成立，就返回b++，如果不成立，就返回0</span></span><br><span class="line"><span class="comment">    */</span></span><br><span class="line">    minDistance = minDistance === <span class="literal">undefined</span> ? <span class="number">3</span> : minDistance;</span><br><span class="line">    maxDistance = maxDistance === <span class="literal">undefined</span> ? <span class="number">25</span> : maxDistance;</span><br><span class="line">    enableDamping = enableDamping === <span class="literal">undefined</span> ? <span class="literal">true</span> : enableDamping;</span><br><span class="line">    dampingFactor = dampingFactor === <span class="literal">undefined</span> ? <span class="number">0.1</span> : dampingFactor;</span><br><span class="line">    rotateSpeed = rotateSpeed === <span class="literal">undefined</span> ? <span class="number">0.15</span> : rotateSpeed;</span><br><span class="line">    zoomSpeed = zoomSpeed === <span class="literal">undefined</span> ? <span class="number">1</span> : zoomSpeed; </span><br><span class="line"></span><br><span class="line">    controls.<span class="property">enableDamping</span> = enableDamping;</span><br><span class="line">    controls.<span class="property">dampingFactor</span> = dampingFactor;</span><br><span class="line">    controls.<span class="property">rotateSpeed</span> = rotateSpeed;</span><br><span class="line">    controls.<span class="property">zoomSpeed</span> = zoomSpeed;</span><br><span class="line">    controls.<span class="property">maxDistance</span> = maxDistance;</span><br><span class="line">    controls.<span class="property">minDistance</span> = minDistance;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="variable language_">window</span>.<span class="title function_">addEventListener</span>(<span class="string">&#x27;resize&#x27;</span>,<span class="keyword">function</span>(<span class="params"></span>)</span><br><span class="line">&#123;</span><br><span class="line">    <span class="comment">//调节窗口大小的时候可以自动刷新界面（否则渲染界面大小不改变）</span></span><br><span class="line">    <span class="keyword">var</span> width = <span class="variable language_">window</span>.<span class="property">innerWidth</span> - <span class="number">3</span>;</span><br><span class="line">    <span class="keyword">var</span> height = <span class="variable language_">window</span>.<span class="property">innerHeight</span> -<span class="number">3</span>;</span><br><span class="line">    renderer.<span class="title function_">setSize</span>(width,height);</span><br><span class="line">    camera.<span class="property">aspect</span> = width/height;</span><br><span class="line">    camera.<span class="title function_">updateProjectionMatrix</span>(); </span><br><span class="line">    <span class="comment">//当窗口过小的时候 图标放不下 所以使用小图标模式</span></span><br><span class="line">    <span class="keyword">if</span>(width&lt;<span class="number">300</span> || height &lt; <span class="number">300</span>)&#123;</span><br><span class="line">                </span><br><span class="line">                $(<span class="string">&quot;#main&quot;</span>).<span class="title function_">hide</span>();</span><br><span class="line">                $(<span class="string">&quot;#help_btn&quot;</span>).<span class="title function_">hide</span>();</span><br><span class="line">                $(<span class="string">&quot;#full_btn&quot;</span>).<span class="title function_">hide</span>();</span><br><span class="line">                $(<span class="string">&quot;#share_btn&quot;</span>).<span class="title function_">hide</span>();</span><br><span class="line">                $(<span class="string">&quot;#stop_btn&quot;</span>).<span class="title function_">hide</span>();</span><br><span class="line">                $(<span class="string">&quot;#origin_btn&quot;</span>).<span class="title function_">hide</span>();</span><br><span class="line">                $(<span class="string">&quot;#color_white_btn_small&quot;</span>).<span class="title function_">show</span>();</span><br><span class="line">                $(<span class="string">&quot;#color_dark_btn_small&quot;</span>).<span class="title function_">show</span>();</span><br><span class="line">                          </span><br><span class="line">                </span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="comment">//当窗口够大回复默认状态</span></span><br><span class="line">        $(<span class="string">&quot;#main&quot;</span>).<span class="title function_">show</span>();</span><br><span class="line">        $(<span class="string">&quot;#color_white_btn_small&quot;</span>).<span class="title function_">hide</span>();</span><br><span class="line">        $(<span class="string">&quot;#color_dark_btn_small&quot;</span>).<span class="title function_">hide</span>();</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">&#125;)</span><br><span class="line"></span><br><span class="line"><span class="comment">/*******************/</span></span><br><span class="line"><span class="comment">/*****初始化灯光******/</span></span><br><span class="line"><span class="comment">/*******************/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//初始化环境灯光 营造更好地灯光效果</span></span><br><span class="line"><span class="keyword">var</span> ambientLight = <span class="title function_">getLight</span>(<span class="string">&#x27;ambient&#x27;</span>,<span class="number">1</span>,<span class="number">0xFFFFFF</span>);</span><br><span class="line"><span class="comment">//var ambientLight = new THREE.AmbientLight(0xFFFFFF, 1);</span></span><br><span class="line"><span class="comment">//ambientLight.position.set( 3, 1, 10 );</span></span><br><span class="line">scene.<span class="title function_">add</span>(ambientLight);</span><br><span class="line"></span><br><span class="line"><span class="comment">//创建平行光 </span></span><br><span class="line"><span class="keyword">var</span> directionalLight = <span class="title function_">getLight</span>(<span class="string">&#x27;directional&#x27;</span>,<span class="number">.7</span>,<span class="number">0xFFFFFF</span>);</span><br><span class="line">directionalLight.<span class="property">position</span>.<span class="title function_">set</span>( <span class="number">3</span>, <span class="number">1</span>, <span class="number">10</span> );</span><br><span class="line"><span class="comment">//scene.add(directionalLight);</span></span><br><span class="line"><span class="keyword">var</span> helper = <span class="keyword">new</span> <span class="variable constant_">THREE</span>.<span class="title class_">DirectionalLightHelper</span>( directionalLight, <span class="number">5</span> );</span><br><span class="line">scene.<span class="title function_">add</span>(helper);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> rimLight = <span class="title function_">getLight</span>(<span class="string">&#x27;directional&#x27;</span>,<span class="number">0.5</span>,<span class="number">0xFFFFFF</span>);</span><br><span class="line">rimLight.<span class="property">position</span>.<span class="title function_">set</span>( <span class="number">0</span>, <span class="number">0</span>, -<span class="number">20</span> );</span><br><span class="line"><span class="comment">//scene.add(rimLight);</span></span><br><span class="line"><span class="keyword">var</span> rimhelper = <span class="keyword">new</span> <span class="variable constant_">THREE</span>.<span class="title class_">DirectionalLightHelper</span>( rimLight, <span class="number">5</span> );</span><br><span class="line">scene.<span class="title function_">add</span>(rimhelper);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> fillLight = <span class="title function_">getLight</span>(<span class="string">&#x27;directional&#x27;</span>,<span class="number">0.3</span>,<span class="number">0xFFFFFF</span>);</span><br><span class="line">fillLight.<span class="property">position</span>.<span class="title function_">set</span>( <span class="number">3</span>, <span class="number">1</span>, <span class="number">10</span> );</span><br><span class="line"><span class="comment">//scene.add(fillLight);</span></span><br><span class="line"><span class="keyword">var</span> fillhelper = <span class="keyword">new</span> <span class="variable constant_">THREE</span>.<span class="title class_">DirectionalLightHelper</span>( fillLight, <span class="number">5</span> );</span><br><span class="line">scene.<span class="title function_">add</span>(fillhelper);</span><br><span class="line"></span><br><span class="line">rimLight.<span class="property">castShadow</span>  =<span class="literal">false</span> ;<span class="comment">//关闭投射阴影的功能</span></span><br><span class="line">fillLight.<span class="property">castShadow</span> = <span class="literal">false</span> ;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> threeLightState = <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">toggleThreeLight</span>(<span class="params"></span>)&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span>(threeLightState)&#123;</span><br><span class="line">        scene.<span class="title function_">add</span>(directionalLight);</span><br><span class="line">        scene.<span class="title function_">add</span>(rimLight);</span><br><span class="line">        scene.<span class="title function_">add</span>(fillLight);</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">       scene.<span class="title function_">remove</span>(directionalLight);</span><br><span class="line">        scene.<span class="title function_">remove</span>(rimLight);</span><br><span class="line">        scene.<span class="title function_">remove</span>(fillLight); </span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//加载默认的白蓝色的背景</span></span><br><span class="line">scene.<span class="property">background</span> = <span class="keyword">new</span> <span class="variable constant_">THREE</span>.<span class="title class_">Color</span>( <span class="number">0xF0FFFF</span> );</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/*********/</span>                        </span><br><span class="line"><span class="comment">/*函数封装*/</span></span><br><span class="line"><span class="comment">/********/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//加载环境环境贴图cubemap</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getEnvMap</span>(<span class="params">path , format , fileNames</span>)&#123;</span><br><span class="line"><span class="comment">//加载样式</span></span><br><span class="line"><span class="comment">//var path = &#x27;../../js/three.js-master/examples/textures/cube/skyboxsun25deg/&#x27;;</span></span><br><span class="line"><span class="comment">//var format = &#x27;.jpg&#x27;;</span></span><br><span class="line"><span class="comment">//var fileNames = [&#x27;px&#x27;, &#x27;nx&#x27;, &#x27;py&#x27;, &#x27;ny&#x27;, &#x27;pz&#x27;, &#x27;nz&#x27;];</span></span><br><span class="line">    <span class="comment">//如果参数没有定义设置初值 </span></span><br><span class="line">    path= path === <span class="literal">undefined</span> ? <span class="string">&#x27;http://webgl.suiyuankj.com/js/three.js-master/examples/textures/cube/skyboxsun25deg/&#x27;</span> : path;</span><br><span class="line">    format= format === <span class="literal">undefined</span> ? <span class="string">&#x27;.jpg&#x27;</span> : format;</span><br><span class="line">    fileNames= fileNames === <span class="literal">undefined</span> ? [<span class="string">&#x27;px&#x27;</span>, <span class="string">&#x27;nx&#x27;</span>, <span class="string">&#x27;py&#x27;</span>, <span class="string">&#x27;ny&#x27;</span>, <span class="string">&#x27;pz&#x27;</span>, <span class="string">&#x27;nz&#x27;</span>] : format;</span><br><span class="line">	<span class="keyword">var</span> reflectionCube = <span class="keyword">new</span> <span class="variable constant_">THREE</span>.<span class="title class_">CubeTextureLoader</span>(manager).<span class="title function_">load</span>(fileNames.<span class="title function_">map</span>(<span class="keyword">function</span>(<span class="params">fileName</span>) &#123;</span><br><span class="line">		<span class="keyword">return</span> path + fileName + format;</span><br><span class="line">	&#125;));</span><br><span class="line">    <span class="keyword">return</span> reflectionCube;</span><br><span class="line">    <span class="comment">//这里参考lynda教程的写法</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//材质函数封装</span></span><br><span class="line"><span class="comment">//这个是获取材质阴影的一种奇葩的方法，因为没法解决，所以用这种荒唐的做法修正材质无法投射阴影的问题</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">shadowMaterial</span>(<span class="params">selectedMaterial,castShadow,receiveShadow</span>)&#123;</span><br><span class="line">    <span class="keyword">var</span> cube_obj = <span class="keyword">new</span> <span class="variable constant_">THREE</span>.<span class="title class_">BoxGeometry</span>( <span class="number">0.001</span>, <span class="number">0.001</span>,<span class="number">0.001</span> );</span><br><span class="line">    <span class="keyword">var</span> cube2 = <span class="keyword">new</span> <span class="variable constant_">THREE</span>.<span class="title class_">Mesh</span>( cube_obj, selectedMaterial );</span><br><span class="line">    cube2.<span class="property">castShadow</span> = castShadow;</span><br><span class="line">    cube2.<span class="property">receiveShadow</span> = receiveShadow;</span><br><span class="line">    scene.<span class="title function_">add</span>( cube2 );</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getMaterial</span>(<span class="params">type,color,shadow,castShadow,receiveShadow</span>) &#123;</span><br><span class="line">	<span class="keyword">var</span> selectedMaterial;</span><br><span class="line">    shadow = shadow === <span class="literal">undefined</span> ? <span class="literal">true</span> : shadow;</span><br><span class="line">    castShadow = castShadow === <span class="literal">undefined</span> ? <span class="literal">true</span> : castShadow;</span><br><span class="line">    receiveShadow = receiveShadow === <span class="literal">undefined</span> ? <span class="literal">true</span> : receiveShadow;</span><br><span class="line">	<span class="keyword">var</span> materialOptions = &#123;</span><br><span class="line"> </span><br><span class="line">		<span class="attr">color</span>: color === <span class="literal">undefined</span> ? <span class="string">&#x27;rgb(255, 255, 255)&#x27;</span> : color,</span><br><span class="line">        <span class="attr">side</span>: <span class="variable constant_">THREE</span>.<span class="property">DoubleSide</span></span><br><span class="line">	&#125;;<span class="comment">//这里如果color没有定义直接定义为纯白，否则就color的值</span></span><br><span class="line">    </span><br><span class="line">    <span class="comment">//下面是threejs内置的常用材质，可以加载第三方js来扩展材质</span></span><br><span class="line">	<span class="keyword">switch</span> (type) &#123;</span><br><span class="line">		<span class="keyword">case</span> <span class="string">&#x27;basic&#x27;</span>:</span><br><span class="line">			selectedMaterial = <span class="keyword">new</span> <span class="variable constant_">THREE</span>.<span class="title class_">MeshBasicMaterial</span>(materialOptions);</span><br><span class="line">			<span class="keyword">break</span>;<span class="comment">//这个材质等同于Maya中的surface表面材质，不受灯光影响</span></span><br><span class="line">		<span class="keyword">case</span> <span class="string">&#x27;lambert&#x27;</span>:</span><br><span class="line">			selectedMaterial = <span class="keyword">new</span> <span class="variable constant_">THREE</span>.<span class="title class_">MeshLambertMaterial</span>(materialOptions);</span><br><span class="line">            <span class="keyword">if</span>(shadow)&#123;</span><br><span class="line">                <span class="title function_">shadowMaterial</span>(selectedMaterial,castShadow,receiveShadow);</span><br><span class="line">            &#125;</span><br><span class="line">			<span class="keyword">break</span>;<span class="comment">//这个材质等同于Maya中的lambert材质</span></span><br><span class="line">		<span class="keyword">case</span> <span class="string">&#x27;phong&#x27;</span>:</span><br><span class="line">			selectedMaterial = <span class="keyword">new</span> <span class="variable constant_">THREE</span>.<span class="title class_">MeshPhongMaterial</span>(materialOptions);</span><br><span class="line">            <span class="keyword">if</span>(shadow)&#123;</span><br><span class="line">                <span class="title function_">shadowMaterial</span>(selectedMaterial,castShadow,receiveShadow);</span><br><span class="line">            &#125;</span><br><span class="line">			<span class="keyword">break</span>;<span class="comment">//这个材质等同于Maya中的phong材质</span></span><br><span class="line">		<span class="keyword">case</span> <span class="string">&#x27;standard&#x27;</span>:</span><br><span class="line">			selectedMaterial = <span class="keyword">new</span> <span class="variable constant_">THREE</span>.<span class="title class_">MeshStandardMaterial</span>(materialOptions);</span><br><span class="line">            <span class="keyword">if</span>(shadow)&#123;</span><br><span class="line">                <span class="title function_">shadowMaterial</span>(selectedMaterial,castShadow,receiveShadow);</span><br><span class="line">            &#125;</span><br><span class="line">			<span class="keyword">break</span>;<span class="comment">//这个材质等同于unity的standrad材质，这个材质支持的功能相对较多，性能消耗最厉害</span></span><br><span class="line">		<span class="attr">default</span>: </span><br><span class="line">			selectedMaterial = <span class="keyword">new</span> <span class="variable constant_">THREE</span>.<span class="title class_">MeshBasicMaterial</span>(materialOptions);</span><br><span class="line">			<span class="keyword">break</span>;<span class="comment">//默认是basic材质</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">	<span class="keyword">return</span> selectedMaterial;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//获取灯光函数的封装</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getLight</span>(<span class="params">type,intensity, color, distant</span>) &#123;</span><br><span class="line">    <span class="keyword">var</span> light_check = <span class="literal">true</span>;</span><br><span class="line">	color = color === <span class="literal">undefined</span> ? <span class="string">&#x27;rgb(255, 255, 255)&#x27;</span> : color;<span class="comment">//设置颜色，与材质的相同</span></span><br><span class="line">    distant = distant === <span class="literal">undefined</span> ? <span class="number">50</span> : distant;<span class="comment">//设置点光源初始值为50</span></span><br><span class="line">    <span class="keyword">switch</span> (type) &#123;</span><br><span class="line">		<span class="keyword">case</span> <span class="string">&#x27;spot&#x27;</span>:</span><br><span class="line">			<span class="keyword">var</span> light = <span class="keyword">new</span> <span class="variable constant_">THREE</span>.<span class="title class_">SpotLight</span>(color, intensity);</span><br><span class="line">			<span class="keyword">break</span>;<span class="comment">//创建聚光灯</span></span><br><span class="line">		<span class="keyword">case</span> <span class="string">&#x27;point&#x27;</span>:</span><br><span class="line">			<span class="keyword">var</span> light = <span class="keyword">new</span> <span class="variable constant_">THREE</span>.<span class="title class_">PointLight</span>(color, intensity ,distant);</span><br><span class="line">			<span class="keyword">break</span>;<span class="comment">//创建点光源</span></span><br><span class="line">		<span class="keyword">case</span> <span class="string">&#x27;directional&#x27;</span>:</span><br><span class="line">			<span class="keyword">var</span> light = <span class="keyword">new</span> <span class="variable constant_">THREE</span>.<span class="title class_">DirectionalLight</span>(color, intensity);</span><br><span class="line">			<span class="keyword">break</span>;<span class="comment">//创建平行光</span></span><br><span class="line">		<span class="keyword">case</span> <span class="string">&#x27;ambient&#x27;</span>:</span><br><span class="line">			<span class="keyword">var</span> light = <span class="keyword">new</span> <span class="variable constant_">THREE</span>.<span class="title class_">AmbientLight</span>(color, intensity);</span><br><span class="line">            light_check = <span class="literal">false</span>;</span><br><span class="line">			<span class="keyword">break</span>;<span class="comment">//创建环境光</span></span><br><span class="line">		<span class="attr">default</span>: </span><br><span class="line">			<span class="keyword">var</span> light = <span class="keyword">new</span> <span class="variable constant_">THREE</span>.<span class="title class_">PointLight</span>(color, intensity);</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">	<span class="comment">//设置深度贴图的大小以及偏差值</span></span><br><span class="line">    <span class="keyword">if</span>(light_check)&#123;</span><br><span class="line">        light.<span class="property">penumbra</span> = <span class="number">0.5</span>;<span class="comment">//使灯光边缘柔化</span></span><br><span class="line">        light.<span class="property">castShadow</span> = <span class="literal">true</span>;<span class="comment">//开启阴影</span></span><br><span class="line">        light.<span class="property">shadow</span>.<span class="property">mapSize</span>.<span class="property">width</span> = <span class="number">1024</span>;<span class="comment">//设置深度贴图的大小</span></span><br><span class="line">        light.<span class="property">shadow</span>.<span class="property">mapSize</span>.<span class="property">height</span> = <span class="number">1024</span>;</span><br><span class="line">        light.<span class="property">shadow</span>.<span class="property">bias</span> = <span class="number">0.001</span>; <span class="comment">//设置阴影偏差值</span></span><br><span class="line">    &#125;</span><br><span class="line">	<span class="keyword">return</span> light;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//导入manager</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//进度条预加载 需要ProgressBar.js的支持 代码复制自官方</span></span><br><span class="line"><span class="keyword">var</span> bar = <span class="keyword">new</span> <span class="title class_">ProgressBar</span>.<span class="title class_">Line</span>(container, &#123; </span><br><span class="line">      <span class="attr">strokeWidth</span>: <span class="number">4</span>,</span><br><span class="line">      <span class="attr">easing</span>: <span class="string">&#x27;easeInOut&#x27;</span>,</span><br><span class="line">      <span class="attr">duration</span>: <span class="number">1000</span>,</span><br><span class="line">      <span class="attr">color</span>: <span class="string">&#x27;#FFEA82&#x27;</span>,</span><br><span class="line">      <span class="attr">trailColor</span>: <span class="string">&#x27;#eee&#x27;</span>,</span><br><span class="line">      <span class="attr">trailWidth</span>: <span class="number">1</span>,</span><br><span class="line">      <span class="attr">svgStyle</span>: &#123;<span class="attr">width</span>: <span class="string">&#x27;100%&#x27;</span>, <span class="attr">height</span>: <span class="string">&#x27;50%&#x27;</span>&#125;,</span><br><span class="line">      <span class="attr">text</span>: &#123;</span><br><span class="line">        <span class="attr">style</span>: &#123;</span><br><span class="line">          <span class="attr">color</span>: <span class="string">&#x27;#eee&#x27;</span>,</span><br><span class="line">          <span class="attr">position</span>: <span class="string">&#x27;absolute&#x27;</span>,</span><br><span class="line">          <span class="attr">right</span>: <span class="string">&#x27;45%&#x27;</span>,</span><br><span class="line">          <span class="attr">top</span>: <span class="string">&#x27;75%&#x27;</span>,</span><br><span class="line">          <span class="attr">padding</span>: <span class="string">&#x27;5px&#x27;</span>,</span><br><span class="line">          <span class="attr">margin</span>: <span class="number">0</span>,</span><br><span class="line">          <span class="attr">transform</span>: <span class="literal">null</span></span><br><span class="line">        &#125;,</span><br><span class="line">        <span class="attr">autoStyleContainer</span>: <span class="literal">false</span></span><br><span class="line">      &#125;,</span><br><span class="line">      <span class="attr">from</span>: &#123;<span class="attr">color</span>: <span class="string">&#x27;#FFEA82&#x27;</span>&#125;,</span><br><span class="line">      <span class="attr">to</span>: &#123;<span class="attr">color</span>: <span class="string">&#x27;#1d815e&#x27;</span>&#125;,</span><br><span class="line">      <span class="attr">step</span>: <span class="function">(<span class="params">state, bar</span>) =&gt;</span> &#123;</span><br><span class="line">        bar.<span class="property">path</span>.<span class="title function_">setAttribute</span>(<span class="string">&#x27;stroke&#x27;</span>, state.<span class="property">color</span>);</span><br><span class="line">        bar.<span class="title function_">setText</span>(<span class="title class_">Math</span>.<span class="title function_">round</span>(bar.<span class="title function_">value</span>() * <span class="number">100</span>) + <span class="string">&#x27; %&#x27;</span>);</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> manager = <span class="keyword">new</span> <span class="variable constant_">THREE</span>.<span class="title class_">LoadingManager</span>();  </span><br><span class="line"></span><br><span class="line">manager.<span class="property">onStart</span> = <span class="keyword">function</span> (<span class="params"> url, itemsLoaded, itemsTotal </span>) &#123;</span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>( <span class="string">&#x27;Started loading file: &#x27;</span> + url + <span class="string">&#x27;.\nLoaded &#x27;</span> + itemsLoaded + <span class="string">&#x27; of &#x27;</span> + itemsTotal + <span class="string">&#x27; files.&#x27;</span> );</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">manager.<span class="property">onLoad</span> = <span class="keyword">function</span> (<span class="params"> </span>) &#123;</span><br><span class="line">    <span class="comment">//添加logo 眼睛</span></span><br><span class="line"><span class="built_in">setTimeout</span>(<span class="string">&quot;    $(&#x27;#logo&#x27;).append(\&quot;&lt;svg id=&#x27;svg_fill&#x27; style=&#x27;position: absolute;left:0px;&#x27; xmlns=&#x27;http://www.w3.org/2000/svg&#x27; viewBox=&#x27;0 0 600 400&#x27; &gt;&lt;defs&gt;&lt;style&gt;.a&#123;fill:none;&#125;.b&#123;fill:#1d815e;&#125;.c&#123;fill:#3ea251;&#125;&lt;/style&gt;&lt;/defs&gt; &lt;ellipse class=&#x27;c&#x27; cx=&#x27;127.2&#x27; cy=&#x27;50.5&#x27; rx=&#x27;15.2&#x27; ry=&#x27;15.5&#x27;/&gt; &lt;path class=&#x27;b&#x27; d=&#x27;M354.1,298.4m85.8-14.3a54.6,54.6,0,0,1-16.6,4.3,57.8,57.8,0,0,1-9.7.1,55.7,55.7,0,0,1-9.6-1.5,58.6,58.6,0,0,1-12.1-4.5,56.9,56.9,0,0,1-15.7-12,63.5,63.5,0,0,1-5.4-6.9c-2.1-3.1-3.2-5.6-3.6-6.2a8.2,8.2,0,0,0-3.6-3.5,8.1,8.1,0,0,0-10.8,3.7,8,8,0,0,0,.1,7.2,69.8,69.8,0,0,0,4,7.1c2.2,3.3,4.9,6.7,5.5,7.4a72.6,72.6,0,0,0,11.6,11,71.5,71.5,0,0,0,14.4,8.5,75.6,75.6,0,0,0,13.9,4.5c1.9.4,4.6.9,6.3,1.1s6.8.6,8.3.6a77.5,77.5,0,0,0,17.6-1.9,72.5,72.5,0,0,0,17.4-6.6c1.7-.9,4.6-2.7,6.3-3.8a95.2,95.2,0,0,0,8.5-6.7,106,106,0,0,0,8.3-8.9,62.9,62.9,0,0,0,4.9-7.2c.9-1.4,2.4-4.4,3.6-6.8a74.6,74.6,0,0,0,4-10.8,76.1,76.1,0,0,0,2.3-12c.1-1.7.4-5.7.4-8.3s-.3-5.7-.3-5.8a74.8,74.8,0,0,0-3.1-15.2,81.1,81.1,0,0,0-4.1-10.2,8.2,8.2,0,0,0-12.5-2.6,8.3,8.3,0,0,0-2.4,3.5,8.3,8.3,0,0,0,.1,5.8,52.5,52.5,0,0,1,3.5,8.4c.6,2,1.2,4.3,1.4,5.2a23,23,0,0,1,.3,3.3,5.5,5.5,0,0,1-3.3,4.2c-2,.8-3.9.6-6.8-1-7.5-4.3-16.7-4.8-21.3-4.8-7.6-.1-16.8,3.4-21.9,5.6-13.5,5.9-15.7,8.3-23.9,8.3a25.5,25.5,0,0,1-18.1-7.8,25.2,25.2,0,0,1-7-15.8,24.1,24.1,0,0,1,1.5-10.7,25.7,25.7,0,0,1,3.8-6.8c1.6-2.1,3.9-4.2,8.1-7.5a61.1,61.1,0,0,1,12.6-7.1,54,54,0,0,1,12.7-3.5,65.6,65.6,0,0,1,15-.1,58.2,58.2,0,0,1,15.4,4.1,52.8,52.8,0,0,1,8.8,4.7c2.1,1.4,3.6,2.6,5.9,4.4a8.4,8.4,0,0,0,8.6.1,7.8,7.8,0,0,0,3.6-4.8,8.2,8.2,0,0,0-2.9-8.7l-3.8-2.9a77.9,77.9,0,0,0-7.1-4.5,72.4,72.4,0,0,0-9.1-4.3,70.7,70.7,0,0,0-19.3-4.5,73.8,73.8,0,0,0-15.9.3,69,69,0,0,0-14.7,3.5,57.7,57.7,0,0,0-8.9,3.9,51.2,51.2,0,0,0-8.1,4.8,63.7,63.7,0,0,0-14.1,13.1,40.9,40.9,0,0,0-6.5,13,38.7,38.7,0,0,0-1.7,10.7,43,43,0,0,0,2.6,15.6,42.2,42.2,0,0,0,9,14.1,43.7,43.7,0,0,0,13.4,9.3c8.3,3.5,13.6,3.3,18.3,3.4,12.1-.9,15-4.6,28-9.7s21.1-3.5,26.5-1.8,9.6,3.2,12.2,9.4a13.9,13.9,0,0,1,.8,5.2,33.2,33.2,0,0,1-1,6,24.6,24.6,0,0,1-3.3,7,22.7,22.7,0,0,1-2.1,2.8l-1.9,2c-.8.8-5.5,4.5-6.2,5.1C447.7,280.4,442.5,283,439.9,284.1Z&#x27; transform=&#x27;translate(-268.6 -160.1)&#x27;/&gt;\&quot;);&quot;</span>,<span class="number">1000</span>);</span><br><span class="line">    <span class="comment">//使加载图标消失</span></span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="string">&quot;$(&#x27;#logo&#x27;).fadeToggle(2000);&quot;</span>,<span class="number">1000</span>) ;</span><br><span class="line">    <span class="comment">//删除加载进度条</span></span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="string">&quot;bar.destroy();&quot;</span>,<span class="number">4000</span>);</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="string">&quot;$(&#x27;bar_Su&#x27;).remove();&quot;</span>,<span class="number">4000</span>);</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="string">&quot;$(&#x27;bar_S&#x27;).remove();&quot;</span>,<span class="number">4000</span>);</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="string">&quot;$(&#x27;bar_i_upper&#x27;).remove();&quot;</span>,<span class="number">4000</span>);</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="string">&quot;$(&#x27;bar_i_lower&#x27;).remove();&quot;</span>,<span class="number">4000</span>);</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="string">&quot;$(&#x27;bar_Yu&#x27;).remove();&quot;</span>,<span class="number">4000</span>);</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="string">&quot;$(&#x27;bar_an&#x27;).remove();&quot;</span>,<span class="number">4000</span>);</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="string">&quot;camera_check = true;&quot;</span>,<span class="number">2500</span>) ;</span><br><span class="line">    <span class="comment">//关闭镜头模糊</span></span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="string">&quot;postprocessing.enabled = false;&quot;</span>,<span class="number">2500</span>) ;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span>(camera_orbitControl_check==<span class="literal">false</span>)&#123;</span><br><span class="line">      <span class="built_in">setTimeout</span>(<span class="string">&quot;camera_pointerLockControl_block();&quot;</span>,<span class="number">2500</span>);  </span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="string">&quot;if(isMobile.any)&#123;full_screen_fun();&#125;&quot;</span>,<span class="number">2500</span>) ;</span><br><span class="line">        </span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>( <span class="string">&#x27;Loading complete!&#x27;</span>);</span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">manager.<span class="property">onProgress</span> = <span class="keyword">function</span> (<span class="params"> url, itemsLoaded, itemsTotal </span>) &#123;</span><br><span class="line"></span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line">       <span class="comment">/* var bar_dot = new ProgressBar.Path(&#x27;#dot&#x27;, &#123;</span></span><br><span class="line"><span class="comment">          easing: &#x27;easeInOut&#x27;,</span></span><br><span class="line"><span class="comment">          duration: 1000</span></span><br><span class="line"><span class="comment">        &#125;);</span></span><br><span class="line"><span class="comment">        bar_dot.set(0);</span></span><br><span class="line"><span class="comment">        bar_dot.animate(itemsLoaded/itemsTotal); */</span></span><br><span class="line">    </span><br><span class="line">    bar.<span class="title function_">animate</span>(itemsLoaded/itemsTotal); </span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="string">&quot;bar_path_Su.animate(1);&quot;</span>,<span class="number">100</span>);</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="string">&quot;bar_path_S.animate(1);  &quot;</span>,<span class="number">100</span>);</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="string">&quot;bar_path_i_upper.animate(1);&quot;</span>,<span class="number">100</span>);</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="string">&quot;bar_path_i_lower.animate(1); &quot;</span>,<span class="number">100</span>);</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="string">&quot;bar_path_Y.animate(1); &quot;</span>,<span class="number">100</span>);</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="string">&quot;bar_path_Yu.animate(1); &quot;</span>,<span class="number">100</span>);</span><br><span class="line">    <span class="built_in">setTimeout</span>(<span class="string">&quot;bar_path_an.animate(1);&quot;</span>,<span class="number">100</span>);</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>( <span class="string">&#x27;Loading file: &#x27;</span> + url + <span class="string">&#x27;.\nLoaded &#x27;</span> + itemsLoaded + <span class="string">&#x27; of &#x27;</span> + itemsTotal + <span class="string">&#x27; files.&#x27;</span> );</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line">manager.<span class="property">onError</span> = <span class="keyword">function</span> (<span class="params"> url </span>) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">console</span>.<span class="title function_">log</span>( <span class="string">&#x27;There was an error loading &#x27;</span> + url );</span><br><span class="line"></span><br><span class="line">&#125;;</span><br><span class="line"></span><br><span class="line"><span class="comment">//导入模型的封装函数</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getModel</span>(<span class="params">modelPath,mtl</span>)&#123;</span><br><span class="line">    </span><br><span class="line"><span class="comment">//获取加载文件的后缀名</span></span><br><span class="line"><span class="keyword">var</span> arr=modelPath.<span class="title function_">split</span>(<span class="string">&#x27;.&#x27;</span>);<span class="comment">//通过点将路径字符串切分</span></span><br><span class="line">    </span><br><span class="line"><span class="keyword">var</span> format = arr[arr.<span class="property">length</span>-<span class="number">1</span>];<span class="comment">// 那么后缀名就是数组最后一个元素</span></span><br><span class="line">    <span class="keyword">switch</span>(format)&#123;</span><br><span class="line">        <span class="comment">//通过switch匹配后缀名</span></span><br><span class="line">        <span class="comment">//这里采用正则表达式进行后缀名匹配，忽略后缀名的大小写 </span></span><br><span class="line">        <span class="keyword">case</span> (format.<span class="title function_">match</span>(<span class="regexp">/obj$/i</span>)||&#123;&#125;).<span class="property">input</span>:</span><br><span class="line">            </span><br><span class="line">            <span class="comment">/*****************************/</span></span><br><span class="line">            <span class="comment">/*********识别Obj加载**********/</span></span><br><span class="line">            <span class="comment">/****************************/</span></span><br><span class="line">           </span><br><span class="line">        <span class="comment">//这里本来使用下面这个函数缩减代码量的，但是这样参数传递会导致未知的错误。</span></span><br><span class="line">        <span class="comment">//getObjModel(modelPath,mtl); </span></span><br><span class="line">        <span class="comment">//为了稳定，我将代码从function里面拆了出来</span></span><br><span class="line">        <span class="comment">//这些函数并没有删除，提供更多的加载选择。</span></span><br><span class="line">        <span class="comment">//注意OBJ加载函数是背景模型加载专用的，加载OBJ要使用这个函数</span></span><br><span class="line">        </span><br><span class="line">        <span class="keyword">var</span> loader = <span class="keyword">new</span> <span class="variable constant_">THREE</span>.<span class="title class_">OBJLoader</span>(manager);<span class="comment">//加载Obj加载器，需要OBJLoader.js的支持</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> model = <span class="keyword">new</span> <span class="variable constant_">THREE</span>.<span class="title class_">Group</span>();<span class="comment">//设置模型的大组，后面会return到外面</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> <span class="title class_">GeoY</span> = <span class="keyword">new</span> <span class="title class_">Array</span>();<span class="comment">//这个function内部的全局变量，用来储存模型各个部分的最低点</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">//传入的参数如果是字符串 说明是路径 则加载mtlLoader 导入mtl文件</span></span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_">typeof</span>(mtl) == <span class="string">&#x27;string&#x27;</span>)&#123;</span><br><span class="line">            <span class="comment">//mtl为mtl文件路径 例如：&#x27;obj/bed.mtl&#x27;</span></span><br><span class="line">            <span class="keyword">var</span> arr=mtl.<span class="title function_">split</span>(<span class="string">&#x27;/&#x27;</span>);<span class="comment">//按照/切割路径</span></span><br><span class="line">            <span class="keyword">var</span> mtl_file = arr[arr.<span class="property">length</span>-<span class="number">1</span>];<span class="comment">//获取路径中最后一个元素 即‘bed.mtl’</span></span><br><span class="line">            <span class="keyword">var</span> arr = mtl.<span class="title function_">split</span>(mtl_file);<span class="comment">//按照最后一个元素切割路径 获取mtl文件之前的文件夹 即‘obj/’</span></span><br><span class="line">            <span class="keyword">var</span> mtl_folder = arr[<span class="number">0</span>];</span><br><span class="line"></span><br><span class="line">            <span class="variable constant_">THREE</span>.<span class="property">Loader</span>.<span class="property">Handlers</span>.<span class="title function_">add</span>( <span class="regexp">/\.dds$/i</span>, <span class="keyword">new</span> <span class="variable constant_">THREE</span>.<span class="title class_">DDSLoader</span>(manager) );<span class="comment">//用于dds贴图的加载</span></span><br><span class="line">            <span class="keyword">var</span> mtlLoader = <span class="keyword">new</span> <span class="variable constant_">THREE</span>.<span class="title class_">MTLLoader</span>(manager);<span class="comment">//需要MTLLoader.js的支持</span></span><br><span class="line">            mtlLoader.<span class="title function_">setPath</span>( mtl_folder );<span class="comment">//将mtl的文件夹路径设置进去</span></span><br><span class="line">            <span class="comment">//设置mtl文件传入的材质的部分属性 这里添加双面材质及重复贴图的处理</span></span><br><span class="line">            mtlLoader.<span class="title function_">setMaterialOptions</span>( &#123;<span class="attr">side</span>:<span class="variable constant_">THREE</span>.<span class="property">DoubleSide</span>,<span class="attr">wrap</span>:<span class="variable constant_">THREE</span>.<span class="property">MirroredRepeatWrapping</span> &#125; );</span><br><span class="line">            <span class="comment">//加载mtl</span></span><br><span class="line">            <span class="comment">//输入传入的路径</span></span><br><span class="line">            mtlLoader.<span class="title function_">load</span>( mtl_file, <span class="keyword">function</span>(<span class="params"> materials </span>) &#123;</span><br><span class="line">            materials.<span class="title function_">preload</span>();<span class="comment">//这行代码官方有，但是不知道有什么作用，去掉也无影响。</span></span><br><span class="line">            loader.<span class="title function_">setMaterials</span>( materials );<span class="comment">//设置Obj的材质为mtl带有的材质</span></span><br><span class="line">            <span class="comment">//加载Obj文件</span></span><br><span class="line">            loader.<span class="title function_">load</span>( modelPath, <span class="keyword">function</span> (<span class="params"> object </span>) &#123;</span><br><span class="line">               object.<span class="title function_">traverse</span>(<span class="keyword">function</span>(<span class="params">child</span>) &#123;</span><br><span class="line">                   <span class="comment">//设置所有的子对象都可以投射和接受阴影</span></span><br><span class="line">                    child.<span class="property">castShadow</span> = <span class="literal">true</span>;</span><br><span class="line">                    child.<span class="property">receiveShadow</span> = <span class="literal">true</span>;</span><br><span class="line">                   objects.<span class="title function_">push</span>( child );</span><br><span class="line">                    </span><br><span class="line">            &#125; ); <span class="comment">//完成OBJ文件的加载      </span></span><br><span class="line">            <span class="comment">//将模型添加到model组里面</span></span><br><span class="line">            model.<span class="title function_">add</span>( object );  </span><br><span class="line">            backgroundY = backgroundY ===<span class="literal">undefined</span> ? <span class="number">0</span> :backgroundY;<span class="comment">//设置初值</span></span><br><span class="line">            <span class="comment">//让模型导入就到背景模型上</span></span><br><span class="line">            model.<span class="property">position</span>.<span class="property">y</span> += backgroundY;</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//传入的参数如果是材质（object）则直接赋到模型上</span></span><br><span class="line">         <span class="keyword">if</span>(<span class="title function_">typeof</span>(mtl) == <span class="string">&#x27;object&#x27;</span>)&#123;</span><br><span class="line">             loader.<span class="title function_">load</span>(modelPath, <span class="keyword">function</span> (<span class="params">object</span>) &#123;</span><br><span class="line">                 <span class="comment">//这里使用的方法与上面调用基本相同</span></span><br><span class="line">            object.<span class="title function_">traverse</span>(<span class="keyword">function</span>(<span class="params">child</span>) &#123;</span><br><span class="line">                    child.<span class="property">material</span> = mtl;</span><br><span class="line">                    child.<span class="property">castShadow</span> = <span class="literal">true</span>;</span><br><span class="line">                    child.<span class="property">recieveShadow</span> = <span class="literal">true</span>;</span><br><span class="line">                    objects.<span class="title function_">push</span>( child );</span><br><span class="line"></span><br><span class="line">            &#125; );       </span><br><span class="line">                <span class="comment">//添加模型</span></span><br><span class="line">                model.<span class="title function_">add</span>( object ); </span><br><span class="line">                </span><br><span class="line">                backgroundY = backgroundY ===<span class="literal">undefined</span> ? <span class="number">0</span> :backgroundY;</span><br><span class="line">                model.<span class="property">position</span>.<span class="property">y</span> += backgroundY;</span><br><span class="line">            &#125;);</span><br><span class="line">         &#125;   </span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> model;<span class="comment">//返回模型</span></span><br><span class="line">            </span><br><span class="line">            </span><br><span class="line">        <span class="keyword">break</span>;<span class="comment">//结束OBJ的导入</span></span><br><span class="line">            </span><br><span class="line">            </span><br><span class="line">            </span><br><span class="line">        <span class="comment">//检测模型如果符合JSON的后缀名   </span></span><br><span class="line">        <span class="keyword">case</span> (format.<span class="title function_">match</span>(<span class="regexp">/json$/i</span>)||&#123;&#125;).<span class="property">input</span>:</span><br><span class="line">            </span><br><span class="line">            <span class="comment">/******************************/</span></span><br><span class="line">            <span class="comment">/*********识别Json加载**********/</span></span><br><span class="line">            <span class="comment">/*****************************/</span></span><br><span class="line">            </span><br><span class="line">        <span class="keyword">var</span> loader = <span class="keyword">new</span> <span class="variable constant_">THREE</span>.<span class="title class_">JSON</span>Loader(manager);<span class="comment">//加载JSON文件 只需要three.js的支持</span></span><br><span class="line">    </span><br><span class="line">        <span class="keyword">var</span> model = <span class="keyword">new</span> <span class="variable constant_">THREE</span>.<span class="title class_">Group</span>();</span><br><span class="line"></span><br><span class="line">        loader.<span class="title function_">load</span>( modelPath, <span class="keyword">function</span> (<span class="params"> geometry, materials </span>) &#123;</span><br><span class="line">            </span><br><span class="line">        <span class="keyword">var</span> mesh = <span class="keyword">new</span> <span class="variable constant_">THREE</span>.<span class="title class_">Mesh</span>( geometry, materials );<span class="comment">//将模型和材质添加到mesh中</span></span><br><span class="line">        </span><br><span class="line">        mesh.<span class="property">castShadow</span> = <span class="literal">true</span>;</span><br><span class="line">        mesh.<span class="property">recieveShadow</span> = <span class="literal">true</span>;</span><br><span class="line">        model.<span class="title function_">add</span>(mesh);<span class="comment">//添加到model组中</span></span><br><span class="line">        objects.<span class="title function_">push</span>( mesh );</span><br><span class="line">        backgroundY = backgroundY ===<span class="literal">undefined</span> ? <span class="number">0</span> :backgroundY;<span class="comment">//设置初值</span></span><br><span class="line">        </span><br><span class="line">        model.<span class="property">position</span>.<span class="property">y</span> += backgroundY;<span class="comment">//移动模型到地板上</span></span><br><span class="line">        </span><br><span class="line">        &#125; );</span><br><span class="line">        </span><br><span class="line">            <span class="comment">/********************************/</span></span><br><span class="line">            <span class="comment">/*********识别Object加载**********/</span></span><br><span class="line">            <span class="comment">/*******************************/</span></span><br><span class="line">            </span><br><span class="line">        <span class="keyword">var</span> <span class="title class_">ObjectLoader</span> = <span class="keyword">new</span> <span class="variable constant_">THREE</span>.<span class="title class_">ObjectLoader</span>(manager);</span><br><span class="line"></span><br><span class="line">        <span class="title class_">ObjectLoader</span>.<span class="title function_">load</span>(modelPath,<span class="keyword">function</span> (<span class="params"> obj </span>) &#123;</span><br><span class="line">            obj.<span class="property">castShadow</span> = <span class="literal">true</span>;</span><br><span class="line">            obj.<span class="property">recieveShadow</span> = <span class="literal">true</span>;</span><br><span class="line">            model.<span class="title function_">add</span>(obj);</span><br><span class="line">            objects.<span class="title function_">push</span>( obj );</span><br><span class="line">            backgroundY = backgroundY ===<span class="literal">undefined</span> ? <span class="number">0</span> :backgroundY;<span class="comment">//设置初值</span></span><br><span class="line">            model.<span class="property">position</span>.<span class="property">y</span> += backgroundY;<span class="comment">//移动模型到地板上</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        );</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> model;</span><br><span class="line">        <span class="keyword">break</span>;</span><br><span class="line">            </span><br><span class="line">            </span><br><span class="line"><span class="comment">//        default:</span></span><br><span class="line"><span class="comment">//        return model;</span></span><br><span class="line"><span class="comment">//        break;</span></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//导入Object的函数封装</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getObjectModel</span>(<span class="params">modelPath,mtl</span>)&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> <span class="title class_">ObjectLoader</span> = <span class="keyword">new</span> <span class="variable constant_">THREE</span>.<span class="title class_">ObjectLoader</span>(manager);</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> model = <span class="keyword">new</span> <span class="variable constant_">THREE</span>.<span class="title class_">Group</span>();</span><br><span class="line">    </span><br><span class="line">    <span class="title class_">ObjectLoader</span>.<span class="title function_">load</span>(modelPath,<span class="keyword">function</span> (<span class="params"> obj </span>) &#123;</span><br><span class="line">        obj.<span class="property">castShadow</span> = <span class="literal">true</span>;</span><br><span class="line">        obj.<span class="property">recieveShadow</span> = <span class="literal">true</span>;</span><br><span class="line">        model.<span class="title function_">add</span>(obj);</span><br><span class="line">        backgroundY = backgroundY ===<span class="literal">undefined</span> ? <span class="number">0</span> :backgroundY;<span class="comment">//设置初值</span></span><br><span class="line">        model.<span class="property">position</span>.<span class="property">y</span> += backgroundY;<span class="comment">//移动模型到地板上</span></span><br><span class="line">	&#125;</span><br><span class="line"></span><br><span class="line">    );</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">return</span> model;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//导入Json的函数封装</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getJsonModel</span>(<span class="params">modelPath,mtl</span>)&#123;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> loader = <span class="keyword">new</span> <span class="variable constant_">THREE</span>.<span class="title class_">JSON</span>Loader(manager);<span class="comment">//加载JSON文件 只需要three.js的支持</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">var</span> model = <span class="keyword">new</span> <span class="variable constant_">THREE</span>.<span class="title class_">Group</span>();</span><br><span class="line">    </span><br><span class="line">    loader.<span class="title function_">load</span>( modelPath, <span class="keyword">function</span> (<span class="params"> geometry, materials </span>) &#123;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//geometry.computeBoundingBox();  //获取模型的边界</span></span><br><span class="line">        </span><br><span class="line">          mtl = mtl === <span class="literal">undefined</span> ? materials :mtl;</span><br><span class="line">        <span class="keyword">var</span> mesh = <span class="keyword">new</span> <span class="variable constant_">THREE</span>.<span class="title class_">Mesh</span>( geometry, mtl );<span class="comment">//将模型和材质添加到mesh中</span></span><br><span class="line">        </span><br><span class="line">        mesh.<span class="property">castShadow</span> = <span class="literal">true</span>;</span><br><span class="line">        mesh.<span class="property">recieveShadow</span> = <span class="literal">true</span>;</span><br><span class="line">        model.<span class="title function_">add</span>(mesh);<span class="comment">//添加到model组中</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">//changePivot(0,min,0,model);//修改模型轴心点到最低点上</span></span><br><span class="line">        </span><br><span class="line">        backgroundY = backgroundY ===<span class="literal">undefined</span> ? <span class="number">0</span> :backgroundY;<span class="comment">//设置初值</span></span><br><span class="line">        model.<span class="property">position</span>.<span class="property">y</span> += backgroundY;<span class="comment">//移动模型到地板上</span></span><br><span class="line">        &#125; );</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">return</span> model;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//导入Obj的函数封装</span></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">getObjModel</span>(<span class="params">modelPath,mtl,colorMap,bumpMap</span>)&#123;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> loader = <span class="keyword">new</span> <span class="variable constant_">THREE</span>.<span class="title class_">OBJLoader</span>(manager);<span class="comment">//加载Obj加载器，需要OBJLoader.js的支持</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> model = <span class="keyword">new</span> <span class="variable constant_">THREE</span>.<span class="title class_">Group</span>();<span class="comment">//设置模型的大组，后面会return到外面</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">var</span> <span class="title class_">GeoY</span> = <span class="keyword">new</span> <span class="title class_">Array</span>();<span class="comment">//这个function内部的全局变量，用来储存模型各个部分的最低点</span></span><br><span class="line">        </span><br><span class="line">        <span class="comment">//传入的参数如果是字符串 说明是路径 则加载mtlLoader 导入mtl文件</span></span><br><span class="line">        <span class="keyword">if</span>(<span class="title function_">typeof</span>(mtl) == <span class="string">&#x27;string&#x27;</span>)&#123;</span><br><span class="line">            <span class="comment">//mtl为mtl文件路径 例如：&#x27;obj/bed.mtl&#x27;</span></span><br><span class="line">            <span class="keyword">var</span> arr=mtl.<span class="title function_">split</span>(<span class="string">&#x27;/&#x27;</span>);<span class="comment">//按照/切割路径</span></span><br><span class="line">            <span class="keyword">var</span> mtl_file = arr[arr.<span class="property">length</span>-<span class="number">1</span>];<span class="comment">//获取路径中最后一个元素 即‘bed.mtl’</span></span><br><span class="line">            <span class="keyword">var</span> arr = mtl.<span class="title function_">split</span>(mtl_file);<span class="comment">//按照最后一个元素切割路径 获取mtl文件之前的文件夹 即‘obj/’</span></span><br><span class="line">            <span class="keyword">var</span> mtl_folder = arr[<span class="number">0</span>];</span><br><span class="line"></span><br><span class="line">            <span class="variable constant_">THREE</span>.<span class="property">Loader</span>.<span class="property">Handlers</span>.<span class="title function_">add</span>( <span class="regexp">/\.dds$/i</span>, <span class="keyword">new</span> <span class="variable constant_">THREE</span>.<span class="title class_">DDSLoader</span>(manager) );<span class="comment">//用于dds贴图的加载</span></span><br><span class="line">            <span class="keyword">var</span> mtlLoader = <span class="keyword">new</span> <span class="variable constant_">THREE</span>.<span class="title class_">MTLLoader</span>(manager);<span class="comment">//需要MTLLoader.js的支持</span></span><br><span class="line">            mtlLoader.<span class="title function_">setPath</span>( mtl_folder );<span class="comment">//将mtl的文件夹路径设置进去</span></span><br><span class="line">            <span class="comment">//设置mtl文件传入的材质的部分属性 这里添加双面材质及重复贴图的处理</span></span><br><span class="line">            mtlLoader.<span class="title function_">setMaterialOptions</span>( &#123;<span class="attr">side</span>:<span class="variable constant_">THREE</span>.<span class="property">DoubleSide</span>,<span class="attr">wrap</span>:<span class="variable constant_">THREE</span>.<span class="property">MirroredRepeatWrapping</span> &#125; );</span><br><span class="line">            <span class="comment">//加载mtl</span></span><br><span class="line">            <span class="comment">//输入传入的路径</span></span><br><span class="line">            mtlLoader.<span class="title function_">load</span>( mtl_file, <span class="keyword">function</span>(<span class="params"> materials </span>) &#123;</span><br><span class="line">            materials.<span class="title function_">preload</span>();<span class="comment">//这行代码官方有，但是不知道有什么作用，去掉也无影响。</span></span><br><span class="line">            loader.<span class="title function_">setMaterials</span>( materials );<span class="comment">//设置Obj的材质为mtl带有的材质</span></span><br><span class="line">            <span class="comment">//加载Obj文件</span></span><br><span class="line">            loader.<span class="title function_">load</span>( modelPath, <span class="keyword">function</span> (<span class="params"> object </span>) &#123;</span><br><span class="line">      </span><br><span class="line">               object.<span class="title function_">traverse</span>(<span class="keyword">function</span>(<span class="params">child</span>) &#123;</span><br><span class="line">                   <span class="comment">//设置所有的子对象都可以投射和接受阴影</span></span><br><span class="line">                    child.<span class="property">castShadow</span> = <span class="literal">true</span>;</span><br><span class="line">                    child.<span class="property">recieveShadow</span> = <span class="literal">true</span>;</span><br><span class="line">                    <span class="keyword">if</span>(colorMap !== <span class="literal">undefined</span>)&#123;</span><br><span class="line">                        mtl.<span class="property">map</span> = colorMap;<span class="comment">//颜色贴图</span></span><br><span class="line">                    &#125;</span><br><span class="line">                     <span class="keyword">if</span>(bumpMap !== <span class="literal">undefined</span>)&#123;</span><br><span class="line">                         mtl.<span class="property">bumpMap</span> = bumpMap;<span class="comment">//凹凸贴图</span></span><br><span class="line">                     &#125;</span><br><span class="line">            &#125; ); <span class="comment">//完成OBJ文件的加载      </span></span><br><span class="line">            <span class="comment">//将模型添加到model组里面</span></span><br><span class="line">            model.<span class="title function_">add</span>( object );  </span><br><span class="line">            </span><br><span class="line">            backgroundY = backgroundY ===<span class="literal">undefined</span> ? <span class="number">0</span> :backgroundY;<span class="comment">//设置初值</span></span><br><span class="line">            <span class="comment">//让模型导入就到背景模型上</span></span><br><span class="line">            model.<span class="property">position</span>.<span class="property">y</span> = backgroundY;</span><br><span class="line">            &#125;);</span><br><span class="line">        &#125;);</span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        <span class="comment">//传入的参数如果是材质（object）则直接赋到模型上</span></span><br><span class="line">         <span class="keyword">if</span>(<span class="title function_">typeof</span>(mtl) == <span class="string">&#x27;object&#x27;</span>)&#123;</span><br><span class="line">             loader.<span class="title function_">load</span>(modelPath, <span class="keyword">function</span> (<span class="params">object</span>) &#123;</span><br><span class="line">                 <span class="comment">//这里使用的方法与上面调用基本相同</span></span><br><span class="line">            object.<span class="title function_">traverse</span>(<span class="keyword">function</span>(<span class="params">child</span>) &#123;</span><br><span class="line">                    child.<span class="property">material</span> = mtl;</span><br><span class="line">                    child.<span class="property">castShadow</span> = <span class="literal">true</span>;</span><br><span class="line">                    child.<span class="property">recieveShadow</span> = <span class="literal">true</span>;</span><br><span class="line">                    <span class="keyword">if</span>(colorMap !== <span class="literal">undefined</span>)&#123;</span><br><span class="line">                        mtl.<span class="property">map</span> = colorMap;<span class="comment">//颜色贴图</span></span><br><span class="line">                    &#125;</span><br><span class="line">                     <span class="keyword">if</span>(bumpMap !== <span class="literal">undefined</span>)&#123;</span><br><span class="line">                         mtl.<span class="property">bumpMap</span> = bumpMap;<span class="comment">//凹凸贴图</span></span><br><span class="line">                     &#125;</span><br><span class="line">            &#125;, onProgress, onError );       </span><br><span class="line">                <span class="comment">//添加模型</span></span><br><span class="line">                model.<span class="title function_">add</span>( object );    </span><br><span class="line">                backgroundY = backgroundY ===<span class="literal">undefined</span> ? <span class="number">0</span> :backgroundY;</span><br><span class="line">                model.<span class="property">position</span>.<span class="property">y</span> = backgroundY;</span><br><span class="line">            &#125;);</span><br><span class="line">         &#125;   </span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> model;<span class="comment">//返回模型</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//背景obj函数封装</span></span><br><span class="line"><span class="keyword">var</span> background_obj_exist = <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">var</span> backgroundY;</span><br><span class="line"><span class="keyword">var</span> background_material;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">background_obj</span>(<span class="params">objPath,background_mtl,positionY,scale</span>)&#123;</span><br><span class="line">    positionY = positionY === <span class="literal">undefined</span> ? -<span class="number">3</span> :positionY;</span><br><span class="line">    scale = scale === <span class="literal">undefined</span> ? <span class="number">1.1</span> : scale;</span><br><span class="line">    <span class="keyword">switch</span> (objPath) &#123;</span><br><span class="line">		<span class="keyword">case</span> <span class="string">&#x27;capsule&#x27;</span>:</span><br><span class="line">			    <span class="keyword">var</span> background_path = <span class="string">&#x27;http://webgl.suiyuankj.com/assets/background_obj/background_capsule.obj&#x27;</span>;</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">		<span class="attr">default</span>: </span><br><span class="line">			<span class="keyword">var</span> background_path = objPath;</span><br><span class="line">			<span class="keyword">break</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    background_mtl = background_mtl === <span class="literal">undefined</span> ? <span class="title function_">getMaterial</span>(<span class="string">&#x27;standard&#x27;</span>,<span class="number">0x777777</span>,<span class="literal">true</span>) :background_mtl;</span><br><span class="line">    background_mtl.<span class="property">roughness</span> = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">var</span> background_obj = <span class="title function_">getObjModel</span>(background_path,background_mtl);</span><br><span class="line">    scene.<span class="title function_">add</span>(background_obj);  </span><br><span class="line">    background_obj.<span class="property">scale</span>.<span class="property">x</span> = background_obj.<span class="property">scale</span>.<span class="property">y</span> =background_obj.<span class="property">scale</span>.<span class="property">z</span> = scale;</span><br><span class="line">    background_obj.<span class="property">position</span>.<span class="property">y</span> = positionY;</span><br><span class="line">    backgroundY = positionY;</span><br><span class="line">    background_obj_exist =<span class="literal">true</span>;</span><br><span class="line">    background_material = background_mtl;</span><br><span class="line">    background_material.<span class="property">transparent</span> = <span class="literal">true</span>;</span><br><span class="line">    <span class="keyword">return</span> background_obj;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">//完成封装函数</span></span><br><span class="line"><span class="keyword">var</span> modelgrp = <span class="keyword">new</span> <span class="variable constant_">THREE</span>.<span class="title class_">Group</span>();</span><br><span class="line">scene.<span class="title function_">add</span>(modelgrp);</span><br><span class="line">modelgrp.<span class="property">recieveShadow</span> = <span class="literal">true</span>;</span><br><span class="line">modelgrp.<span class="property">castShadow</span> = <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">finish_init</span>(<span class="params">model,floorCheck,floorPoxY</span>)&#123;</span><br><span class="line">    modelgrp.<span class="title function_">add</span>( model );</span><br><span class="line">    floorCheck = floorCheck === <span class="literal">undefined</span> ? <span class="literal">false</span> : floorCheck;</span><br><span class="line">    floorPoxY = floorPoxY === <span class="literal">undefined</span> ? -<span class="number">3</span> : floorPoxY;</span><br><span class="line">    _floorCheck = floorCheck;</span><br><span class="line">    _floorPoxY = floorPoxY;</span><br><span class="line">    <span class="title function_">update</span>() ;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">//update函数封装 </span></span><br><span class="line"></span><br><span class="line"><span class="keyword">function</span> <span class="title function_">update</span>(<span class="params"></span>) &#123;</span><br><span class="line"></span><br><span class="line">    <span class="comment">//确保每秒刷新60次场景</span></span><br><span class="line">    <span class="title function_">requestAnimationFrame</span>( update );</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="comment">//通过camera的摄像机将场景渲染出来</span></span><br><span class="line">    renderer.<span class="title function_">render</span>( scene, camera );</span><br><span class="line"></span><br><span class="line">    stats.<span class="title function_">update</span>();</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span>(camera_orbitControl_check)&#123;</span><br><span class="line">        controls.<span class="title function_">update</span>();</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        rotate_check = <span class="literal">false</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">    <span class="comment">//实现摄像机回到初始位置</span></span><br><span class="line">    <span class="keyword">if</span>(camera_check == <span class="literal">true</span> &amp;&amp; camera_orbitControl_check == <span class="literal">true</span>)&#123;</span><br><span class="line">        <span class="title function_">cameraFix</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//实现模型自动旋转</span></span><br><span class="line">    <span class="keyword">if</span>(rotate_check)&#123;  </span><br><span class="line">      modelgrp.<span class="property">rotation</span>.<span class="property">y</span> += <span class="number">0.01</span>;   </span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//锁定摄像机的最低位置</span></span><br><span class="line">    <span class="keyword">if</span>(_floorCheck)&#123;</span><br><span class="line">        </span><br><span class="line">        <span class="keyword">if</span>(camera.<span class="property">position</span>.<span class="property">y</span> &lt;_floorPoxY)&#123;</span><br><span class="line">            camera.<span class="property">position</span>.<span class="property">y</span> = _floorPoxY;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125; </span><br><span class="line">    </span><br><span class="line">    <span class="comment">//</span></span><br><span class="line">    <span class="keyword">if</span>(transformControls_rotate)&#123;</span><br><span class="line">        transformControls.<span class="title function_">setMode</span>( <span class="string">&quot;rotate&quot;</span> );</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(transformControls_translate)&#123;</span><br><span class="line">        transformControls.<span class="title function_">setMode</span>( <span class="string">&quot;translate&quot;</span> );</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">if</span>(transformControls_scale)&#123;</span><br><span class="line">        transformControls.<span class="title function_">setMode</span>( <span class="string">&quot;scale&quot;</span> );</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span>(background_obj_exist)&#123;</span><br><span class="line">        <span class="keyword">if</span>(camera.<span class="property">position</span>.<span class="property">y</span>  &lt;backgroundY + <span class="number">3</span> &amp;&amp; background_material.<span class="property">opacity</span>&gt;<span class="number">0</span>)&#123;</span><br><span class="line">            background_material.<span class="property">opacity</span> -= <span class="number">0.1</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(background_material.<span class="property">opacity</span>&lt;<span class="number">0</span>)&#123;</span><br><span class="line">            background_material.<span class="property">opacity</span> = <span class="number">0</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span>(camera.<span class="property">position</span>.<span class="property">y</span> &gt;backgroundY &amp;&amp; background_material.<span class="property">opacity</span>&lt;<span class="number">.5</span>)&#123;</span><br><span class="line">          background_material.<span class="property">opacity</span> += <span class="number">0.05</span>;  </span><br><span class="line">        &#125;</span><br><span class="line">        </span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">if</span> ( controlsEnabled === <span class="literal">true</span> ) &#123;</span><br><span class="line">    </span><br><span class="line">        <span class="keyword">var</span> time = performance.<span class="title function_">now</span>();</span><br><span class="line">        <span class="keyword">var</span> delta = ( time - prevTime ) / <span class="number">1000</span>;</span><br><span class="line"></span><br><span class="line">        velocity.<span class="property">x</span> -= velocity.<span class="property">x</span> * <span class="number">10.0</span> * delta;</span><br><span class="line">        velocity.<span class="property">z</span> -= velocity.<span class="property">z</span> * <span class="number">10.0</span> * delta;</span><br><span class="line"></span><br><span class="line">        velocity.<span class="property">y</span> -= <span class="number">9.8</span> * <span class="number">100.0</span> * delta; <span class="comment">// 100.0 = mass</span></span><br><span class="line"></span><br><span class="line">        direction.<span class="property">z</span> = <span class="title class_">Number</span>( moveForward ) - <span class="title class_">Number</span>( moveBackward );</span><br><span class="line">        direction.<span class="property">x</span> = <span class="title class_">Number</span>( moveLeft ) - <span class="title class_">Number</span>( moveRight );</span><br><span class="line">        direction.<span class="title function_">normalize</span>(); <span class="comment">// this ensures consistent movements in all directions</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> ( moveForward || moveBackward ) velocity.<span class="property">z</span> -= direction.<span class="property">z</span> * <span class="number">400.0</span> * delta;</span><br><span class="line">        <span class="keyword">if</span> ( moveLeft || moveRight ) velocity.<span class="property">x</span> -= direction.<span class="property">x</span> * <span class="number">400.0</span> * delta;</span><br><span class="line">        </span><br><span class="line">        <span class="title function_">camera_pointerLockControl_collison_detect</span>();</span><br><span class="line">        </span><br><span class="line">        <span class="comment">/////////////////////////////////</span></span><br><span class="line">        controls.<span class="title function_">getObject</span>().<span class="title function_">translateX</span>( velocity.<span class="property">x</span> * delta );</span><br><span class="line">        controls.<span class="title function_">getObject</span>().<span class="title function_">translateY</span>( velocity.<span class="property">y</span> * delta );</span><br><span class="line">        controls.<span class="title function_">getObject</span>().<span class="title function_">translateZ</span>( velocity.<span class="property">z</span> * delta );</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> ( controls.<span class="title function_">getObject</span>().<span class="property">position</span>.<span class="property">y</span> &lt; <span class="number">10</span> ) &#123;</span><br><span class="line"></span><br><span class="line">            velocity.<span class="property">y</span> = <span class="number">0</span>;</span><br><span class="line">            controls.<span class="title function_">getObject</span>().<span class="property">position</span>.<span class="property">y</span> = <span class="number">10</span>;</span><br><span class="line"></span><br><span class="line">            canJump = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">        prevTime = time;</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="title function_">postprocessing_blur</span>();</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">/****************************/</span></span><br><span class="line"><span class="comment">/***Postprocessing 后期处理***/</span></span><br><span class="line"><span class="comment">/***************************/</span></span><br><span class="line"><span class="comment">//Postprocessing 使场景模糊</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> postprocessing = &#123; enabled  : <span class="literal">true</span> &#125;;</span><br><span class="line"><span class="keyword">var</span> shaderSettings = &#123;<span class="attr">rings</span>: <span class="number">3</span>,<span class="attr">samples</span>: <span class="number">4</span>&#125;;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">initPostprocessing</span>(<span class="params"></span>) &#123;</span><br><span class="line"></span><br><span class="line">    postprocessing.<span class="property">scene</span> = <span class="keyword">new</span> <span class="variable constant_">THREE</span>.<span class="title class_">Scene</span>();</span><br><span class="line"></span><br><span class="line">    postprocessing.<span class="property">camera</span> = <span class="keyword">new</span> <span class="variable constant_">THREE</span>.<span class="title class_">OrthographicCamera</span>( <span class="variable language_">window</span>.<span class="property">innerWidth</span> / - <span class="number">2</span>, <span class="variable language_">window</span>.<span class="property">innerWidth</span> / <span class="number">2</span>,  <span class="variable language_">window</span>.<span class="property">innerHeight</span> / <span class="number">2</span>, <span class="variable language_">window</span>.<span class="property">innerHeight</span> / - <span class="number">2</span>, -<span class="number">10000</span>, <span class="number">10000</span> );</span><br><span class="line">    postprocessing.<span class="property">camera</span>.<span class="property">position</span>.<span class="property">z</span> = <span class="number">100</span>;</span><br><span class="line"></span><br><span class="line">    postprocessing.<span class="property">scene</span>.<span class="title function_">add</span>( postprocessing.<span class="property">camera</span> );</span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> pars = &#123; <span class="attr">minFilter</span>: <span class="variable constant_">THREE</span>.<span class="property">LinearFilter</span>, <span class="attr">magFilter</span>: <span class="variable constant_">THREE</span>.<span class="property">LinearFilter</span>, <span class="attr">format</span>: <span class="variable constant_">THREE</span>.<span class="property">RGBFormat</span> &#125;;</span><br><span class="line">    postprocessing.<span class="property">rtTextureDepth</span> = <span class="keyword">new</span> <span class="variable constant_">THREE</span>.<span class="title class_">WebGLRenderTarget</span>( <span class="variable language_">window</span>.<span class="property">innerWidth</span>, <span class="variable language_">window</span>.<span class="property">innerHeight</span>, pars );</span><br><span class="line">    postprocessing.<span class="property">rtTextureColor</span> = <span class="keyword">new</span> <span class="variable constant_">THREE</span>.<span class="title class_">WebGLRenderTarget</span>( <span class="variable language_">window</span>.<span class="property">innerWidth</span>, <span class="variable language_">window</span>.<span class="property">innerHeight</span>, pars );</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">var</span> bokeh_shader = <span class="variable constant_">THREE</span>.<span class="property">BokehShader</span>;</span><br><span class="line"></span><br><span class="line">    postprocessing.<span class="property">bokeh_uniforms</span> = <span class="variable constant_">THREE</span>.<span class="property">UniformsUtils</span>.<span class="title function_">clone</span>( bokeh_shader.<span class="property">uniforms</span> );</span><br><span class="line"></span><br><span class="line">    postprocessing.<span class="property">bokeh_uniforms</span>[ <span class="string">&quot;tColor&quot;</span> ].<span class="property">value</span> = postprocessing.<span class="property">rtTextureColor</span>.<span class="property">texture</span>;</span><br><span class="line">    postprocessing.<span class="property">bokeh_uniforms</span>[ <span class="string">&quot;tDepth&quot;</span> ].<span class="property">value</span> = postprocessing.<span class="property">rtTextureDepth</span>.<span class="property">texture</span>;</span><br><span class="line"></span><br><span class="line">    postprocessing.<span class="property">bokeh_uniforms</span>[ <span class="string">&quot;textureWidth&quot;</span> ].<span class="property">value</span> = <span class="variable language_">window</span>.<span class="property">innerWidth</span>;</span><br><span class="line"></span><br><span class="line">    postprocessing.<span class="property">bokeh_uniforms</span>[ <span class="string">&quot;textureHeight&quot;</span> ].<span class="property">value</span> = <span class="variable language_">window</span>.<span class="property">innerHeight</span>;</span><br><span class="line"></span><br><span class="line">    postprocessing.<span class="property">materialBokeh</span> = <span class="keyword">new</span> <span class="variable constant_">THREE</span>.<span class="title class_">ShaderMaterial</span>( &#123;</span><br><span class="line"></span><br><span class="line">        <span class="attr">uniforms</span>: postprocessing.<span class="property">bokeh_uniforms</span>,</span><br><span class="line">        <span class="attr">vertexShader</span>: bokeh_shader.<span class="property">vertexShader</span>,</span><br><span class="line">        <span class="attr">fragmentShader</span>: bokeh_shader.<span class="property">fragmentShader</span>,</span><br><span class="line">        <span class="attr">defines</span>: &#123;</span><br><span class="line">            <span class="attr">RINGS</span>: shaderSettings.<span class="property">rings</span>,</span><br><span class="line">            <span class="attr">SAMPLES</span>: shaderSettings.<span class="property">samples</span></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125; );</span><br><span class="line"></span><br><span class="line">    postprocessing.<span class="property">quad</span> = <span class="keyword">new</span> <span class="variable constant_">THREE</span>.<span class="title class_">Mesh</span>( <span class="keyword">new</span> <span class="variable constant_">THREE</span>.<span class="title class_">PlaneBufferGeometry</span>( <span class="variable language_">window</span>.<span class="property">innerWidth</span>, <span class="variable language_">window</span>.<span class="property">innerHeight</span> ), postprocessing.<span class="property">materialBokeh</span> );</span><br><span class="line">    postprocessing.<span class="property">quad</span>.<span class="property">position</span>.<span class="property">z</span> = - <span class="number">500</span>;</span><br><span class="line">    postprocessing.<span class="property">scene</span>.<span class="title function_">add</span>( postprocessing.<span class="property">quad</span> );</span><br><span class="line">    postprocessing.<span class="property">bokeh_uniforms</span>[ <span class="string">&quot;maxblur&quot;</span> ].<span class="property">value</span> = <span class="number">3.0</span>;</span><br><span class="line">    postprocessing.<span class="property">bokeh_uniforms</span>[ <span class="string">&quot;manualdof&quot;</span> ].<span class="property">value</span> = <span class="literal">false</span>;</span><br><span class="line">    postprocessing.<span class="property">bokeh_uniforms</span>[ <span class="string">&quot;vignetting&quot;</span> ].<span class="property">value</span> = <span class="literal">false</span>;</span><br><span class="line">    postprocessing.<span class="property">bokeh_uniforms</span>[ <span class="string">&quot;depthblur&quot;</span> ].<span class="property">value</span> = <span class="literal">false</span>;</span><br><span class="line">    postprocessing.<span class="property">bokeh_uniforms</span>[ <span class="string">&quot;threshold&quot;</span> ].<span class="property">value</span> = <span class="number">0</span>;</span><br><span class="line">    postprocessing.<span class="property">bokeh_uniforms</span>[ <span class="string">&quot;gain&quot;</span> ].<span class="property">value</span> = <span class="number">0</span>;</span><br><span class="line">    postprocessing.<span class="property">bokeh_uniforms</span>[ <span class="string">&quot;bias&quot;</span> ].<span class="property">value</span> = <span class="number">0</span>;</span><br><span class="line">    postprocessing.<span class="property">bokeh_uniforms</span>[ <span class="string">&quot;fringe&quot;</span> ].<span class="property">value</span> = <span class="number">0</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title function_">initPostprocessing</span>();</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> material_depth = <span class="keyword">new</span> <span class="variable constant_">THREE</span>.<span class="title class_">MeshDepthMaterial</span>();</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">postprocessing_blur</span>(<span class="params"></span>)&#123;</span><br><span class="line">    </span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> ( postprocessing.<span class="property">enabled</span> ) &#123;</span><br><span class="line"></span><br><span class="line">        renderer.<span class="title function_">clear</span>();</span><br><span class="line"></span><br><span class="line">        scene.<span class="property">overrideMaterial</span> = <span class="literal">null</span>;</span><br><span class="line">        renderer.<span class="title function_">render</span>( scene, camera, postprocessing.<span class="property">rtTextureColor</span>, <span class="literal">true</span> );</span><br><span class="line"></span><br><span class="line">        scene.<span class="property">overrideMaterial</span> = material_depth;</span><br><span class="line">        renderer.<span class="title function_">render</span>( scene, camera, postprocessing.<span class="property">rtTextureDepth</span>, <span class="literal">true</span> );</span><br><span class="line"></span><br><span class="line">        renderer.<span class="title function_">render</span>( postprocessing.<span class="property">scene</span>, postprocessing.<span class="property">camera</span> );</span><br><span class="line"></span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line"></span><br><span class="line">        scene.<span class="property">overrideMaterial</span> = <span class="literal">null</span>;</span><br><span class="line"></span><br><span class="line">        renderer.<span class="title function_">clear</span>();</span><br><span class="line">        renderer.<span class="title function_">render</span>( scene, camera );</span><br><span class="line"></span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="title class_">THREEx</span>.<span class="property">Screenshot</span>.<span class="title function_">bindKey</span>(renderer);<span class="comment">//实现按P键屏幕截图</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">/****************/</span></span><br><span class="line"><span class="comment">/***设置调节GUI***/</span></span><br><span class="line"><span class="comment">/***************/</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//设置灯光的位置</span></span><br><span class="line">directionalLight.<span class="property">position</span>.<span class="property">x</span> = <span class="number">12</span>;</span><br><span class="line">directionalLight.<span class="property">position</span>.<span class="property">y</span> = <span class="number">18.5</span>;</span><br><span class="line">directionalLight.<span class="property">position</span>.<span class="property">z</span> = <span class="number">17</span>;</span><br><span class="line">directionalLight.<span class="property">rotation</span>.<span class="property">x</span> = -<span class="number">0.5</span>;</span><br><span class="line">directionalLight.<span class="property">rotation</span>.<span class="property">y</span> = <span class="number">0.2</span>;</span><br><span class="line">directionalLight.<span class="property">rotation</span>.<span class="property">z</span> = <span class="number">0.25</span>;</span><br><span class="line"></span><br><span class="line">fillLight.<span class="property">position</span>.<span class="property">x</span> = -<span class="number">20</span>;</span><br><span class="line">fillLight.<span class="property">position</span>.<span class="property">y</span> = <span class="number">14</span>;</span><br><span class="line">fillLight.<span class="property">position</span>.<span class="property">z</span> = <span class="number">9</span>;</span><br><span class="line">fillLight.<span class="property">rotation</span>.<span class="property">x</span> = -<span class="number">0.9</span>;</span><br><span class="line">fillLight.<span class="property">rotation</span>.<span class="property">y</span> = -<span class="number">1.1</span>;</span><br><span class="line">fillLight.<span class="property">rotation</span>.<span class="property">z</span> = <span class="number">0.28</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//添加灯光的GUI</span></span><br><span class="line"><span class="keyword">var</span> gui = <span class="keyword">new</span> dat.<span class="title function_">GUI</span>();</span><br><span class="line">helper.<span class="property">visible</span> = <span class="literal">false</span>;</span><br><span class="line">fillhelper.<span class="property">visible</span> = <span class="literal">false</span>;</span><br><span class="line">rimhelper.<span class="property">visible</span> = <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">var</span> h = gui.<span class="title function_">addFolder</span>( <span class="string">&quot;light control&quot;</span> );</span><br><span class="line">h.<span class="title function_">add</span>( directionalLight, <span class="string">&quot;intensity&quot;</span>, <span class="number">0</span>, <span class="number">20.0</span>, <span class="number">.1</span> ).<span class="title function_">name</span>( <span class="string">&quot;光照强度&quot;</span> );</span><br><span class="line">h.<span class="title function_">add</span>( directionalLight.<span class="property">position</span>, <span class="string">&quot;x&quot;</span>, -<span class="number">20</span> , <span class="number">20.0</span>, <span class="number">0.5</span> ).<span class="title function_">name</span>( <span class="string">&quot;PosX&quot;</span> );</span><br><span class="line">h.<span class="title function_">add</span>( directionalLight.<span class="property">position</span>, <span class="string">&quot;y&quot;</span>, -<span class="number">20</span>, <span class="number">20.0</span>, <span class="number">0.5</span>).<span class="title function_">name</span>( <span class="string">&quot;PosY&quot;</span> );</span><br><span class="line">h.<span class="title function_">add</span>( directionalLight.<span class="property">position</span>, <span class="string">&quot;z&quot;</span>, -<span class="number">20</span>, <span class="number">20.0</span>, <span class="number">0.5</span> ).<span class="title function_">name</span>( <span class="string">&quot;PosZ&quot;</span> );</span><br><span class="line">h.<span class="title function_">add</span>( directionalLight.<span class="property">rotation</span>, <span class="string">&quot;x&quot;</span>, -<span class="number">180</span>* <span class="title class_">Math</span>.<span class="property">PI</span> /<span class="number">180</span>, <span class="number">180.0</span>* <span class="title class_">Math</span>.<span class="property">PI</span> /<span class="number">180</span>, <span class="number">0.25</span>* <span class="title class_">Math</span>.<span class="property">PI</span> /<span class="number">180</span> ).<span class="title function_">name</span>( <span class="string">&quot;RotX&quot;</span> );</span><br><span class="line">h.<span class="title function_">add</span>( directionalLight.<span class="property">rotation</span>, <span class="string">&quot;y&quot;</span>, -<span class="number">180</span>* <span class="title class_">Math</span>.<span class="property">PI</span> /<span class="number">180</span>, <span class="number">180.0</span>* <span class="title class_">Math</span>.<span class="property">PI</span> /<span class="number">180</span>, <span class="number">0.25</span>* <span class="title class_">Math</span>.<span class="property">PI</span> /<span class="number">180</span>).<span class="title function_">name</span>( <span class="string">&quot;RotY&quot;</span> );</span><br><span class="line">h.<span class="title function_">add</span>( directionalLight.<span class="property">rotation</span>, <span class="string">&quot;z&quot;</span>, -<span class="number">180</span>* <span class="title class_">Math</span>.<span class="property">PI</span> /<span class="number">180</span>, <span class="number">180.0</span>* <span class="title class_">Math</span>.<span class="property">PI</span> /<span class="number">180</span>, <span class="number">0.25</span>* <span class="title class_">Math</span>.<span class="property">PI</span> /<span class="number">180</span> ).<span class="title function_">name</span>( <span class="string">&quot;RotZ&quot;</span> );</span><br><span class="line">h.<span class="title function_">add</span>(helper,<span class="string">&quot;visible&quot;</span>).<span class="title function_">name</span>(<span class="string">&quot;灯光助手&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> h = gui.<span class="title function_">addFolder</span>( <span class="string">&quot;rim control&quot;</span> );</span><br><span class="line">h.<span class="title function_">add</span>( rimLight, <span class="string">&quot;intensity&quot;</span>, <span class="number">0</span>, <span class="number">20.0</span>, <span class="number">.1</span> ).<span class="title function_">name</span>( <span class="string">&quot;光照强度&quot;</span> );</span><br><span class="line">h.<span class="title function_">add</span>( rimLight.<span class="property">position</span>, <span class="string">&quot;x&quot;</span>, -<span class="number">20</span> , <span class="number">20.0</span>, <span class="number">0.5</span> ).<span class="title function_">name</span>( <span class="string">&quot;PosX&quot;</span> );</span><br><span class="line">h.<span class="title function_">add</span>( rimLight.<span class="property">position</span>, <span class="string">&quot;y&quot;</span>, -<span class="number">20</span>, <span class="number">20.0</span>, <span class="number">0.5</span>).<span class="title function_">name</span>( <span class="string">&quot;PosY&quot;</span> );</span><br><span class="line">h.<span class="title function_">add</span>( rimLight.<span class="property">position</span>, <span class="string">&quot;z&quot;</span>, -<span class="number">20</span>, <span class="number">20.0</span>, <span class="number">0.5</span> ).<span class="title function_">name</span>( <span class="string">&quot;PosZ&quot;</span> );</span><br><span class="line">h.<span class="title function_">add</span>( rimLight.<span class="property">rotation</span>, <span class="string">&quot;x&quot;</span>, -<span class="number">180</span>* <span class="title class_">Math</span>.<span class="property">PI</span> /<span class="number">180</span>, <span class="number">180.0</span>* <span class="title class_">Math</span>.<span class="property">PI</span> /<span class="number">180</span>, <span class="number">0.25</span>* <span class="title class_">Math</span>.<span class="property">PI</span> /<span class="number">180</span> ).<span class="title function_">name</span>( <span class="string">&quot;RotX&quot;</span> );</span><br><span class="line">h.<span class="title function_">add</span>( rimLight.<span class="property">rotation</span>, <span class="string">&quot;y&quot;</span>, -<span class="number">180</span>* <span class="title class_">Math</span>.<span class="property">PI</span> /<span class="number">180</span>, <span class="number">180.0</span>* <span class="title class_">Math</span>.<span class="property">PI</span> /<span class="number">180</span>, <span class="number">0.25</span>* <span class="title class_">Math</span>.<span class="property">PI</span> /<span class="number">180</span>).<span class="title function_">name</span>( <span class="string">&quot;RotY&quot;</span> );</span><br><span class="line">h.<span class="title function_">add</span>( rimLight.<span class="property">rotation</span>, <span class="string">&quot;z&quot;</span>, -<span class="number">180</span>* <span class="title class_">Math</span>.<span class="property">PI</span> /<span class="number">180</span>, <span class="number">180.0</span>* <span class="title class_">Math</span>.<span class="property">PI</span> /<span class="number">180</span>, <span class="number">0.25</span>* <span class="title class_">Math</span>.<span class="property">PI</span> /<span class="number">180</span> ).<span class="title function_">name</span>( <span class="string">&quot;RotZ&quot;</span> );</span><br><span class="line">h.<span class="title function_">add</span>(rimhelper,<span class="string">&quot;visible&quot;</span>).<span class="title function_">name</span>(<span class="string">&quot;灯光助手&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> h = gui.<span class="title function_">addFolder</span>( <span class="string">&quot;fill control&quot;</span> );</span><br><span class="line">h.<span class="title function_">add</span>( fillLight, <span class="string">&quot;intensity&quot;</span>, <span class="number">0</span>, <span class="number">20.0</span>, <span class="number">.1</span> ).<span class="title function_">name</span>( <span class="string">&quot;光照强度&quot;</span> );</span><br><span class="line">h.<span class="title function_">add</span>( fillLight.<span class="property">position</span>, <span class="string">&quot;x&quot;</span>, -<span class="number">20</span> , <span class="number">20.0</span>, <span class="number">0.5</span> ).<span class="title function_">name</span>( <span class="string">&quot;PosX&quot;</span> );</span><br><span class="line">h.<span class="title function_">add</span>( fillLight.<span class="property">position</span>, <span class="string">&quot;y&quot;</span>, -<span class="number">20</span>, <span class="number">20.0</span>, <span class="number">0.5</span>).<span class="title function_">name</span>( <span class="string">&quot;PosY&quot;</span> );</span><br><span class="line">h.<span class="title function_">add</span>( fillLight.<span class="property">position</span>, <span class="string">&quot;z&quot;</span>, -<span class="number">20</span>, <span class="number">20.0</span>, <span class="number">0.5</span> ).<span class="title function_">name</span>( <span class="string">&quot;PosZ&quot;</span> );</span><br><span class="line">h.<span class="title function_">add</span>( fillLight.<span class="property">rotation</span>, <span class="string">&quot;x&quot;</span>, -<span class="number">180</span>* <span class="title class_">Math</span>.<span class="property">PI</span> /<span class="number">180</span>, <span class="number">180.0</span>* <span class="title class_">Math</span>.<span class="property">PI</span> /<span class="number">180</span>, <span class="number">0.25</span>* <span class="title class_">Math</span>.<span class="property">PI</span> /<span class="number">180</span> ).<span class="title function_">name</span>( <span class="string">&quot;RotX&quot;</span> );</span><br><span class="line">h.<span class="title function_">add</span>( fillLight.<span class="property">rotation</span>, <span class="string">&quot;y&quot;</span>, -<span class="number">180</span>* <span class="title class_">Math</span>.<span class="property">PI</span> /<span class="number">180</span>, <span class="number">180.0</span>* <span class="title class_">Math</span>.<span class="property">PI</span> /<span class="number">180</span>, <span class="number">0.25</span>* <span class="title class_">Math</span>.<span class="property">PI</span> /<span class="number">180</span>).<span class="title function_">name</span>( <span class="string">&quot;RotY&quot;</span> );</span><br><span class="line">h.<span class="title function_">add</span>( fillLight.<span class="property">rotation</span>, <span class="string">&quot;z&quot;</span>, -<span class="number">180</span>* <span class="title class_">Math</span>.<span class="property">PI</span> /<span class="number">180</span>, <span class="number">180.0</span>* <span class="title class_">Math</span>.<span class="property">PI</span> /<span class="number">180</span>, <span class="number">0.25</span>* <span class="title class_">Math</span>.<span class="property">PI</span> /<span class="number">180</span> ).<span class="title function_">name</span>( <span class="string">&quot;RotZ&quot;</span> );</span><br><span class="line">h.<span class="title function_">add</span>(fillhelper,<span class="string">&quot;visible&quot;</span>).<span class="title function_">name</span>(<span class="string">&quot;灯光助手&quot;</span>);</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> h = gui.<span class="title function_">addFolder</span>( <span class="string">&quot;ambient control&quot;</span> );</span><br><span class="line">h.<span class="title function_">add</span>( ambientLight, <span class="string">&quot;intensity&quot;</span>, <span class="number">0</span>, <span class="number">20.0</span>, <span class="number">.1</span> ).<span class="title function_">name</span>( <span class="string">&quot;光照强度&quot;</span> );</span><br><span class="line"></span><br><span class="line"><span class="comment">//双击主菜单按钮 可以开启高级模式 打开gui 和 帧率显示</span></span><br><span class="line"></span><br><span class="line"><span class="title function_">express</span>();</span><br><span class="line"><span class="keyword">var</span> express_check = <span class="literal">true</span>;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">express</span>(<span class="params"></span>)&#123;</span><br><span class="line">    dat.<span class="property">GUI</span>.<span class="title function_">toggleHide</span>();<span class="comment">//显示灯光控制</span></span><br><span class="line">    <span class="keyword">if</span>(express_check)&#123;</span><br><span class="line">        <span class="variable language_">document</span>.<span class="property">body</span>.<span class="title function_">appendChild</span>(stats.<span class="property">domElement</span>); <span class="comment">//添加帧率显示</span></span><br><span class="line">        express_check = <span class="literal">false</span>;</span><br><span class="line">        <span class="title function_">express_control</span>();</span><br><span class="line">        rotate_check = <span class="literal">true</span>;</span><br><span class="line">        <span class="title function_">rotate_stop</span>();</span><br><span class="line">    &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="variable language_">document</span>.<span class="property">body</span>.<span class="title function_">removeChild</span>(stats.<span class="property">domElement</span>); </span><br><span class="line">        express_check = <span class="literal">true</span>;</span><br><span class="line"></span><br><span class="line">        scene.<span class="title function_">remove</span>( gridHelper );</span><br><span class="line">        scene.<span class="title function_">remove</span>( transformControls );</span><br><span class="line">        $(<span class="string">&quot;#panel&quot;</span>).<span class="title function_">hide</span>();</span><br><span class="line">        rotate_check = <span class="literal">false</span>;</span><br><span class="line">        <span class="title function_">rotate_stop</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> transformControls,gridHelper;</span><br><span class="line"><span class="keyword">var</span> transformControls_check = <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">var</span> transformControls_rotate = <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">var</span> transformControls_translate = <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">var</span> transformControls_scale = <span class="literal">false</span>;</span><br><span class="line"><span class="keyword">function</span> <span class="title function_">express_control</span>(<span class="params"></span>)&#123;</span><br><span class="line">    </span><br><span class="line">    transformControls_check = <span class="literal">false</span>; </span><br><span class="line">    </span><br><span class="line">    transformControls_check = <span class="literal">true</span>;</span><br><span class="line">    <span class="comment">//添加网格显示</span></span><br><span class="line">    gridHelper = <span class="keyword">new</span> <span class="variable constant_">THREE</span>.<span class="title class_">GridHelper</span>( <span class="number">10</span>, <span class="number">10</span> );</span><br><span class="line">    scene.<span class="title function_">add</span>( gridHelper );</span><br><span class="line">    </span><br><span class="line">    transformControls = <span class="keyword">new</span> <span class="variable constant_">THREE</span>.<span class="title class_">TransformControls</span>( camera, renderer.<span class="property">domElement</span> );</span><br><span class="line">    <span class="comment">//selectControl.addEventListener( &#x27;change&#x27;, selectControl.update );</span></span><br><span class="line"></span><br><span class="line">    transformControls.<span class="title function_">attach</span>( <span class="title class_">RotateGrp</span> );</span><br><span class="line">    scene.<span class="title function_">add</span>( transformControls );</span><br><span class="line">    </span><br><span class="line">    $(<span class="string">&quot;#panel&quot;</span>).<span class="title function_">show</span>();</span><br><span class="line">    </span><br><span class="line">    <span class="variable language_">window</span>.<span class="title function_">addEventListener</span>( <span class="string">&#x27;keydown&#x27;</span>, <span class="keyword">function</span> (<span class="params"> event </span>) &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">switch</span> ( event.<span class="property">keyCode</span> ) &#123;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">case</span> <span class="number">81</span>: <span class="comment">// Q</span></span><br><span class="line">                transformControls.<span class="title function_">setSpace</span>( transformControls.<span class="property">space</span> === <span class="string">&quot;local&quot;</span> ? <span class="string">&quot;world&quot;</span> : <span class="string">&quot;local&quot;</span> );</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">case</span> <span class="number">17</span>: <span class="comment">// Ctrl</span></span><br><span class="line">                transformControls.<span class="title function_">setTranslationSnap</span>( <span class="number">100</span> );</span><br><span class="line">                transformControls.<span class="title function_">setRotationSnap</span>( <span class="variable constant_">THREE</span>.<span class="property">Math</span>.<span class="title function_">degToRad</span>( <span class="number">15</span> ) );</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">case</span> <span class="number">87</span>: <span class="comment">// W</span></span><br><span class="line">                transformControls.<span class="title function_">setMode</span>( <span class="string">&quot;translate&quot;</span> );</span><br><span class="line">                transformControls_rotate = <span class="literal">false</span>;</span><br><span class="line">                transformControls_translate = <span class="literal">true</span>;</span><br><span class="line">                transformControls_scale = <span class="literal">false</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">case</span> <span class="number">69</span>: <span class="comment">// E</span></span><br><span class="line">                transformControls.<span class="title function_">setMode</span>( <span class="string">&quot;rotate&quot;</span> );</span><br><span class="line">                transformControls_rotate = <span class="literal">true</span>;</span><br><span class="line">                transformControls_translate = <span class="literal">false</span>;</span><br><span class="line">                transformControls_scale = <span class="literal">false</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">case</span> <span class="number">82</span>: <span class="comment">// R</span></span><br><span class="line">                transformControls.<span class="title function_">setMode</span>( <span class="string">&quot;scale&quot;</span> );</span><br><span class="line">                transformControls_rotate = <span class="literal">false</span>;</span><br><span class="line">                transformControls_translate = <span class="literal">false</span>;</span><br><span class="line">                transformControls_scale = <span class="literal">true</span>;</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">case</span> <span class="number">187</span>:</span><br><span class="line">            <span class="keyword">case</span> <span class="number">107</span>: <span class="comment">// +, =, num+</span></span><br><span class="line">                transformControls.<span class="title function_">setSize</span>( transformControls.<span class="property">size</span> + <span class="number">0.1</span> );</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">case</span> <span class="number">189</span>:</span><br><span class="line">            <span class="keyword">case</span> <span class="number">109</span>: <span class="comment">// -, _, num-</span></span><br><span class="line">                transformControls.<span class="title function_">setSize</span>( <span class="title class_">Math</span>.<span class="title function_">max</span>( transformControls.<span class="property">size</span> - <span class="number">0.1</span>, <span class="number">0.1</span> ) );</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;);</span><br><span class="line"></span><br><span class="line">    <span class="variable language_">window</span>.<span class="title function_">addEventListener</span>( <span class="string">&#x27;keyup&#x27;</span>, <span class="keyword">function</span> (<span class="params"> event </span>) &#123;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">switch</span> ( event.<span class="property">keyCode</span> ) &#123;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">case</span> <span class="number">17</span>: <span class="comment">// Ctrl</span></span><br><span class="line">                control.<span class="title function_">setTranslationSnap</span>( <span class="literal">null</span> );</span><br><span class="line">                control.<span class="title function_">setRotationSnap</span>( <span class="literal">null</span> );</span><br><span class="line">                <span class="keyword">break</span>;</span><br><span class="line"></span><br><span class="line">        &#125;</span><br><span class="line"></span><br><span class="line">    &#125;);</span><br><span class="line">    </span><br><span class="line">    <span class="comment">//object</span></span><br><span class="line">    </span><br><span class="line">&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="import-js参考写法"><a href="#import-js参考写法" class="headerlink" title="import.js参考写法"></a>import.js参考写法</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//加载贴图</span></span><br><span class="line"><span class="keyword">var</span> textureLoader = <span class="keyword">new</span> <span class="variable constant_">THREE</span>.<span class="title class_">TextureLoader</span>();</span><br><span class="line"><span class="keyword">var</span> envPath = <span class="string">&#x27;../../js/three.js-master/examples/textures/cube/skyboxsun25deg/&#x27;</span>;</span><br><span class="line"><span class="keyword">var</span> reflectionCube = <span class="title function_">getEnvMap</span>(envPath);<span class="comment">//调用scene_init-ver3.0 封装的环境贴图函数</span></span><br><span class="line">renderer.<span class="property">shadowMapEnabled</span>  = <span class="literal">false</span>;</span><br><span class="line"><span class="title function_">toggleThreeLight</span>();<span class="comment">//调用scene_init-ver3.0 封装的三点照明函数</span></span><br><span class="line">ambientLight.<span class="property">intensity</span> = <span class="number">0.5</span>;</span><br><span class="line">scene.<span class="property">background</span> = reflectionCube;<span class="comment">//添加背景天空盒</span></span><br><span class="line"><span class="keyword">var</span> <span class="title class_">RotateGrp</span> = <span class="keyword">new</span> <span class="variable constant_">THREE</span>.<span class="title class_">Group</span>();</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> background_mat = <span class="title function_">getMaterial</span>(<span class="string">&#x27;standard&#x27;</span>,<span class="string">&#x27;rgb(180,160,120)&#x27;</span>);</span><br><span class="line">background_mat.<span class="property">roughness</span> = <span class="number">1</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> path = <span class="string">&#x27;obj/room.obj&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">var</span> earphone = <span class="title function_">getModel</span>(path,background_mat);<span class="comment">//调用scene_init-ver3.0 封装的获取函数函数</span></span><br><span class="line"><span class="title class_">RotateGrp</span>.<span class="title function_">add</span>(earphone);</span><br><span class="line"></span><br><span class="line"><span class="comment">//orbit控制</span></span><br><span class="line"><span class="comment">//camera_orbitControl(2,40);</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//添加碰撞物体</span></span><br><span class="line"><span class="comment">//objects.push(Group_test.children[0]);</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//pointerLock第一人称视角</span></span><br><span class="line"><span class="title function_">camera_pointerLockControl</span>();</span><br><span class="line"></span><br><span class="line"><span class="comment">//函数初始化完成</span></span><br><span class="line"><span class="title function_">finish_init</span>(<span class="title class_">RotateGrp</span>,<span class="literal">true</span>,-<span class="number">20</span>);</span><br><span class="line"></span><br><span class="line"><span class="comment">/*var capsule_obj = background_obj(&#x27;../../assets/background_obj/background_disc.obj&#x27;,background_mat,-3);</span></span><br><span class="line"><span class="comment">background_obj.scale.x = background_obj.scale.y =background_obj.scale.z = 1;</span></span><br><span class="line"><span class="comment">background_material.opacity = 0.5;*/</span></span><br><span class="line"><span class="comment">//background_obj.position.y -= 3;</span></span><br><span class="line"><span class="comment">//RotateGrp.position.y = 6;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>
<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><blockquote>
<p>这种写法是我还没有学习js面向对象以及js的设计模式时最笨的写法<br>面向对象的问题是使用不灵活，很多时候需要在scene_init-ver3.0里面写相应的函数来匹配相应的功能<br>变量全部是暴露的，容易产生莫名其妙的冲突</p>
</blockquote>
</div><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">智伤帝</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://blog.l0v0.com/posts/61471.html">https://blog.l0v0.com/posts/61471.html</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://blog.l0v0.com" target="_blank">智伤帝的个人博客</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E0%A0%B4%E7%BC%96%E7%A8%8B-%E5%89%8D%E7%AB%AF/">࠴编程/前端</a><a class="post-meta__tags" href="/tags/%E0%A1%84Threejs/">ࡄThreejs</a><a class="post-meta__tags" href="/tags/%E0%A1%85OpenGL/">ࡅOpenGL</a></div><div class="post_share"><div class="addtoany"><div class="a2a_kit a2a_kit_size_32 a2a_default_style"><a class="a2a_button_facebook"></a><a class="a2a_button_twitter"></a><a class="a2a_button_wechat"></a><a class="a2a_button_sina_weibo"></a><a class="a2a_button_facebook_messenger"></a><a class="a2a_button_email"></a><a class="a2a_button_copy_link"></a><a class="a2a_dd" target="_blank" rel="noopener" href="https://www.addtoany.com/share"></a></div></div><script async="async" src="https://static.addtoany.com/menu/page.js"></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i> 打赏<div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="//cdn.jsdelivr.net/gh/FXTD-odyssey/FXTD-odyssey.github.io@master/img/wechatimg.jpg" target="_blank"><img class="post-qr-code-img" data-lazy-src="//cdn.jsdelivr.net/gh/FXTD-odyssey/FXTD-odyssey.github.io@master/img/wechatimg.jpg" alt="微信"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="//cdn.jsdelivr.net/gh/FXTD-odyssey/FXTD-odyssey.github.io@master/img/alipayimg.jpg" target="_blank"><img class="post-qr-code-img" data-lazy-src="//cdn.jsdelivr.net/gh/FXTD-odyssey/FXTD-odyssey.github.io@master/img/alipayimg.jpg" alt="支付宝"/></a><div class="post-qr-code-desc">支付宝</div></li></ul></div></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/posts/12961.html"><img class="prev-cover" data-lazy-src="//cdn.jsdelivr.net/gh/FXTD-odyssey/FXTD-odyssey.github.io@master/img/cover_04.png" onerror="onerror=null;src='//cdn.jsdelivr.net/gh/FXTD-odyssey/FXTD-odyssey.github.io@master/img/404.jpg'"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">Three.js - 学习之路（五）</div></div></a></div><div class="next-post pull-right"><a href="/posts/34183.html"><img class="next-cover" data-lazy-src="https://cdn.jsdelivr.net/gh/FXTD-odyssey/FXTD-odyssey.github.io@master/post_img/34183/1.png" onerror="onerror=null;src='//cdn.jsdelivr.net/gh/FXTD-odyssey/FXTD-odyssey.github.io@master/img/404.jpg'"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">zplus 教程系列（三）</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span> 相关推荐</span></div><div class="relatedPosts-list"><div><a href="/posts/35846.html" title="Three.js -通过JQuery处理脚本异步加载"><img class="cover" data-lazy-src="//cdn.jsdelivr.net/gh/FXTD-odyssey/FXTD-odyssey.github.io@master/img/cover_03.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2018-08-21</div><div class="title">Three.js -通过JQuery处理脚本异步加载</div></div></a></div><div><a href="/posts/24831.html" title="Three.js -动态加载相关的js"><img class="cover" data-lazy-src="//cdn.jsdelivr.net/gh/FXTD-odyssey/FXTD-odyssey.github.io@master/img/cover_04.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2018-08-19</div><div class="title">Three.js -动态加载相关的js</div></div></a></div><div><a href="/posts/59091.html" title="Three.js - postprocessing 后期处理"><img class="cover" data-lazy-src="//cdn.jsdelivr.net/gh/FXTD-odyssey/FXTD-odyssey.github.io@master/img/cover_04.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2018-08-18</div><div class="title">Three.js - postprocessing 后期处理</div></div></a></div><div><a href="/posts/50589.html" title="Three.js - 用最小面数生成立体的物体"><img class="cover" data-lazy-src="https://cdn.jsdelivr.net/gh/FXTD-odyssey/FXTD-odyssey.github.io@master/post_img/50589/1.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2018-08-11</div><div class="title">Three.js - 用最小面数生成立体的物体</div></div></a></div><div><a href="/posts/40670.html" title="Three.js - 学习之路（三）"><img class="cover" data-lazy-src="//cdn.jsdelivr.net/gh/FXTD-odyssey/FXTD-odyssey.github.io@master/img/cover_04.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2018-07-27</div><div class="title">Three.js - 学习之路（三）</div></div></a></div><div><a href="/posts/37543.html" title="Three.js - 学习之路（二）"><img class="cover" data-lazy-src="//cdn.jsdelivr.net/gh/FXTD-odyssey/FXTD-odyssey.github.io@master/img/cover_03.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2018-07-27</div><div class="title">Three.js - 学习之路（二）</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div><div class="comment-switch"><span class="first-comment">Valine</span><label><input id="switch-comments-btn" type="checkbox"/><span class="slider"></span></label><span class="second-comment">Gitalk</span></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div><div><div id="gitalk-container"></div></div></div></div></article></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2022 By 智伤帝</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><section id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></section><div class="search-dialog" id="local-search"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div></div><hr/><div id="local-search-results"><div id="local-hits"></div><div id="local-stats"><div class="local-search-stats__hr" id="hr"><span>由</span> <a target="_blank" rel="noopener" href="https://github.com/wzpan/hexo-generator-search" style="color:#49B1F5;">hexo-generator-search</a>
 <span>提供支持</span></div></div></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div><div><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module" defer></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.spacingElementById('content-inner')
  else {
    $.getScript('https://cdn.jsdelivr.net/npm/pangu/dist/browser/pangu.min.js', () => {
      pangu.spacingElementById('content-inner')
    })
  }
}

function panguInit () {
  if (false){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguFn)</script><script src="/js/search/local-search.js"></script><script>var preloader = {
  endLoading: () => {
    document.body.style.overflow = 'auto';
    document.getElementById('loading-box').classList.add("loaded")
  },
  initLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.remove("loaded")

  }
}
window.addEventListener('load',()=> {preloader.endLoading()})</script><div class="js-pjax"><script>function loadValine () {
  function initValine () {
    let initData = {
      el: '#vcomment',
      appId: 'mrRioyNTSEAOvVLAsLgkhr4j-gzGzoHsz',
      appKey: 'wHDm1kxC2FUpOA7FNdgTOEnx',
      placeholder: 'Please leave your footprints',
      avatar: 'monsterid',
      meta: 'nick,mail,link'.split(','),
      pageSize: '10',
      lang: 'zh-CN',
      recordIP: false,
      serverURLs: '',
      emojiCDN: '',
      emojiMaps: "",
      enableQQ: false,
      path: window.location.pathname,
    }

    if (true) { 
      initData.requiredFields= ('nick,mail'.split(','))
    }
    
    if (false) {
      const otherData = false
      initData = Object.assign({}, initData, otherData)
    }
    
    const valine = new Valine(initData)
  }

  if (typeof Valine === 'function') initValine() 
  else $.getScript('https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js', initValine)
}

if ('Valine' === 'Valine' || !false) {
  if (false) btf.loadComment(document.querySelector('#vcomment'),loadValine)
  else setTimeout(() => loadValine(), 0)
} else {
  function loadOtherComment () {
    loadValine()
  }
}</script><script>function addGitalkSource () {
  const ele = document.createElement('link')
  ele.rel = 'stylesheet'
  ele.href= 'https://cdn.jsdelivr.net/npm/gitalk/dist/gitalk.min.css'
  document.getElementsByTagName('head')[0].appendChild(ele)
}

function loadGitalk () {
  function initGitalk () {
    var gitalk = new Gitalk({
      clientID: '355e44f722e24963b9dd',
      clientSecret: 'f8ec08d349714aa06152735a75b6d9ac9ef77016',
      repo: 'FXTD-odyssey.github.io',
      owner: 'FXTD-odyssey',
      admin: ['FXTD-odyssey'],
      id: '9418ca802430180be9f2b36405ac1699',
      language: 'zh-CN',
      perPage: 10,
      distractionFreeMode: false,
      pagerDirection: 'last',
      createIssueManually: false,
      updateCountCallback: commentCount
    })
    gitalk.render('gitalk-container')
  }

  if (typeof Gitalk === 'function') initGitalk()
  else {
    addGitalkSource()
    $.getScript('https://cdn.jsdelivr.net/npm/gitalk@latest/dist/gitalk.min.js', initGitalk)
  }
}

function commentCount(n){
  let isCommentCount = document.querySelector('#post-meta .gitalk-comment-count')
  if (isCommentCount) {
    isCommentCount.innerHTML= n
  }
}

if ('Valine' === 'Gitalk' || !false) {
  if (false) btf.loadComment(document.getElementById('gitalk-container'), loadGitalk)
  else loadGitalk()
} else {
  function loadOtherComment () {
    loadGitalk()
  }
}</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><script src="https://cdn.jsdelivr.net/gh/wilq32/jqueryrotate/jQueryRotate.js"></script><script src="/js/classify.js"></script><script src="/js/jsdelivr.js"></script><script defer="defer" id="fluttering_ribbon" mobile="true" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-fluttering-ribbon.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><script>(function(){
  const bp = document.createElement('script');
  const curProtocol = window.location.protocol.split(':')[0];
  if (curProtocol === 'https'){
  bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
  }
  else{
  bp.src = 'http://push.zhanzhang.baidu.com/push.js';
  }
  bp.dataset.pjax = ''
  const s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(bp, s);
})()</script></div></body></html>