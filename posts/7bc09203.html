<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>毕业设计 - WebGL三维网站全栈开发 | 智伤帝的个人博客</title><meta name="keywords" content="ࡄThreejs,ࡅOpenGL,ࡂVue,࠴编程/Go"><meta name="author" content="智伤帝"><meta name="copyright" content="智伤帝"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta http-equiv="Cache-Control" content="no-transform"><meta http-equiv="Cache-Control" content="no-siteapp"><meta name="description" content="全栈开发 | 模型预览网站">
<meta property="og:type" content="article">
<meta property="og:title" content="毕业设计 - WebGL三维网站全栈开发">
<meta property="og:url" content="https://blog.l0v0.com/posts/7bc09203.html">
<meta property="og:site_name" content="智伤帝的个人博客">
<meta property="og:description" content="全栈开发 | 模型预览网站">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://cdn.jsdelivr.net/gh/FXTD-odyssey/FXTD-odyssey.github.io@master/post_img/7bc09203/7f1607a6f0838afa07221e3df21436f4.png">
<meta property="article:published_time" content="2020-05-29T01:09:57.000Z">
<meta property="article:modified_time" content="2022-12-14T02:54:16.921Z">
<meta property="article:author" content="智伤帝">
<meta property="article:tag" content="ࡄThreejs">
<meta property="article:tag" content="ࡅOpenGL">
<meta property="article:tag" content="ࡂVue">
<meta property="article:tag" content="࠴编程&#x2F;Go">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://cdn.jsdelivr.net/gh/FXTD-odyssey/FXTD-odyssey.github.io@master/post_img/7bc09203/7f1607a6f0838afa07221e3df21436f4.png"><link rel="shortcut icon" href="//cdn.jsdelivr.net/gh/FXTD-odyssey/FXTD-odyssey.github.io@master/img/favicon.png"><link rel="canonical" href="https://blog.l0v0.com/posts/7bc09203.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//hm.baidu.com"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="preconnect" href="//zz.bdstatic.com"/><meta name="google-site-verification" content="google15d1ccb0af66991a"/><meta name="msvalidate.01" content="D306EED72EF12BF89A2A951583FF91C7"/><meta name="baidu-site-verification" content="A3TUx6EZdy"/><meta name="360-site-verification" content="48ce68b0e3754c994b6e79677b842d48"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css"><script>var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?cda99107ced8e9ef4d02339065438d4f";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script><script>var GLOBAL_CONFIG = { 
  root: '/',
  hexoversion: '5.4.2',
  algolia: undefined,
  localSearch: {"path":"search.xml","languages":{"hits_empty":"找不到您查询的内容：${query}"}},
  translate: {"defaultEncoding":2,"translateDelay":0,"msgToTraditionalChinese":"繁","msgToSimplifiedChinese":"簡"},
  noticeOutdate: undefined,
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  date_suffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  ClickShowText: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  justifiedGallery: {
    js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
    css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
  },
  isPhotoFigcaption: false,
  islazyload: true,
  isanchor: false
};

var saveToLocal = {
  set: function setWithExpiry(key, value, ttl) {
    const now = new Date()
    const expiryDay = ttl * 86400000
    const item = {
      value: value,
      expiry: now.getTime() + expiryDay,
    }
    localStorage.setItem(key, JSON.stringify(item))
  },

  get: function getWithExpiry(key) {
    const itemStr = localStorage.getItem(key)

    if (!itemStr) {
      return undefined
    }
    const item = JSON.parse(itemStr)
    const now = new Date()

    if (now.getTime() > item.expiry) {
      localStorage.removeItem(key)
      return undefined
    }
    return item.value
  }
}</script><script id="config_change">var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isSidebar: true,
  postUpdate: '2022-12-14 10:54:16'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(function () {
  window.activateDarkMode = function () {
    document.documentElement.setAttribute('data-theme', 'dark')
    if (document.querySelector('meta[name="theme-color"]') !== null) {
      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
    }
  }
  window.activateLightMode = function () {
    document.documentElement.setAttribute('data-theme', 'light')
    if (document.querySelector('meta[name="theme-color"]') !== null) {
      document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
    }
  }

  const autoChangeMode = 'false'
  const t = saveToLocal.get('theme')
  if (autoChangeMode === '1') {
    const isDarkMode = window.matchMedia('(prefers-color-scheme: dark)').matches
    const isLightMode = window.matchMedia('(prefers-color-scheme: light)').matches
    const isNotSpecified = window.matchMedia('(prefers-color-scheme: no-preference)').matches
    const hasNoSupport = !isDarkMode && !isLightMode && !isNotSpecified

    if (t === undefined) {
      if (isLightMode) activateLightMode()
      else if (isDarkMode) activateDarkMode()
      else if (isNotSpecified || hasNoSupport) {
        const now = new Date()
        const hour = now.getHours()
        const isNight = hour <= 6 || hour >= 18
        isNight ? activateDarkMode() : activateLightMode()
      }
      window.matchMedia('(prefers-color-scheme: dark)').addListener(function (e) {
        if (saveToLocal.get('theme') === undefined) {
          e.matches ? activateDarkMode() : activateLightMode()
        }
      })
    } else if (t === 'light') activateLightMode()
    else activateDarkMode()
  } else if (autoChangeMode === '2') {
    const now = new Date()
    const hour = now.getHours()
    const isNight = hour <= 6 || hour >= 18
    if (t === undefined) isNight ? activateDarkMode() : activateLightMode()
    else if (t === 'light') activateLightMode()
    else activateDarkMode()
  } else {
    if (t === 'dark') activateDarkMode()
    else if (t === 'light') activateLightMode()
  }
})()</script><link rel="stylesheet" href="/css/iconfont.css"><link rel="stylesheet" href="/css/extra.css"><meta name="generator" content="Hexo 5.4.2"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><div id="mobile-sidebar"><div id="menu_mask"></div><div id="mobile-sidebar-menus"><div class="mobile_author_icon"><img class="avatar-img" data-lazy-src="//cdn.jsdelivr.net/gh/FXTD-odyssey/FXTD-odyssey.github.io@master/img/avatar.png" onerror="onerror=null;src='//cdn.jsdelivr.net/gh/FXTD-odyssey/FXTD-odyssey.github.io@master/img/friend_404.gif'" alt="avatar"/></div><div class="mobile_post_data"><div class="mobile_data_item is-center"><div class="mobile_data_link"><a href="/archives/"><div class="headline">文章</div><div class="length_num">301</div></a></div></div><div class="mobile_data_item is-center">      <div class="mobile_data_link"><a href="/tags/"><div class="headline">标签</div><div class="length_num">63</div></a></div></div><div class="mobile_data_item is-center">     <div class="mobile_data_link"><a href="/categories/"><div class="headline">分类</div><div class="length_num">70</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 时间线</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 友情链接</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fa fa-list"></i><span> 系列总结</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/categories/%E6%95%88%E7%8E%87%E6%8F%90%E5%8D%87%E6%8C%87%E5%8D%97/"><span> 效率提升指南</span></a></li><li><a class="site-page" href="/categories/%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91/Unreal/Python"><span> Unreal Python</span></a></li><li><a class="site-page" href="/categories/Python/Python-%E7%BC%96%E7%A8%8B%E8%A7%84%E8%8C%83/"><span> Python 编程规范</span></a></li><li><a class="site-page" href="/categories/CG/Qt/Python%E7%BB%93%E5%90%88Qt%E7%B3%BB%E5%88%97%E5%BC%80%E5%8F%91%E6%95%99%E7%A8%8B/"><span> Python Qt 开发教程</span></a></li><li><a class="site-page" href="/tags/VScode/"><span> VScode 全面使用攻略</span></a></li><li><a class="site-page" href="/categories/Wiki/TiddlyWiki-%E9%A3%9F%E7%94%A8%E6%8C%87%E5%8D%97"><span> TiddlyWiki 使用指南</span></a></li><li><a class="site-page" href="/categories/%E5%89%8D%E7%AB%AF/hexo/"><span> Hexo博客搭建历程</span></a></li><li><a class="site-page" href="/categories/Photogrammetry/"><span> Photogrammetry</span></a></li><li><a class="site-page" href="/categories/%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91/Unity/Shader%E5%AD%A6%E4%B9%A0%E4%B9%8B%E8%B7%AF/"><span> Shader学习之路</span></a></li><li><a class="site-page" href="/categories/CG/Maya/Maya%20%E7%A0%94%E7%A9%B6%E8%AE%B0%E5%BD%95"><span> Maya 研究记录</span></a></li><li><a class="site-page" href="/categories/%E5%89%8D%E7%AB%AF/Vue/Vue%E5%AD%A6%E4%B9%A0%E4%B9%8B%E8%B7%AF/"><span> Vue学习之路</span></a></li><li><a class="site-page" href="/categories/%E5%9B%9E%E5%BF%86%E5%BD%95/"><span> 回忆录</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fa fa-user"></i><span> 关于我</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> 博客初心</span></a></li><li><a class="site-page" href="/about/log.html"><i class="fa-fw fa fa-gift"></i><span> 博客日志</span></a></li><li><a class="site-page" target="_blank" rel="noopener" href="https://wiki.l0v0.com/"><i class="fa-fw fa fa-book"></i><span> wiki 文档</span></a></li><li><a class="site-page" target="_blank" rel="noopener" href="http://hou.l0v0.com"><i class="fa-fw fa fa-futbol"></i><span> Houdini Wiki</span></a></li><li><a class="site-page" href="/about/todo.html"><i class="fa-fw fa fa-check"></i><span> 更新计划</span></a></li><li><a class="site-page" href="/about/plan.html"><i class="fa-fw fa fa-lightbulb"></i><span> 教程计划</span></a></li><li><a class="site-page" href="/about/focus.html"><i class="fa-fw fa fa-bullseye"></i><span> 关注列表</span></a></li><li><a class="site-page" href="/about/note/note.html"><i class="fa-fw fa fa-sticky-note"></i><span> 我的笔记</span></a></li><li><a class="site-page" href="/about/my_work.html"><i class="fa-fw fa fa-briefcase"></i><span> 我的作品</span></a></li><li><a class="site-page" href="/about/contact.html"><i class="fa-fw fa fa-id-badge"></i><span> 联系我</span></a></li></ul></div></div></div></div><div id="body-wrap"><div id="sidebar"><i class="fas fa-arrow-right on" id="toggle-sidebar"></i><div class="sidebar-toc"><div class="sidebar-toc__title">目录</div><div class="sidebar-toc__progress"><span class="progress-notice">你已经读了</span><span class="progress-num">0</span><span class="progress-percentage">%</span><div class="sidebar-toc__progress-bar">     </div></div><div class="sidebar-toc__content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%89%8D%E8%A8%80"><span class="toc-number">1.</span> <span class="toc-text">前言</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%8A%80%E6%9C%AF%E9%80%89%E5%9E%8B"><span class="toc-number">2.</span> <span class="toc-text">技术选型</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%91%98%E8%A6%81"><span class="toc-number">3.</span> <span class="toc-text">摘要</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#1-%E7%BB%AA%E8%AE%BA"><span class="toc-number">4.</span> <span class="toc-text">1.绪论</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#1-1-%E8%AF%BE%E9%A2%98%E7%AE%80%E4%BB%8B"><span class="toc-number">4.1.</span> <span class="toc-text">1.1 课题简介</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-Vue%E5%89%8D%E7%AB%AF%E9%A1%B5%E9%9D%A2%E5%BC%80%E5%8F%91"><span class="toc-number">5.</span> <span class="toc-text">2.Vue前端页面开发</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-Vue-%E6%A1%86%E6%9E%B6%E4%BB%8B%E7%BB%8D"><span class="toc-number">5.1.</span> <span class="toc-text">2.1 Vue 框架介绍</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-Vue-%E5%89%8D%E7%AB%AF%E9%A1%B5%E9%9D%A2%E6%A6%82%E8%A7%88"><span class="toc-number">5.2.</span> <span class="toc-text">2.2 Vue 前端页面概览</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3-Vue-%E4%BB%A3%E7%A0%81%E5%BC%80%E5%8F%91"><span class="toc-number">5.3.</span> <span class="toc-text">2.3 Vue 代码开发</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-WebGL-%E7%BC%96%E8%BE%91%E5%99%A8%E5%BC%80%E5%8F%91"><span class="toc-number">6.</span> <span class="toc-text">3.WebGL 编辑器开发</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-Three-js-%E4%B8%89%E7%BB%B4%E5%9F%BA%E7%A1%80"><span class="toc-number">6.1.</span> <span class="toc-text">3.1 Three.js 三维基础</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-Three-js-%E7%BC%96%E8%BE%91%E5%99%A8%E5%BC%80%E5%8F%91"><span class="toc-number">6.2.</span> <span class="toc-text">3.2 Three.js 编辑器开发</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-Go%E5%90%8E%E7%AB%AF%E6%9C%8D%E5%8A%A1%E5%BC%80%E5%8F%91"><span class="toc-number">7.</span> <span class="toc-text">4.  Go后端服务开发</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-Golang-%E8%AF%AD%E8%A8%80%E6%A6%82%E8%A7%88"><span class="toc-number">7.1.</span> <span class="toc-text">4.1  Golang 语言概览</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-2-Iris-%E6%A1%86%E6%9E%B6%E4%BB%8B%E7%BB%8D"><span class="toc-number">7.2.</span> <span class="toc-text">4.2  Iris 框架介绍</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-3-%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%8E%AF%E5%A2%83%E9%85%8D%E7%BD%AE"><span class="toc-number">7.3.</span> <span class="toc-text">4.3  服务器环境配置</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#4-4-Go%E4%BB%A3%E7%A0%81%E7%BC%96%E5%86%99"><span class="toc-number">7.4.</span> <span class="toc-text">4.4  Go代码编写</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-Python-Qt-CefWidget-%E5%BC%80%E5%8F%91"><span class="toc-number">8.</span> <span class="toc-text">5.  Python Qt CefWidget 开发</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#5-1-%E5%9F%BA%E4%BA%8EPySide%E6%9E%84%E5%BB%BA%E6%A1%8C%E9%9D%A2%E7%A8%8B%E5%BA%8F"><span class="toc-number">8.1.</span> <span class="toc-text">5.1  基于PySide构建桌面程序</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-2-Cef%E6%B5%8F%E8%A7%88%E5%99%A8%E5%B5%8C%E5%85%A5%E6%A1%86%E6%9E%B6"><span class="toc-number">8.2.</span> <span class="toc-text">5.2  Cef浏览器嵌入框架</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-3-CefWidget-Python%E4%BB%A3%E7%A0%81%E7%BC%96%E5%86%99"><span class="toc-number">8.3.</span> <span class="toc-text">5.3  CefWidget Python代码编写</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%80%BB%E7%BB%93"><span class="toc-number">9.</span> <span class="toc-text">总结</span></a></li></ol></div></div></div><header class="post-bg" id="page-header" style="background-image: url(https://cdn.jsdelivr.net/gh/FXTD-odyssey/FXTD-odyssey.github.io@master/post_img/7bc09203/7f1607a6f0838afa07221e3df21436f4.png)"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">智伤帝的个人博客</a></span><span id="menus"><div id="search_button"><a class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></a></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fa fa-home"></i><span> 主页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fa fa-archive"></i><span> 时间线</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fa fa-folder-open"></i><span> 标签</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fa fa-tags"></i><span> 分类</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fa fa-link"></i><span> 友情链接</span></a></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fa fa-list"></i><span> 系列总结</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/categories/%E6%95%88%E7%8E%87%E6%8F%90%E5%8D%87%E6%8C%87%E5%8D%97/"><span> 效率提升指南</span></a></li><li><a class="site-page" href="/categories/%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91/Unreal/Python"><span> Unreal Python</span></a></li><li><a class="site-page" href="/categories/Python/Python-%E7%BC%96%E7%A8%8B%E8%A7%84%E8%8C%83/"><span> Python 编程规范</span></a></li><li><a class="site-page" href="/categories/CG/Qt/Python%E7%BB%93%E5%90%88Qt%E7%B3%BB%E5%88%97%E5%BC%80%E5%8F%91%E6%95%99%E7%A8%8B/"><span> Python Qt 开发教程</span></a></li><li><a class="site-page" href="/tags/VScode/"><span> VScode 全面使用攻略</span></a></li><li><a class="site-page" href="/categories/Wiki/TiddlyWiki-%E9%A3%9F%E7%94%A8%E6%8C%87%E5%8D%97"><span> TiddlyWiki 使用指南</span></a></li><li><a class="site-page" href="/categories/%E5%89%8D%E7%AB%AF/hexo/"><span> Hexo博客搭建历程</span></a></li><li><a class="site-page" href="/categories/Photogrammetry/"><span> Photogrammetry</span></a></li><li><a class="site-page" href="/categories/%E6%B8%B8%E6%88%8F%E5%BC%80%E5%8F%91/Unity/Shader%E5%AD%A6%E4%B9%A0%E4%B9%8B%E8%B7%AF/"><span> Shader学习之路</span></a></li><li><a class="site-page" href="/categories/CG/Maya/Maya%20%E7%A0%94%E7%A9%B6%E8%AE%B0%E5%BD%95"><span> Maya 研究记录</span></a></li><li><a class="site-page" href="/categories/%E5%89%8D%E7%AB%AF/Vue/Vue%E5%AD%A6%E4%B9%A0%E4%B9%8B%E8%B7%AF/"><span> Vue学习之路</span></a></li><li><a class="site-page" href="/categories/%E5%9B%9E%E5%BF%86%E5%BD%95/"><span> 回忆录</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="javascript:void(0);"><i class="fa-fw fa fa-user"></i><span> 关于我</span><i class="fas fa-chevron-down expand"></i></a><ul class="menus_item_child"><li><a class="site-page" href="/about/"><i class="fa-fw fa fa-heart"></i><span> 博客初心</span></a></li><li><a class="site-page" href="/about/log.html"><i class="fa-fw fa fa-gift"></i><span> 博客日志</span></a></li><li><a class="site-page" target="_blank" rel="noopener" href="https://wiki.l0v0.com/"><i class="fa-fw fa fa-book"></i><span> wiki 文档</span></a></li><li><a class="site-page" target="_blank" rel="noopener" href="http://hou.l0v0.com"><i class="fa-fw fa fa-futbol"></i><span> Houdini Wiki</span></a></li><li><a class="site-page" href="/about/todo.html"><i class="fa-fw fa fa-check"></i><span> 更新计划</span></a></li><li><a class="site-page" href="/about/plan.html"><i class="fa-fw fa fa-lightbulb"></i><span> 教程计划</span></a></li><li><a class="site-page" href="/about/focus.html"><i class="fa-fw fa fa-bullseye"></i><span> 关注列表</span></a></li><li><a class="site-page" href="/about/note/note.html"><i class="fa-fw fa fa-sticky-note"></i><span> 我的笔记</span></a></li><li><a class="site-page" href="/about/my_work.html"><i class="fa-fw fa fa-briefcase"></i><span> 我的作品</span></a></li><li><a class="site-page" href="/about/contact.html"><i class="fa-fw fa fa-id-badge"></i><span> 联系我</span></a></li></ul></div></div><span class="close" id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></span></span></nav><div id="post-info"><div id="post-title"><div class="posttitle">毕业设计 - WebGL三维网站全栈开发</div></div><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2020-05-29T01:09:57.000Z" title="发表于 2020-05-29 09:09:57">2020-05-29</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2022-12-14T02:54:16.921Z" title="更新于 2022-12-14 10:54:16">2022-12-14</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%A4%A7%E5%AD%A6/">大学</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E5%A4%A7%E5%AD%A6/%E6%88%91%E7%9A%84%E4%BD%9C%E5%93%81/">我的作品</a></span></div><div class="meta-secondline"> <span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">9.7k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>31分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout_post" id="content-inner"><article id="post"><div class="post-content" id="article-container"><span id="more"></span>
<h2 id="前言"><a href="#前言" class="headerlink" title="前言"></a>前言</h2><blockquote>
<p>&emsp;&emsp;毕设说实话并没有花费太多的时间投入进去，毕竟工作上的事情也很多。<br>&emsp;&emsp;最初聪哥是和我说直接帮我解决毕设的问题的，我的毕设其实和大学打的创业比赛的那套 WebGL 模型预览网站的东西是一样。<br>&emsp;&emsp;当时报备毕设的时候就想着应付一下，不打算花费太多的心神。</p>
</blockquote>
<blockquote>
<p>&emsp;&emsp;后来师兄的工作室开发 Zeus 三维素材预览软件。<br>&emsp;&emsp;于是我就掺和了进去，为了实现跨DCC实现三维预览，我这里也借助了 WebGL 的功能，并且开发了 CefWidget<br>&emsp;&emsp;随着开发的深入，后面我也想着不如就把这个资产浏览器当做自己的毕设好了。<br>&emsp;&emsp;但是毕竟代码都是师弟他们弄得，我就过来打打辅助而已，怎么可以直接拿别人的代码当毕设呢？<br>&emsp;&emsp;所以我最初打算分成两条线开发，我自己也写一个资产管理的软件。<br>&emsp;&emsp;于是那段时间开始开发 Qt 数据双向绑定的库，打算拿资产开发作为这个库最终效果的测试。<br>&emsp;&emsp;为了搞这个，又去研究 Vue.js 的 MVVM 架构，去学习了解了 Flux 设计模式。（搞了一大通，最后其实一脸懵逼）</p>
</blockquote>
<blockquote>
<p>&emsp;&emsp;后来双向数据绑定的开发难产（现在也没有完全搞完，思路还改了一波），自己开发资产库的计划就一拖再拖。<br>&emsp;&emsp;最后临近5月份，老师催着要交论文了，没有办法。<br>&emsp;&emsp;我只好改变思路，直接做毕设差不多的网站出来算了。</p>
</blockquote>
<blockquote>
<p>&emsp;&emsp;想到做网站，需要用到服务器，要做全栈开发，突然觉得可以去学学 Go 开发，也挺好的，最近各路神仙大佬都推荐学习这个。<br>&emsp;&emsp;于是就自己学 Go 来做一下后端开发了。所以就开始了一个星期突击学习速成毕设的过程。</p>
</blockquote>
<h2 id="技术选型"><a href="#技术选型" class="headerlink" title="技术选型"></a>技术选型</h2><blockquote>
<p>&emsp;&emsp;决定要独自搞毕设之后，首先就要进行技术选项评估了。<br>&emsp;&emsp;后台毋庸置疑选用 Go 来实现了，前端还让我纠结了好一会。<br>&emsp;&emsp;想到之前还在研究 Vuex 的全局状态管理是如何实现的，于是我打算这次前端也用 Vue 来搭建吧。<br>&emsp;&emsp;因为赶时间，就直接用后台框架去 vue-element-admin 做了，结果是个大坑。<br>&emsp;&emsp;服务器端因为用来了 宝塔面板 ， 可以快速建站，搭建 MySql 数据库也非常简单。<br>&emsp;&emsp;由于网站搭建的内容不太够，所以又拿了之前研究的 CefWidget 跨 DCC 浏览器进行凑数。</p>
</blockquote>
<blockquote>
<p>&emsp;&emsp;下面就把论文的部分整理出来，相当于水了一篇文章。</p>
</blockquote>
<h2 id="摘要"><a href="#摘要" class="headerlink" title="摘要"></a><strong>摘要</strong></h2><blockquote>
<p>&emsp;&emsp;基于WebGL技术驱动的三维网站，实现跨 Digital Content Creation软件的三维资产库。基于 Go Iris 框架搭建软件的后台系统，进行服务器端的数据交互，通过腾讯云的 Linux服务器上搭建 MySql 数据库进行数据保存。通过前端框架 Vue Element Admin 搭建后台管理系统的前端页面，实现线上模型素材的管理。通过 Python Cefpython3 库实现浏览器在 Qt 框架下的嵌入，实现将WebGL技术封装到 Digital Content Creation软件中，最后使用 Python 的 Qt 框架搭建出可以在不同软件平台下启动的三维资产库客户端。</p>
</blockquote>
<blockquote>
<p>&emsp;&emsp;由于 Digital Content Creation软件下的 Python 经过了特殊的修改，并不支持一些Cython 编译的程序库，因此这里将 Cefpython3 实现的浏览器通过 Socket 套接字编程搭建Python服务器端口来进行进程通信，利用 Cef 的嵌入原理将浏览器嵌入到Qt图形界面当中。</p>
</blockquote>
<p><strong>关键字</strong>：WebGL，Vue, Go, Python，Qt, CEF</p>
<h2 id="1-绪论"><a href="#1-绪论" class="headerlink" title="1.绪论"></a><strong>1.绪论</strong></h2><h3 id="1-1-课题简介"><a href="#1-1-课题简介" class="headerlink" title="1.1 课题简介"></a><strong>1.1 课题简介</strong></h3><blockquote>
<p>&emsp;&emsp;WebGL基于 OpenGL ES2.0 的标准在网页浏览器中实现三维图形渲染的效果，因为其所具备跨平台交互体验好的基础，目前在网页开发中越来越受到青睐。</p>
</blockquote>
<blockquote>
<p>&emsp;&emsp;这里我们基于 Three.js 使用 WebGL 技术搭建出可在网页上预览三维模型的编辑器，Three.js 是开源的 WebGL 框架，内置了许多关于三维操作的函数，可以极大简化开发难度。</p>
</blockquote>
<blockquote>
<p>&emsp;&emsp;网站的搭建基于前端框架 Vue.js 搭建出后台数据管理系统，Vue.js 是目前主流的网页渲染框架，其技术开发借鉴了 Angualr.js 和 React.js 兼具模板引擎和js拆分功能。目前Vue的社区非常活跃，在前端开发中具有不可磨灭的影响。</p>
</blockquote>
<blockquote>
<p>&emsp;&emsp;后台服务端使用 Golang 语言的 Iris 框架，使用 mysql 数据库进行后台数据存储。Golang语言由Google开发并维护的编程语言，是目前服务器后端开发中的后起之秀，由于其性能优秀，使用简单，已经越来越广泛地运用到各种编程的领域里面。</p>
</blockquote>
<blockquote>
<p>&emsp;&emsp;桌面客户端这是基于跨平台的 Qt 框架利用 Python 绑定，使用 python 进行编写，因为目前各种 Digital Content Creation(以下简称 DCC ) 软件大部分都是 Qt 框架开发的，都支持 Python Qt 图形化界面开编写软件的工具，通过 Python Qt 编写图形化界面就可以将我们的 WebGL 网站嵌入到 DCC软件中。</p>
</blockquote>
<h2 id="2-Vue前端页面开发"><a href="#2-Vue前端页面开发" class="headerlink" title="2.Vue前端页面开发"></a><strong>2.Vue前端页面开发</strong></h2><h3 id="2-1-Vue-框架介绍"><a href="#2-1-Vue-框架介绍" class="headerlink" title="2.1 Vue 框架介绍"></a><strong>2.1 Vue 框架介绍</strong></h3><blockquote>
<p>&emsp;&emsp;Vue.js是一套构建用户界面的渐进式框架，采用自底向上增量开发的设计，通过尽可能简单的 API 实现响应的数据绑定和组合的视图组件。</p>
</blockquote>
<blockquote>
<p>&emsp;&emsp;Vue.js 是目前主流的前端三大框架之一，比起原生JavaScript，Vue不再需要让用户操作DOM元素，解放了用户的双手，让程序员可以更多时间去关注业务逻辑，并且Vue使用了MVVM模式实现了数据的双向绑定，这样数据的更新操作更加简单使用，开发效率更高。</p>
</blockquote>
<blockquote>
<p>&emsp;&emsp;在使用 Vue .js 之前需要先安装 node.js 引擎，node.js 借助谷歌chromium V8引擎实现JavaScript 脱离浏览器运行，让 JavaScript 的开发边界极大扩大了，因此基于 node.js引擎让不仅仅诞生了服务于后端的 express 框架甚至可以用 electron 框架进行桌面开发。</p>
</blockquote>
<blockquote>
<p>&emsp;&emsp;安装了 node.js 之后就可以在系统的命令行中访问 npm 模块管理器，通过 npm 可以下载 JavaScript 生态下社区所贡献的各种不同的模块，极大丰富了编程世界的活力。</p>
</blockquote>
<blockquote>
<p>&emsp;&emsp;Vue 也是基于 node.js 对 .vue 文件进行解析编译，然后通过 Webpack 工具将开发好的页面精简打包成一个静态网站。</p>
</blockquote>
<blockquote>
<p>&emsp;&emsp;可以通过 npm 安装 vue-cli 来快速配置 vue ，直接通过 npm install –global vue-cli 即可，然后就可以使用 vue init 命令初始化一个简单的 Vue 工程。</p>
</blockquote>
<blockquote>
<p>&emsp;&emsp;Vue工程已经配置好所有的 JavaScript 依赖库，以及 webpack 等工具的配置，查看 package.json 可以看到 dev 命令已经配置了 webpack 服务器，可以直接使用 npm run dev 来开启服务器预览 Vue 生成静态页面。</p>
</blockquote>
<h3 id="2-2-Vue-前端页面概览"><a href="#2-2-Vue-前端页面概览" class="headerlink" title="2.2 Vue 前端页面概览"></a><strong>2.2 Vue 前端页面概览</strong></h3><blockquote>
<p>&emsp;&emsp;前端的界面借助于饿了么开发的 element 框架，使用搭建 admin 后台，这里借助了 Github 上开源的 Vue-element-admin 进行简单的构建。</p>
</blockquote>
<blockquote>
<p>&emsp;&emsp;首先我先去 Github 上将相关的仓库 clone 下来，然后通过 npm 模块管理器安装 Vue 相关的 JavaScript 模块。由于国内的网络原因，这里我采用了淘宝的镜像源来加快模块的下载速度。</p>
</blockquote>
<blockquote>
<p>&emsp;&emsp;执行 npm install 命令安装模块可以读取当前目的 package.json 文件，自动安装项目的相关依赖。安装完成之后会在当前的目录下增加一个 node_modules 目录，当前目录里面就包含了启动项目所有的依赖项，通过执行 npm run dev 命令.启动前端页面。</p>
</blockquote>
<p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/FXTD-odyssey/FXTD-odyssey.github.io@master/post_img/7bc09203/7f1607a6f0838afa07221e3df21436f4.png" alt=""></p>
<center>图2.1 前端登录页面</center>

<blockquote>
<p>&emsp;&emsp;后续点击登录即可进入到框架提供的后台管理页面，登录进去之后的页面如下:</p>
</blockquote>
<p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/FXTD-odyssey/FXTD-odyssey.github.io@master/post_img/7bc09203/18145e87ac94a97de0812406f91773fe.png" alt=""></p>
<center>图2.2 模型列表页面</center>

<blockquote>
<p>&emsp;&emsp;后台系统包含了用户中心可以查看用户注册的信息，以及所有的模型列表还有模型的贴图和上传用户的名称。</p>
</blockquote>
<blockquote>
<p>&emsp;&emsp;整个模型列表页面包含了数据库的增删改查所有的操作，其中左上角有搜索栏可以进行模型搜索，也可以点击添加按钮添加新的模型项。</p>
</blockquote>
<blockquote>
<p>&emsp;&emsp;模型列表的右侧有每一个模型记录的修改按钮和删除按钮。</p>
</blockquote>
<blockquote>
<p>&emsp;&emsp;删除按钮通过 element-ui 的 el-popconfirm 进行了防误删处理，给用户一个提醒。</p>
</blockquote>
<p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/FXTD-odyssey/FXTD-odyssey.github.io@master/post_img/7bc09203/decf29bd29a1ed3caccf72c05da6b552.png" alt=""></p>
<center>图2.3 防止误删除警告</center>

<blockquote>
<p>&emsp;&emsp;修改按钮点击可以打开外部链接进入到 WebGL开发的编辑器进行模型文件的修改。</p>
</blockquote>
<h3 id="2-3-Vue-代码开发"><a href="#2-3-Vue-代码开发" class="headerlink" title="2.3 Vue 代码开发"></a><strong>2.3 Vue 代码开发</strong></h3><blockquote>
<p>&emsp;&emsp;成功启动项目之后，我们可以去到 src\router 文件夹去配置页面的路由， Vue-element-admin 的路由和侧边栏是绑定到一起的，因此只需要配置路由就可以完成后台系统的侧边栏配置。</p>
</blockquote>
<blockquote>
<p>&emsp;&emsp;路由配置分别指向对应的组件页面就可以实现点击侧边栏进行相应页面的跳转，使用Vue.js 的前端框架比起过去的 JQuery 操作会更加方便有效。</p>
</blockquote>
<p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/FXTD-odyssey/FXTD-odyssey.github.io@master/post_img/7bc09203/831537a82f7734991108425dc2c3ccf8.png" alt=""></p>
<center>图2.4 路由配置</center>

<blockquote>
<p>&emsp;&emsp;配置好路由之后就就可以去到相应的组件进行页面编写了，这里配置的 Component路径 \@ 表示 src 的目录，这个配置可以在 jsconfig.json 文件中找到。</p>
</blockquote>
<blockquote>
<p>&emsp;&emsp;用户中心的代码文件再 profile 文件夹里面，这里使用了三个组件来组成分别修改用户的头像信息以及用户个人信息和修改密码。</p>
</blockquote>
<p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/FXTD-odyssey/FXTD-odyssey.github.io@master/post_img/7bc09203/7d376143ca962eb3bc0fb99a083fc1d7.png" alt=""></p>
<center>图2.5 用户中心代码</center>

<blockquote>
<p>&emsp;&emsp;在 js 的路径部分，这里使用了 Vuex 进行全局的状态管理，通过 axios 来发送响应的 http 请求访问后端程序，实现从数据库中获取数据。</p>
</blockquote>
<blockquote>
<p>&emsp;&emsp;模型列表的部分就比较复杂一点，这里通过 el-table 组件实现数据的呈现，从后端获取了数据之后，通过前端 js 的filter 对数据进行过滤和展示。</p>
</blockquote>
<blockquote>
<p>&emsp;&emsp;点击修改按钮执行 js 命令打开 WebGL 编辑器外链接，点击删除按钮则直接删除当前列表中的数据。</p>
</blockquote>
<p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/FXTD-odyssey/FXTD-odyssey.github.io@master/post_img/7bc09203/2c5aa369d3d8ed6a9b7a0f9b3c0d60f2.png" alt=""></p>
<center>图2.6 模型列表代码</center>

<blockquote>
<p>&emsp;&emsp;目前的开发阶段还没有搭建起后端数据，这里可以使用 Mock.js 来模拟后端数据返回的效果，从而测试我们网站的接口功能是否运行正确。</p>
</blockquote>
<p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/FXTD-odyssey/FXTD-odyssey.github.io@master/post_img/7bc09203/1e92227f280c6499a7fde20d476ab038.png" alt=""></p>
<center>图2.7 Mock 模拟接口返回的数据</center>

<blockquote>
<p>&emsp;&emsp;下面就可以在 Vue 里面通过 axios 库来进行 http 请求访问模拟的数据端口获取模拟数据返回到前端页面当中。</p>
</blockquote>
<p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/FXTD-odyssey/FXTD-odyssey.github.io@master/post_img/7bc09203/08e16509b2c267390fa231a55f603f6a.png" alt=""></p>
<center>图2.8 axios 访问请求后端接口</center>

<blockquote>
<p>&emsp;&emsp;其中request脚本封装了 axios 库的请求操作，让这里的代码更加清晰。</p>
</blockquote>
<h2 id="3-WebGL-编辑器开发"><a href="#3-WebGL-编辑器开发" class="headerlink" title="3.WebGL 编辑器开发"></a><strong>3.WebGL 编辑器开发</strong></h2><h3 id="3-1-Three-js-三维基础"><a href="#3-1-Three-js-三维基础" class="headerlink" title="3.1 Three.js 三维基础"></a><strong>3.1 Three.js 三维基础</strong></h3><blockquote>
<p>&emsp;&emsp;Three.js 极大的简化了 WebGL 的操作，不再需要手动去处理 GL 的缓存，也不需要调用 compileShader 等一系列 WebGL 内置的API ，这些操作 Three.js 已经封装好了。使用 Three.js 搭建三维页面只需有三件套接口，即 场景 摄像机 渲染器 三样东西。</p>
</blockquote>
<blockquote>
<p>&emsp;&emsp;有了这三样东西的确就可以搭建出一个三维场景,但是我们依然什么都看不到，还需要搭建出一个几何体来进行观察， Three.js 提供了一些创建简单几何体的 API ，可以通过BoxGeometry 创建几何体，然后赋予材质 MeshBasicMaterial ，最后通过 mesh 将所有的数据整合到一起，并且将 mesh 添加到场景中，就可以通过渲染看到场景中的几何体了。另外由于 WebGL 是图形化的处理，因此也需要类似游戏一样不断地去刷新页面来实现页面更新的交互，代码处理需要通过 js 的内置命令 requestAnimationFrame 的递归来实现自我调用的效果，从而实现帧刷新。</p>
</blockquote>
<blockquote>
<p>&emsp;&emsp;下面就是搭建一个简单的 Three.js 场景的代码。</p>
</blockquote>
<p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/FXTD-odyssey/FXTD-odyssey.github.io@master/post_img/7bc09203/a6a2a3a94964000ded7b00c31b040888.png" alt=""></p>
<center>图3.1 　简单三维场景搭建</center>

<h3 id="3-2-Three-js-编辑器开发"><a href="#3-2-Three-js-编辑器开发" class="headerlink" title="3.2 Three.js 编辑器开发"></a><strong>3.2 Three.js 编辑器开发</strong></h3><blockquote>
<p>&emsp;&emsp;由于 Three.js 是基于 es5 的标准下开发的，这是一个历史问题了，因此这里没有使用前端的框架而是使用 JQuery 脚本来处理浏览器的 DOM。</p>
</blockquote>
<blockquote>
<p>&emsp;&emsp;这里我们借助 Three.js 内置的 ui.three.js 脚本所提供的简单 UI 来讲来进行不同界面的编写。</p>
</blockquote>
<blockquote>
<p>&emsp;&emsp;通过 Editor 脚本将所有的 UI 以及 Three.js 的场景全部整合到一起。其中利用 signal 脚本给编辑器创建了一个<a target="_blank" rel="noopener" href="https://blog.csdn.net/u011391629/article/details/64162879">观察者模式</a>，从而实现各种不同函数的注册方便后续进行相应的回调。</p>
</blockquote>
<blockquote>
<p>&emsp;&emsp;最后会在 Eidtor 脚本里面搭建出 Three.js 场景所需的三件套。</p>
</blockquote>
<p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/FXTD-odyssey/FXTD-odyssey.github.io@master/post_img/7bc09203/cd8409223876578adc47d75f6ace99c3.png" alt=""></p>
<center>图3.2 　Editor脚本搭建</center>

<blockquote>
<p>&emsp;&emsp;这样就可以创建出一个 Editor 的类，然后通过 Editor 类将相关的 UI 挂在到Editor 上面。</p>
</blockquote>
<blockquote>
<p>&emsp;&emsp;这里通过 MenuBar 来实现上方的菜单栏挂载，这里添加了编辑菜单，文件菜单，帮助菜单等菜单。</p>
</blockquote>
<p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/FXTD-odyssey/FXTD-odyssey.github.io@master/post_img/7bc09203/cf5e18cc92ce34d1cb62599c847f94f1.png" alt=""></p>
<center>图3.3 　Menu菜单处理</center>

<blockquote>
<p>&emsp;&emsp;另外还需要 Viewport 脚本处理摄像机控制，否则显示的页面里摄像机是无法动弹的，因此这里需要 EditorControl 来实现摄像机的控制器，通过raycaster通过发射射线来获取视窗里面点击的物体。</p>
</blockquote>
<p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/FXTD-odyssey/FXTD-odyssey.github.io@master/post_img/7bc09203/090f8284e91aa90e92ec120278ec4b3e.png" alt=""></p>
<center>图3.4 　射线获取点击</center>

<blockquote>
<p>&emsp;&emsp;最后获取到点击的物体之后，通过 Three.js 内置的 TransformControl 来显示控制轴从而实现控制器位置的更改。</p>
</blockquote>
<p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/FXTD-odyssey/FXTD-odyssey.github.io@master/post_img/7bc09203/43a583a7dd60055892b04400206ac10b.png" alt=""></p>
<center>图3.5 　TransformControl 相关处理</center>

<blockquote>
<p>&emsp;&emsp;写完上述的脚本之后可以在 index.html 里面调用这里相关的类的来启动编辑器页面了。</p>
</blockquote>
<p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/FXTD-odyssey/FXTD-odyssey.github.io@master/post_img/7bc09203/5b053cfd62029c12c6cb3f48d68fe41c.png" alt=""></p>
<center>图3.6 　编辑器启动代码</center>

<blockquote>
<p>&emsp;&emsp;实现上面的脚本之后就可以在浏览器启动看到我们简单编辑器页面了。</p>
</blockquote>
<p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/FXTD-odyssey/FXTD-odyssey.github.io@master/post_img/7bc09203/2b29edfbc8285b693b105a2e01efaf49.png" alt=""></p>
<center>图3.7 　简单的编辑器页面</center>

<blockquote>
<p>&emsp;&emsp;后续就是进一步完善编辑器的功能，给编辑器添加编辑面板侧边栏和下方工具架。</p>
</blockquote>
<blockquote>
<p>&emsp;&emsp;编辑面板需要集成大纲类表和物体的位移编辑以及材质编辑的功能，这里也运用了类似于菜单的集成方式，通过一个主要 SideBar 脚本将其他的组件集成到一起。</p>
</blockquote>
<blockquote>
<p>&emsp;&emsp;其中会在界面中生成所有物体可能出现的属性，然后通过字典判断物体是否存在相关属性从而实现对数据的显示和隐藏。</p>
</blockquote>
<p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/FXTD-odyssey/FXTD-odyssey.github.io@master/post_img/7bc09203/3f77741f3286d9ee3cfecb920ef977a9.png" alt=""></p>
<center>图3.9 　属性显示过滤</center>

<blockquote>
<p>&emsp;&emsp;物体的材质属性显示运用了同样的原理，读取物体的材质是否存在相关属性，存在属性才显示，从而实现编辑面板属性的动态更新。</p>
</blockquote>
<blockquote>
<p>&emsp;&emsp;相关的属性更新则是通过命令模式，通过 Editor 注册相关的命令，然后在这里显示的组件发生更新的时候触发更新命令实现全部更新的统一。</p>
</blockquote>
<blockquote>
<p>&emsp;&emsp;大纲列表的显示则是其实也很简单，通过递归的方式遍历场景中所有的物体，然后根据遍历到的层级添加响应的侧边宽度，实现一种属性结构的显示，这里使用了闭包的方式进行场景物体的遍历。</p>
</blockquote>
<p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/FXTD-odyssey/FXTD-odyssey.github.io@master/post_img/7bc09203/90026afbc3bfff5094957f1ae7f174c3.png" alt=""></p>
<center>图3.10 　简单的编辑器页面</center>

<blockquote>
<p>&emsp;&emsp;最后则是通过浏览器的 addEventListener 来实现鼠标的拖拽事件从而改变物体相应的层级，并且添加响应的信号槽来触发相应的注册事件。</p>
</blockquote>
<blockquote>
<p>&emsp;&emsp;接下来就是底下的工具架创建了，这里要添加上位移旋转缩放的切换功能，还要有移动吸附的相关功能。</p>
</blockquote>
<blockquote>
<p>&emsp;&emsp;只需要添加点击按钮提供的功能，然后根据 TransformControl 里提前设置好的信号槽进行属性设置就可以实现点击按钮切换控制轴的效果。</p>
</blockquote>
<p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/FXTD-odyssey/FXTD-odyssey.github.io@master/post_img/7bc09203/08d7a9f7135628a1fb1967b74ad34a35.png" alt=""></p>
<center>图3.11 　工具架的控制轴设置</center>

<blockquote>
<p>&emsp;&emsp;至于工具架上的位置吸附功能也是通过信号槽事件进行触发，这里还添加多了以个场景信息的显示控制，场景信息通过遍历所有的场景获取出场景中包含的几何体个数以及边数面数，这里还增加了点击更新选择的数据的效果，从而可以统计单个模型的带线面效果。</p>
</blockquote>
<blockquote>
<p>&emsp;&emsp;这里添加了编辑器网格显示的可视化控制，网格则是通过 GridHelper 辅助显示工具显示出来的。</p>
</blockquote>
<blockquote>
<p>&emsp;&emsp;最后将上面的面板集成到 index.html 里面就有了基本的编辑器效果。</p>
</blockquote>
<p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/FXTD-odyssey/FXTD-odyssey.github.io@master/post_img/7bc09203/6b03ffe23679b7267fb061ad58fd81bd.png" alt=""></p>
<center>图3.12 　面板集成</center>

<blockquote>
<p>&emsp;&emsp;这里生成物体使用了 uuid 的方式进行记录，确保生成的物体有唯一辨识码。可以快速获取物体而不会产生混淆。</p>
</blockquote>
<blockquote>
<p>&emsp;&emsp;不过这里的面板显示会极大减少模型显示的空间，因此这里我在有下角添加了一个主菜单按钮，可以快速方便地隐藏掉编辑器的面板显示。</p>
</blockquote>
<p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/FXTD-odyssey/FXTD-odyssey.github.io@master/post_img/7bc09203/b1d397347c32f7669aba954f313d034a.png" alt=""></p>
<center>图3.13 　右侧菜单</center>

<blockquote>
<p>&emsp;&emsp;这个菜单动画通过 JQuery 插件实现，面板的隐藏则是直接获取面板的 id 标记进行toggle动画隐藏，另外这里还添加了正侧顶视图的正交视图效果，通过修改 Three.js原生的 EditorControl 实现透视摄像机和正交摄像机两种不同视角的切换。</p>
</blockquote>
<p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/FXTD-odyssey/FXTD-odyssey.github.io@master/post_img/7bc09203/618f3b8fcdebae4f0a2c058c14bdb89c.png" alt=""></p>
<center>图3.13 　判断当前摄像机的类型从而实现不同的操作方式</center>

<blockquote>
<p>&emsp;&emsp;另外默认情况下，编辑器是没有默认灯光的，因此添加了模型之后就是黑漆漆的显示，因此我参考了 Maya 一类的软件添加了默认的摄像机灯光，光照方向沿着摄像机方向照射过去，确保即便没有灯光也可以观察到模型的基础显示效果。</p>
</blockquote>
<h2 id="4-Go后端服务开发"><a href="#4-Go后端服务开发" class="headerlink" title="4.  Go后端服务开发"></a>4.  <strong>Go后端服务开发</strong></h2><h3 id="4-1-Golang-语言概览"><a href="#4-1-Golang-语言概览" class="headerlink" title="4.1  Golang 语言概览"></a>4.1  <strong>Golang 语言概览</strong></h3><blockquote>
<p>&emsp;&emsp;Go语言是谷歌推出的一种全新的编程语言，可以在不损失应用程序性能的情况下降低代码的复杂度。</p>
</blockquote>
<blockquote>
<p>&emsp;&emsp;Go具有现代程序语言的特色，包括垃圾回收、内存管理等功能。而且Go的运行速度非常快，几乎和 C 或 C++ 程序媲美，能够快速迭代开发。</p>
</blockquote>
<blockquote>
<p>&emsp;&emsp;Go专门为构建服务器所设计的，因此他的并发性能非常良好，而且解决了多核心处理器调用的难题，让Go能够充分发挥现代计算机硬件的性能。</p>
</blockquote>
<blockquote>
<p>&emsp;&emsp;相较于边语言，Golang的语言特性让其短短十几年内快速发展，越来越多大公司的后端服务都开始转向 Go 语言进行构建，大名鼎鼎的 Docker 项目就是用 Go 开发的。</p>
</blockquote>
<h3 id="4-2-Iris-框架介绍"><a href="#4-2-Iris-框架介绍" class="headerlink" title="4.2  Iris 框架介绍"></a>4.2  <strong>Iris 框架介绍</strong></h3><blockquote>
<p>&emsp;&emsp;Iris 是Go语言中用来开发 Web应用的框架，他可以在不同的机器上高效率运行，而且API非常简单功能却非常强大，最重要的是支持后端的 MVC 框架，更加方便企业级项目的管理。</p>
</blockquote>
<blockquote>
<p>&emsp;&emsp;目前Iris框架是后端领域中性能最强的框架之一。</p>
</blockquote>
<p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/FXTD-odyssey/FXTD-odyssey.github.io@master/post_img/7bc09203/41fc279439cacc84be6b774c70e56834.png" alt=""></p>
<center>图4.1 　Iris框架性能对比</center>

<blockquote>
<p>&emsp;&emsp;Go 服务器采用 Iris 框架，基于 Xorm 进行进行 mysql 数据库绑定。服务器后台使用腾讯云购买的服务器，使用宝塔面板搭建数据库进行管理。</p>
</blockquote>
<h3 id="4-3-服务器环境配置"><a href="#4-3-服务器环境配置" class="headerlink" title="4.3  服务器环境配置"></a>4.3  服务器环境配置</h3><blockquote>
<p>&emsp;&emsp;首先去到腾讯云的服务器上安装 Linux 操作系统的镜像，然后通过 ssh 配置登录到服务器的命令行面板里面，执行宝塔面板的安装命令即可全自动安装宝塔面板，然后通过宝塔面板可以图形化配置服务器。</p>
</blockquote>
<p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/FXTD-odyssey/FXTD-odyssey.github.io@master/post_img/7bc09203/5d82c3a19e94eac7e237582389d17a25.png" alt=""></p>
<center>图4.2 宝塔面板的安装命令</center>

<blockquote>
<p>&emsp;&emsp;yum模块是 Centos 自带的系统包管理器，可以获取一些别人整理好的模块安装到当前系统里面。</p>
</blockquote>
<blockquote>
<p>&emsp;&emsp;安装完成之后就可以顺利通过宝塔面板的提示登录到面板系统当中。</p>
</blockquote>
<p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/FXTD-odyssey/FXTD-odyssey.github.io@master/post_img/7bc09203/c7273d29448115fa0af9a179e53a9182.png" alt=""></p>
<center>图4.3 宝塔面板的安装完成提示</center>

<blockquote>
<p>&emsp;&emsp;顺利登录进入宝塔界面之后可以根据提示快速配置服务器需要用到的环境。比如Mysql数据库以及数据库管理工具 phpMyAdmin 来图形化管理 Mysql数据库。</p>
</blockquote>
<p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/FXTD-odyssey/FXTD-odyssey.github.io@master/post_img/7bc09203/218d9801733d4326275e021ab5ac1342.png" alt=""></p>
<center>图4.4 快速配置服务器环境</center>

<blockquote>
<p>&emsp;&emsp;可以去到宝塔面板的数据库页面去新建一个新的数据库。</p>
</blockquote>
<p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/FXTD-odyssey/FXTD-odyssey.github.io@master/post_img/7bc09203/9e0e8c06912644ef729f89593de02d98.png" alt=""></p>
<center>图4.5 新建数据库</center>

<blockquote>
<p>&emsp;&emsp;新建数据库可以配置数据库的登录账号和密码，自动分配数据库访问权限，也可以设置数据库只供本机 IP 进行访问，防止被恶意利用。</p>
</blockquote>
<p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/FXTD-odyssey/FXTD-odyssey.github.io@master/post_img/7bc09203/b11dcb2cca2fe5a593e07ac2fcb402e1.png" alt=""></p>
<center>图4.6 phpMyAdmin界面</center>

<blockquote>
<p>&emsp;&emsp;完成数据库搭建之后就可以登录到 phpMyAdmin 界面里管理 MySql 数据库里的表和数据了。</p>
</blockquote>
<h3 id="4-4-Go代码编写"><a href="#4-4-Go代码编写" class="headerlink" title="4.4  Go代码编写"></a>4.4  Go代码编写</h3><blockquote>
<p>&emsp;&emsp;编写Go需要先安装 Go编译器，可以去中文官网下载Go编译器的安装包进行安装。</p>
</blockquote>
<blockquote>
<p>&emsp;&emsp;安装完成之后，就可以通过命令行调用 go 命令来执行 Go 语言的代码。</p>
</blockquote>
<p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/FXTD-odyssey/FXTD-odyssey.github.io@master/post_img/7bc09203/3a86ee7849acf588a29ab126ec3ec136.png" alt=""></p>
<center>图4.7 简单的Go代码运行</center>

<blockquote>
<p>&emsp;&emsp;下面就可以通过 Go 来安装搭建服务器所需要依赖的代码库了，通过 go get 命令可以直接将 github 上的源码库下载 GOPATH 环境变量路径所指向的 src 目录里面，get下来的模块就可以全局 import 导入来使用了。</p>
</blockquote>
<p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/FXTD-odyssey/FXTD-odyssey.github.io@master/post_img/7bc09203/9c3b92395de4daeab48c25a8b8c3004e.png" alt=""></p>
<center>图4.8 代码目录结构</center>

<blockquote>
<p>&emsp;&emsp;Go的后端代码基于 MVC 框架加 Service 服务实现，由于后端没有界面，因此这里的View指代的是路由地址，前端界面通过 http 请求访问不同的路由地址，Go会根据请求去调用对应路由的 Model 和 Controller ，而 Service 则将数据库的操作从 Controller 分离出来，方便不同 Controller 之间的相互调用。</p>
</blockquote>
<blockquote>
<p>&emsp;&emsp;首先需要去 config.json 文件配置服务器监听的地址以及数据库访问的一些信息。</p>
</blockquote>
<p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/FXTD-odyssey/FXTD-odyssey.github.io@master/post_img/7bc09203/9e1ca245b1fea5aa635cce1879a3a221.png" alt=""></p>
<center>图4.9 配置文件</center>

<blockquote>
<p>&emsp;&emsp;然后通过读取 json 文件配置来连接到线上的数据库。</p>
</blockquote>
<p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/FXTD-odyssey/FXTD-odyssey.github.io@master/post_img/7bc09203/66794e14a5df0690e437b1cedf4c9220.png" alt=""></p>
<center>图4.10 Go 解析json数据</center>

<blockquote>
<p>&emsp;&emsp;读取的数据可以用来初始化 Iris 框架的挂载，并且配置好 xorm 模块的数据绑定实现数据库的自动录入更新。</p>
</blockquote>
<blockquote>
<p>&emsp;&emsp;下面可以创建Model文件来描述数据库数据存储的格式，通过 xorm 提供的sync2方法可以自动在数据库创建出相应的表格。</p>
</blockquote>
<p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/FXTD-odyssey/FXTD-odyssey.github.io@master/post_img/7bc09203/7ab3fa276fa25c0f9b4efa7080ec6c85.png" alt=""></p>
<center>图4.11 配置Model数据绑定</center>

<blockquote>
<p>&emsp;&emsp;通过StaticWeb 命令配置服务器的静态资源目录，这样只要启动 Go 服务，就可以通过本地域名加端口来访问到这些目录所配置的静态资源了。</p>
</blockquote>
<p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/FXTD-odyssey/FXTD-odyssey.github.io@master/post_img/7bc09203/136a4cdc50ef4d7ca2643e10f4358e0c.png" alt=""></p>
<center>图4.12 配置静态资源路径</center>

<blockquote>
<p>&emsp;&emsp;下面就是 Main 函数里面最重要的 mvcHandle 函数的处理了，这里定义了路由的设置并且通过路由调用相关的 Model 和 Controller ，不同的 Controller 调用相应的 service 来实现数据库的读写操作，这样分层的好处在于各个模块不会耦合到一起，方便代码管理和拆分，也方便来团队协作开发。</p>
</blockquote>
<p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/FXTD-odyssey/FXTD-odyssey.github.io@master/post_img/7bc09203/867ef5010ad14c79186c7c7c96638bf8.png" alt=""></p>
<center>图4.13 路由挂载</center>

<blockquote>
<p>&emsp;&emsp;接下来就可以去到 Controller 来控制具体的请求了。</p>
</blockquote>
<blockquote>
<p>&emsp;&emsp;Iris框架可以根据函数的命名来匹配响应的请求以及请求地址，比如我这里有PostLogin 函数，Iris 会自动转换为 /api/users/login 地址下的 Post 请求所执行的函数，这样就让配置更加简洁清晰。</p>
</blockquote>
<p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/FXTD-odyssey/FXTD-odyssey.github.io@master/post_img/7bc09203/faa4711b2b6fa4e73ed028f08f9e0815.png" alt=""></p>
<center>图4.14 访问请求处理</center>

<blockquote>
<p>&emsp;&emsp;通过上面的配置就实现了管理员登录接口的功能，GetByAdminNameAndPassword函数会调用 service 的数据库查询方法来查询管理员账号是否存在。</p>
</blockquote>
<p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/FXTD-odyssey/FXTD-odyssey.github.io@master/post_img/7bc09203/f5aa9de4b1c2bc5fee7713cb92257202.png" alt=""></p>
<center>图4.15 数据库查询</center>

<blockquote>
<p>&emsp;&emsp;如果管理员存在并且密码和存储的密码一致，才会返回存在的数据，从而实现用户的登录功能。</p>
</blockquote>
<blockquote>
<p>&emsp;&emsp;下面还需要通过接口测试工具 postman 模拟 http 请求来测试接口编写是否存在问题。</p>
</blockquote>
<blockquote>
<p>&emsp;&emsp;可以先将Go服务器运行起来，我的默认配置是监听到本地的 8080 端口。</p>
</blockquote>
<p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/FXTD-odyssey/FXTD-odyssey.github.io@master/post_img/7bc09203/90f5e0c9bd7e4b4fa7a844739d29dd32.png" alt=""></p>
<center>图4.16 运行Go服务</center>

<blockquote>
<p>&emsp;&emsp;这样Go服务器就已经运行起来了，这时候就可以通过浏览器访问 localhost:8080 访问到之前静态挂载的页面了，下面就可以通过MVC配置的路由地址通过 postman 软件来模拟浏览器发送的http请求，从而可以测试接口返回的数据是否符合我们的预期。</p>
</blockquote>
<blockquote>
<p>&emsp;&emsp;Postman的使用非常简单，只需要输入访问地址，然后选择请求的类型，然后将请求相关的数据配置好就可以点击 Send 发送请求了。</p>
</blockquote>
<blockquote>
<p>&emsp;&emsp;下面的 Body 可以看到访问的端口所返回来的数据。</p>
</blockquote>
<p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/FXTD-odyssey/FXTD-odyssey.github.io@master/post_img/7bc09203/2b3a3de48284d16907438b331f20b9e7.png" alt=""></p>
<center>图4.17 Postman 测试端口</center>

<blockquote>
<p>&emsp;&emsp;端口返回的数据可以通过前端的 Vue 进行解析，从而在前端页面显示出相关的错误信息。</p>
</blockquote>
<blockquote>
<p>&emsp;&emsp;最后前端端口全部配置完成通过测试之后，可以通过 npm run build 将 Vue 的界面听过 WebPack 打包精简成一个小型的静态页面，通过 Iris 静态挂在到服务器上，Vue发送请求就可以调用 Iris 来进行数据交互，我们的 WebGL 三维网站就初步搭建完成了。</p>
</blockquote>
<h2 id="5-Python-Qt-CefWidget-开发"><a href="#5-Python-Qt-CefWidget-开发" class="headerlink" title="5.  Python Qt CefWidget 开发"></a>5.  <strong>Python Qt CefWidget 开发</strong></h2><h3 id="5-1-基于PySide构建桌面程序"><a href="#5-1-基于PySide构建桌面程序" class="headerlink" title="5.1  基于PySide构建桌面程序"></a>5.1  <strong>基于PySide构建桌面程序</strong></h3><blockquote>
<p>&emsp;&emsp;通过上面的步骤，我们已经成功搭建起了一个运行的WebGL 网站，下面我需要将这个网站嵌入到 DCC 软件中，比如 Maya 三维软件，从而搭建出一个简易的三维资产库来管理这些生产工具所创建出来的三维资源。</p>
</blockquote>
<blockquote>
<p>&emsp;&emsp;当前主流的 DCC 软件都是由 Qt 框架搭建，Qt框架是一门跨平台的 C++ 图形界面开发的框架，可以实现 Python 绑定从而大大简化了界面开发的难度，而主流的Python绑定库大都使用了Qt 官方提供的 PySide 库。</p>
</blockquote>
<blockquote>
<p>&emsp;&emsp;使用 PySide 构建一个桌面应用程序非常简单，首先安装 Python ，然后通过 pip 命令安装 PySide 库，这样就可以在 Python 代码里面 import PySide 模块。</p>
</blockquote>
<p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/FXTD-odyssey/FXTD-odyssey.github.io@master/post_img/7bc09203/c68cf8b5745533a5b087295ae5eefbaf.png" alt=""></p>
<center>图5.1 简易的 PySide 界面搭建</center>

<h3 id="5-2-Cef浏览器嵌入框架"><a href="#5-2-Cef浏览器嵌入框架" class="headerlink" title="5.2  Cef浏览器嵌入框架"></a>5.2  <strong>Cef浏览器嵌入框架</strong></h3><blockquote>
<p>&emsp;&emsp;有了图形化界面的概念之后，下面需要将浏览器嵌入到 PySide 的界面当中，尽管PySide已经提供了一部分浏览器功能，可以访问大部分的网上页面，但是对 WebGL的支持依然不友好。</p>
</blockquote>
<blockquote>
<p>&emsp;&emsp;因此这里我需要另辟蹊径解决 Qt 的浏览器嵌入问题，经过我不懈的努力我找到了一个很不错的解决方案，通过 cefpython 嵌入到 PySide 界面中。</p>
</blockquote>
<blockquote>
<p>&emsp;&emsp;CEF 全称是 Chromium Embedded Framework，中文名称Chromium嵌入式框架，可以将谷歌浏览器的内核 Chromium 嵌入到任意界面当中，实现JavaScript 代码的编译与运行。</p>
</blockquote>
<blockquote>
<p>&emsp;&emsp;cefpython 则是 CEF 框架的 Python 绑定，通过 CEF 框架的嵌入特性，只需要提供窗口的id就可以将浏览器窗口嵌入进去，操作起来很简单。</p>
</blockquote>
<blockquote>
<p>&emsp;&emsp;由于 CEF 框架是由 C++ 模块编写的，python 绑定会涉及到 Cython 编译的 pyd 文件，这种情况下是无法在诸如 Maya 之类的 DCC 平台进行导入的。</p>
</blockquote>
<blockquote>
<p>&emsp;&emsp;因此这里我采用了 socket 套接字编程将CEF模块通过 pyinstaller 封装成一个可执行的 exe 文件进行外部启动，通过 socket 来进行进程见得数据通信，从而在 Maya 上仍然可以控制到 CefPython 启动的浏览器模块。</p>
</blockquote>
<h3 id="5-3-CefWidget-Python代码编写"><a href="#5-3-CefWidget-Python代码编写" class="headerlink" title="5.3  CefWidget Python代码编写"></a>5.3  <strong>CefWidget Python代码编写</strong></h3><blockquote>
<p>&emsp;&emsp;为了兼容 Qt 框架不同 Python 绑定，这里我使用了 Github 上开源的 Qt.py<br>&emsp;&emsp;来导入相关的Python Qt 模块。</p>
</blockquote>
<blockquote>
<p>&emsp;&emsp;这里的代码结构包含两个脚本，一个是用来提供浏览器嵌入窗口的 Qt<br>&emsp;&emsp;组件，组件上提供了连接 socket<br>&emsp;&emsp;的方法来操控浏览器，而另一个脚本则是创建一个远程端口来运行 CEF 浏览器。</p>
</blockquote>
<p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/FXTD-odyssey/FXTD-odyssey.github.io@master/post_img/7bc09203/e9994ac773722e28cc49282c9c9220ae.png" alt=""></p>
<center>图5.2 remote 创建一个socket 套接字</center>

<blockquote>
<p>&emsp;&emsp;通过socket绑定到端口上，后续通过 while<br>&emsp;&emsp;循环获取传递到端口中的字符串数据，根据传递进来的字符串数据就可以解析出需要执行的事件，从而实现<br>&emsp;&emsp;CEF窗口的控制。</p>
</blockquote>
<p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/FXTD-odyssey/FXTD-odyssey.github.io@master/post_img/7bc09203/7d68c4342c6a44debbb5c4a28e308987.png" alt=""></p>
<center>图5.3 通过 while 死循环不断监听端口数据</center>

<blockquote>
<p>&emsp;&emsp;浏览器窗口也需要类似于Qt的界面一样不断执行来响应窗口的事件，cefpython提供了cef.MessageLoopWork()的方法来调用窗口的事件序列，这样只要将这个方法放到死循环里面执行就可以保持浏览器的持续响应，同时也不会因为端口监听互相冲突，这样就可以通过<br>&emsp;&emsp;socket.accpet()<br>&emsp;&emsp;来获取到端口的客户端，再从客户端获取传递进来的数据，根据传递的数据调用不同的方法，诸如创建一个新的浏览器，以及加载特定链接等等功能。</p>
</blockquote>
<p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/FXTD-odyssey/FXTD-odyssey.github.io@master/post_img/7bc09203/6d6de8bd2988080adf26b1fdf699cd6c.png" alt=""></p>
<center>图5.4 函数功能判断</center>

<blockquote>
<p>&emsp;&emsp;这里通过 terminate 关键字来打断循环，从而正确结束掉端口和运行中的 CEF<br>&emsp;&emsp;浏览器，否则死循环会一直占用端口，导致下次端口监听导致端口已经被占用报错的情况。</p>
</blockquote>
<blockquote>
<p>&emsp;&emsp;除了一些特殊的关键字信息处理之外，大部分数据处理都传递到 self.callback_dict<br>&emsp;&emsp;中进行通用的函数处理，大大简化了代码量。</p>
</blockquote>
<blockquote>
<p>&emsp;&emsp;搭建好了 cef<br>&emsp;&emsp;后台socket的脚本之后，Qt组件的脚本可以添加一个装饰器来自动开启和关闭这个<br>&emsp;&emsp;socket。</p>
</blockquote>
<p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/FXTD-odyssey/FXTD-odyssey.github.io@master/post_img/7bc09203/10c416741f0027873291c27b9f1dcf1f.png" alt=""></p>
<center>图5.5 scoket初始化和关闭</center>

<blockquote>
<p>&emsp;&emsp;通过 python 的 subprocess<br>&emsp;&emsp;模块来外部运行脚本，初始化socket，然后这里可以通过构建客户端 socket 来发送<br>&emsp;&emsp;terminate 关键字来结束所有的socket。</p>
</blockquote>
<blockquote>
<p>&emsp;&emsp;CefBrowser 组件继承与 QWidget ，通过 QWidget 提供的 winId<br>&emsp;&emsp;方法可以获取到当前组件的唯一winId，随后就可以通过这个 id<br>&emsp;&emsp;将浏览器窗口嵌入到这个组件的界面当中。</p>
</blockquote>
<p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/FXTD-odyssey/FXTD-odyssey.github.io@master/post_img/7bc09203/c861d738f6980655ca87598cfd194208.png" alt=""></p>
<center>图5.6 CefBrowser获取窗口的id</center>

<blockquote>
<p>&emsp;&emsp;通过embed 函数将窗口嵌入到当前组件中。</p>
</blockquote>
<p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/FXTD-odyssey/FXTD-odyssey.github.io@master/post_img/7bc09203/9c2913c80d62b343028539c0235ad011.png" alt=""></p>
<center>图5.7 CefBrowser 为当前组件生成浏览器并嵌入</center>

<blockquote>
<p>&emsp;&emsp;这里通过python 的 uuid<br>&emsp;&emsp;模块获取当前组件的唯一辨识符，并且传递到生成的浏览器当中，这样发送数据到浏览器<br>&emsp;&emsp;socket 的时候就可以通过唯一辨识符知道要对哪一个浏览器窗口进行处理。</p>
</blockquote>
<p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/FXTD-odyssey/FXTD-odyssey.github.io@master/post_img/7bc09203/c586523a4fb6505205c371f8043b2f0e.png" alt=""></p>
<center>图5.8 Connect函数封装了端口访问的代码</center>

<blockquote>
<p>&emsp;&emsp;通过Connect 函数封装，方便数据发送。</p>
</blockquote>
<p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/FXTD-odyssey/FXTD-odyssey.github.io@master/post_img/7bc09203/b36e916c3ac2d760b100082a9c4edd8b.png" alt=""></p>
<center>图5.9 调用不同的函数向端口发送不同的数据</center>

<blockquote>
<p>&emsp;&emsp;通过发送字符串数据，就可以发送到浏览器运行的端口程序里，从而让<br>&emsp;&emsp;CefBrowser嵌入的浏览器响应事件，封装成浏览的处理函数之后也支持 Qt<br>&emsp;&emsp;内置的点击按钮触发事件功能。</p>
</blockquote>
<p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/FXTD-odyssey/FXTD-odyssey.github.io@master/post_img/7bc09203/4bb72880034ca66e3683df8acac71eeb.png" alt=""></p>
<center>图5.10 浏览器嵌入测试</center>

<blockquote>
<p>&emsp;&emsp;后面根据 cefpython 官方提供的 pyinstaller 打包方案，将 remote.py<br>&emsp;&emsp;打包成一个可执行文件，这样脚本就不再需要依赖 python 进行运行，也不会因为 maya<br>&emsp;&emsp;等软件的python.exe是特殊编译的版本导致不兼容运行出错。</p>
</blockquote>
<blockquote>
<p>&emsp;&emsp;Pyinstaller 是 python 程序打包成 exe<br>&emsp;&emsp;可执行文件的方案，这个包支持跨平台程序打包，使用起来非常友好，cefpython 需要配置<br>&emsp;&emsp;pyinstaller.spec<br>&emsp;&emsp;来定义需要进行打包的程序以及路径，具体操作可以参照官方的打包文件案例。</p>
</blockquote>
<blockquote>
<p>&emsp;&emsp;我这里在官方的基础加上了一些改良，比如打包成功之后自动打开打包的文件，自动读取当前运行脚本目录下的<br>&emsp;&emsp;remote.py 进行打包等等。</p>
</blockquote>
<p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/FXTD-odyssey/FXTD-odyssey.github.io@master/post_img/7bc09203/09e399c17340220cf4e408e12cd89549.png" alt=""></p>
<center>图5.11 使用 pyinstaller 打包程序</center>

<blockquote>
<p>&emsp;&emsp;打包程序需要花费一些时间，打包完成之后会在目录中生成build文件夹，其中的cefapp.exe可执行文件执行的效果就和<br>&emsp;&emsp;remote.py 一样，但是不再需要依赖于当前执行的python就可以在 Maya 等 DCC<br>&emsp;&emsp;软件中启动当前程序。</p>
</blockquote>
<p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/FXTD-odyssey/FXTD-odyssey.github.io@master/post_img/7bc09203/8c768c9a0ef3f79fc4d526350660e74d.png" alt=""></p>
<center>图5.12 在Maya中启动 CefBrowser</center>

<blockquote>
<p>&emsp;&emsp;同样的方法，我们可以将之前做好的WebGL网站运行起来，就可以在网站上访问到WebGL编辑器并且查看上传的三维资产了。</p>
</blockquote>
<p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/FXTD-odyssey/FXTD-odyssey.github.io@master/post_img/7bc09203/c80d58d0ef168a9b9919b53c477105c4.png" alt=""></p>
<center>图5.13 在Maya中启动 WebGL 三维模型展示网站</center>

<p><img src= "/img/loading.gif" data-lazy-src="https://cdn.jsdelivr.net/gh/FXTD-odyssey/FXTD-odyssey.github.io@master/post_img/7bc09203/b10958d845d546097926f6f0cc5468f9.png" alt=""></p>
<center>图5.14 在Houdini中启动 WebGL 三维模型展示网站</center>

<h2 id="总结"><a href="#总结" class="headerlink" title="总结"></a>总结</h2><blockquote>
<p>&emsp;&emsp;前端使用 Vue-element-admin 其实并不太好。<br>&emsp;&emsp;一方面是我对这个后台前端框架不熟悉，使用起来磕磕绊绊的，最主要的是默认提供的功能过于冗杂了。<br>&emsp;&emsp;其实我的网站非常简单的，很多代码模块都可以删除。</p>
</blockquote>
<blockquote>
<p>&emsp;&emsp;后面用 Go 做后端测试，遇到了很多问题。比如我本地测试遇到了跨域问题。<br>&emsp;&emsp;网上搜索了一下 Vue 可以借助 node.js 进行请求转发，毕竟跨域保护是在浏览器生效的， node.js 没有跨域强求的限制。<br>&emsp;&emsp;然而某些情况还是会出问题。<br>&emsp;&emsp;后面在 Response Header 上加上跨域的信息之后也不行。<br>&emsp;&emsp;于是神奇的情况出现了，使用 postman 进行请求模拟没问题，但是当我尝试复制 postman 生成的代码到浏览器执行会出现 Network Error 访问不到的情况。<br>&emsp;&emsp;后来是关了请求转发才可以，真的是日了狗了。</p>
</blockquote>
<hr>
<blockquote>
<p>&emsp;&emsp;然后就是 sql 语句编写，Go 的 Iris 框架通过 MVC + Service 来操作 sql<br>&emsp;&emsp;Iris 框架也是个大坑，网上的资料比较少，出问题查询起来有点麻烦，好在 Stack Overflow 依然很实用。<br>&emsp;&emsp;sql 语句我写得少，其实用得还不是很顺手，后续打算弄个 sqlite 练习熟悉一下 sql 语句。</p>
</blockquote>
<blockquote>
<p>&emsp;&emsp;Go 语言完全没有练习基础就对照着教程提供的 Iris 框架代码进行开发，其实个人感觉不太好，有点不知其所以然的感觉。<br>&emsp;&emsp;而且遇到问题需要不停的查找，可能还是初期的不适应有关系。<br>&emsp;&emsp;总之是 Go 的使用经验还不足。</p>
</blockquote>
<hr>
<blockquote>
<p>&emsp;&emsp;关于 Three.js 编辑器改良上，其实无非就是用了 ES5 JQuery 插件和 Bootstrap 界面开发的方法改良的。<br>&emsp;&emsp;不过是 ES5 的东西都是几年前过时的标准了，初学前端还是学了这一套，bootstrap 有可视化编程，感觉依然是很香的。<br>&emsp;&emsp;整个编辑器主要还是从 Three.js 官方编辑器上改的，用了官方提供的 dark.css 样式，所以工作量不大。<br>&emsp;&emsp;主要添加了 四视图摄像机切换 ， 这个过程设计到 正交摄像机和透视摄像机的切换， 操作过程嵌入到了 EditorControl 里面了。<br>&emsp;&emsp;另外就是添加了根据镜头方向照射的默认灯光，类似Maya，不至于让场景纯黑。</p>
</blockquote>
<hr>
<blockquote>
<p>&emsp;&emsp;CefWidget 嵌入 DCC 其实都是之前帮师兄搞 宙斯 搞的东西了。<br>&emsp;&emsp;具体可以参照我之前的<a href="./d2b44b01.html">博客文章</a>，不过 WebGL 的效率其实不高，而且如果不从浏览器底层剥离 WebGL 的相关程序，整个浏览器过于臃肿了。<br>&emsp;&emsp;师兄推荐用 USDview ，的确是值得考虑的。</p>
</blockquote>
<hr>
<blockquote>
<p>&emsp;&emsp;一转眼大学就毕业了，时间真是一把杀猪刀呐~</p>
</blockquote>
</div><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">文章作者: </span><span class="post-copyright-info"><a href="mailto:undefined">智伤帝</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">文章链接: </span><span class="post-copyright-info"><a href="https://blog.l0v0.com/posts/7bc09203.html">https://blog.l0v0.com/posts/7bc09203.html</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">版权声明: </span><span class="post-copyright-info">本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> 许可协议。转载请注明来自 <a href="https://blog.l0v0.com" target="_blank">智伤帝的个人博客</a>！</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E0%A1%84Threejs/">ࡄThreejs</a><a class="post-meta__tags" href="/tags/%E0%A1%85OpenGL/">ࡅOpenGL</a><a class="post-meta__tags" href="/tags/%E0%A1%82Vue/">ࡂVue</a><a class="post-meta__tags" href="/tags/%E0%A0%B4%E7%BC%96%E7%A8%8B-Go/">࠴编程/Go</a></div><div class="post_share"><div class="addtoany"><div class="a2a_kit a2a_kit_size_32 a2a_default_style"><a class="a2a_button_facebook"></a><a class="a2a_button_twitter"></a><a class="a2a_button_wechat"></a><a class="a2a_button_sina_weibo"></a><a class="a2a_button_facebook_messenger"></a><a class="a2a_button_email"></a><a class="a2a_button_copy_link"></a><a class="a2a_dd" target="_blank" rel="noopener" href="https://www.addtoany.com/share"></a></div></div><script async="async" src="https://static.addtoany.com/menu/page.js"></script></div></div><div class="post-reward"><div class="reward-button"><i class="fas fa-qrcode"></i> 打赏<div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="//cdn.jsdelivr.net/gh/FXTD-odyssey/FXTD-odyssey.github.io@master/img/wechatimg.jpg" target="_blank"><img class="post-qr-code-img" data-lazy-src="//cdn.jsdelivr.net/gh/FXTD-odyssey/FXTD-odyssey.github.io@master/img/wechatimg.jpg" alt="微信"/></a><div class="post-qr-code-desc">微信</div></li><li class="reward-item"><a href="//cdn.jsdelivr.net/gh/FXTD-odyssey/FXTD-odyssey.github.io@master/img/alipayimg.jpg" target="_blank"><img class="post-qr-code-img" data-lazy-src="//cdn.jsdelivr.net/gh/FXTD-odyssey/FXTD-odyssey.github.io@master/img/alipayimg.jpg" alt="支付宝"/></a><div class="post-qr-code-desc">支付宝</div></li></ul></div></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/posts/5e76f729.html"><img class="prev-cover" data-lazy-src="//cdn.jsdelivr.net/gh/FXTD-odyssey/FXTD-odyssey.github.io@master/img/cover_04.png" onerror="onerror=null;src='//cdn.jsdelivr.net/gh/FXTD-odyssey/FXTD-odyssey.github.io@master/img/404.jpg'"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">梅开二度 - 校招总结</div></div></a></div><div class="next-post pull-right"><a href="/posts/27d5d78d.html"><img class="next-cover" data-lazy-src="https://cdn.jsdelivr.net/gh/FXTD-odyssey/FXTD-odyssey.github.io@master/post_img/27d5d78d/01.gif" onerror="onerror=null;src='//cdn.jsdelivr.net/gh/FXTD-odyssey/FXTD-odyssey.github.io@master/img/404.jpg'"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">Maya插件 SiShelf 改良</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span> 相关推荐</span></div><div class="relatedPosts-list"><div><a href="/posts/57520.html" title="Three.js - EditorContrl 添加区域限制"><img class="cover" data-lazy-src="//cdn.jsdelivr.net/gh/FXTD-odyssey/FXTD-odyssey.github.io@master/img/cover_02.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2018-09-17</div><div class="title">Three.js - EditorContrl 添加区域限制</div></div></a></div><div><a href="/posts/35846.html" title="Three.js -通过JQuery处理脚本异步加载"><img class="cover" data-lazy-src="//cdn.jsdelivr.net/gh/FXTD-odyssey/FXTD-odyssey.github.io@master/img/cover_04.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2018-08-21</div><div class="title">Three.js -通过JQuery处理脚本异步加载</div></div></a></div><div><a href="/posts/24831.html" title="Three.js -动态加载相关的js"><img class="cover" data-lazy-src="//cdn.jsdelivr.net/gh/FXTD-odyssey/FXTD-odyssey.github.io@master/img/cover_01.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2018-08-19</div><div class="title">Three.js -动态加载相关的js</div></div></a></div><div><a href="/posts/59091.html" title="Three.js - postprocessing 后期处理"><img class="cover" data-lazy-src="//cdn.jsdelivr.net/gh/FXTD-odyssey/FXTD-odyssey.github.io@master/img/cover_03.jpg" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2018-08-18</div><div class="title">Three.js - postprocessing 后期处理</div></div></a></div><div><a href="/posts/50589.html" title="Three.js - 用最小面数生成立体的物体"><img class="cover" data-lazy-src="https://cdn.jsdelivr.net/gh/FXTD-odyssey/FXTD-odyssey.github.io@master/post_img/50589/1.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2018-08-11</div><div class="title">Three.js - 用最小面数生成立体的物体</div></div></a></div><div><a href="/posts/61471.html" title="Three.js - 学习之路（四）"><img class="cover" data-lazy-src="//cdn.jsdelivr.net/gh/FXTD-odyssey/FXTD-odyssey.github.io@master/img/cover_04.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2018-08-01</div><div class="title">Three.js - 学习之路（四）</div></div></a></div></div></div><hr/><div id="post-comment"><div class="comment-head"><div class="comment-headline"><i class="fas fa-comments fa-fw"></i><span> 评论</span></div><div class="comment-switch"><span class="first-comment">Valine</span><label><input id="switch-comments-btn" type="checkbox"/><span class="slider"></span></label><span class="second-comment">Gitalk</span></div></div><div class="comment-wrap"><div><div class="vcomment" id="vcomment"></div></div><div><div id="gitalk-container"></div></div></div></div></article></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2022 By 智伤帝</div><div class="framework-info"><span>框架 </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>主题 </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><section id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="translateLink" type="button" title="简繁转换">繁</button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="设置"><i class="fas fa-cog"></i></button><a id="to_comment" href="#post-comment" title="直达评论"><i class="fas fa-comments"></i></a><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><i class="fas fa-arrow-up"></i></button></div></section><div class="search-dialog" id="local-search"><div class="search-dialog__title" id="local-search-title">本地搜索</div><div id="local-input-panel"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div></div><hr/><div id="local-search-results"><div id="local-hits"></div><div id="local-stats"><div class="local-search-stats__hr" id="hr"><span>由</span> <a target="_blank" rel="noopener" href="https://github.com/wzpan/hexo-generator-search" style="color:#49B1F5;">hexo-generator-search</a>
 <span>提供支持</span></div></div></div><span class="search-close-button"><i class="fas fa-times"></i></span></div><div id="search-mask"></div><div><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="/js/utils.js"></script><script src="/js/main.js"></script><script src="/js/tw_cn.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page/instantpage.min.js" type="module" defer></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload/dist/lazyload.iife.min.js"></script><script>function panguFn () {
  if (typeof pangu === 'object') pangu.spacingElementById('content-inner')
  else {
    $.getScript('https://cdn.jsdelivr.net/npm/pangu/dist/browser/pangu.min.js', () => {
      pangu.spacingElementById('content-inner')
    })
  }
}

function panguInit () {
  if (false){
    GLOBAL_CONFIG_SITE.isPost && panguFn()
  } else {
    panguFn()
  }
}

document.addEventListener('DOMContentLoaded', panguFn)</script><script src="/js/search/local-search.js"></script><script>var preloader = {
  endLoading: () => {
    document.body.style.overflow = 'auto';
    document.getElementById('loading-box').classList.add("loaded")
  },
  initLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.remove("loaded")

  }
}
window.addEventListener('load',()=> {preloader.endLoading()})</script><div class="js-pjax"><script>function loadValine () {
  function initValine () {
    let initData = {
      el: '#vcomment',
      appId: 'mrRioyNTSEAOvVLAsLgkhr4j-gzGzoHsz',
      appKey: 'wHDm1kxC2FUpOA7FNdgTOEnx',
      placeholder: 'Please leave your footprints',
      avatar: 'monsterid',
      meta: 'nick,mail,link'.split(','),
      pageSize: '10',
      lang: 'zh-CN',
      recordIP: false,
      serverURLs: '',
      emojiCDN: '',
      emojiMaps: "",
      enableQQ: false,
      path: window.location.pathname,
    }

    if (true) { 
      initData.requiredFields= ('nick,mail'.split(','))
    }
    
    if (false) {
      const otherData = false
      initData = Object.assign({}, initData, otherData)
    }
    
    const valine = new Valine(initData)
  }

  if (typeof Valine === 'function') initValine() 
  else $.getScript('https://cdn.jsdelivr.net/npm/valine/dist/Valine.min.js', initValine)
}

if ('Valine' === 'Valine' || !false) {
  if (false) btf.loadComment(document.querySelector('#vcomment'),loadValine)
  else setTimeout(() => loadValine(), 0)
} else {
  function loadOtherComment () {
    loadValine()
  }
}</script><script>function addGitalkSource () {
  const ele = document.createElement('link')
  ele.rel = 'stylesheet'
  ele.href= 'https://cdn.jsdelivr.net/npm/gitalk/dist/gitalk.min.css'
  document.getElementsByTagName('head')[0].appendChild(ele)
}

function loadGitalk () {
  function initGitalk () {
    var gitalk = new Gitalk({
      clientID: '355e44f722e24963b9dd',
      clientSecret: 'f8ec08d349714aa06152735a75b6d9ac9ef77016',
      repo: 'FXTD-odyssey.github.io',
      owner: 'FXTD-odyssey',
      admin: ['FXTD-odyssey'],
      id: '048279108d73b19b1dc11b482200e67f',
      language: 'zh-CN',
      perPage: 10,
      distractionFreeMode: false,
      pagerDirection: 'last',
      createIssueManually: false,
      updateCountCallback: commentCount
    })
    gitalk.render('gitalk-container')
  }

  if (typeof Gitalk === 'function') initGitalk()
  else {
    addGitalkSource()
    $.getScript('https://cdn.jsdelivr.net/npm/gitalk@latest/dist/gitalk.min.js', initGitalk)
  }
}

function commentCount(n){
  let isCommentCount = document.querySelector('#post-meta .gitalk-comment-count')
  if (isCommentCount) {
    isCommentCount.innerHTML= n
  }
}

if ('Valine' === 'Gitalk' || !false) {
  if (false) btf.loadComment(document.getElementById('gitalk-container'), loadGitalk)
  else loadGitalk()
} else {
  function loadOtherComment () {
    loadGitalk()
  }
}</script><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div><script src="https://cdn.jsdelivr.net/gh/wilq32/jqueryrotate/jQueryRotate.js"></script><script src="/js/classify.js"></script><script src="/js/jsdelivr.js"></script><script defer="defer" id="fluttering_ribbon" mobile="true" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-fluttering-ribbon.min.js"></script><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><script>(function(){
  const bp = document.createElement('script');
  const curProtocol = window.location.protocol.split(':')[0];
  if (curProtocol === 'https'){
  bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
  }
  else{
  bp.src = 'http://push.zhanzhang.baidu.com/push.js';
  }
  bp.dataset.pjax = ''
  const s = document.getElementsByTagName("script")[0];
  s.parentNode.insertBefore(bp, s);
})()</script></div></body></html>